import{c as a,I as ie,_ as ue,l as ce,r as y,a as B,y as de,n as pe,b,d as s,w as t,e as i,p as D,j as p,f as me,o as c,F as V,q as A,s as P,h as m,t as w,g as $,P as fe,v as z,x as _e}from"./index-DNEypZzq.js";var ve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 310H732.4c13.6-21.4 21.6-46.8 21.6-74 0-76.1-61.9-138-138-138-41.4 0-78.7 18.4-104 47.4-25.3-29-62.6-47.4-104-47.4-76.1 0-138 61.9-138 138 0 27.2 7.9 52.6 21.6 74H144c-17.7 0-32 14.3-32 32v200c0 4.4 3.6 8 8 8h40v344c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V550h40c4.4 0 8-3.6 8-8V342c0-17.7-14.3-32-32-32zm-334-74c0-38.6 31.4-70 70-70s70 31.4 70 70-31.4 70-70 70h-70v-70zm-138-70c38.6 0 70 31.4 70 70v70h-70c-38.6 0-70-31.4-70-70s31.4-70 70-70zM180 482V378h298v104H180zm48 68h250v308H228V550zm568 308H546V550h250v308zm48-376H546V378h298v104z"}}]},name:"gift",theme:"outlined"};function E(d){for(var r=1;r<arguments.length;r++){var l=arguments[r]!=null?Object(arguments[r]):{},_=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(_=_.concat(Object.getOwnPropertySymbols(l).filter(function(f){return Object.getOwnPropertyDescriptor(l,f).enumerable}))),_.forEach(function(f){ge(d,f,l[f])})}return d}function ge(d,r,l){return r in d?Object.defineProperty(d,r,{value:l,enumerable:!0,configurable:!0,writable:!0}):d[r]=l,d}var L=function(r,l){var _=E({},r,l.attrs);return a(ie,E({},_,{icon:ve}),null)};L.displayName="GiftOutlined";L.inheritAttrs=!1;const be={class:"member-list content-container"},ye={class:"table-container"},he={class:"table-header"},ke={class:"left"},we={class:"right"},Ce={key:0,style:{display:"inline-block"}},xe={class:"link-text-container"},Oe=["href"],Se=["onClick"],ze=["onClick"],Ie={__name:"list",setup(d){const r=ce(),l=me(),_=de(),f=y(!1),C=y(!1),I=y(!1),N=y(10),v=B({memberNickname:"",groupId:_.query.groupId}),U=y([]),g=B({current:1,pageSize:10,total:0}),j=y([]),F=[{title:"会员昵称",dataIndex:"memberNickname",key:"memberNickname"},{title:"账号",dataIndex:"memberAccount",key:"memberAccount"},{title:"渠道账号信息",key:"accountList"},{title:"所属群组",dataIndex:"groups",key:"groups"},{title:"更新时间",dataIndex:"updateTime",key:"updateTime",width:180},{title:"操作",key:"action",fixed:"right",width:200}],G=()=>{g.current=1,x()},M=()=>{Object.assign(v,{memberNickname:"",groupId:void 0}),G()},q=n=>{g.current=n.current,g.pageSize=n.pageSize,x()},J=()=>{l.push("/member/create")},Q=n=>{l.push(`/member/edit/${n.id}`)},W=n=>{l.push(`/member/view/${n.id}`)},X=async n=>{const e=await _e("member.delete",{},{urlParams:{id:n.id}});e.code===0?(p.success("删除成功"),x()):p.error(e.message)},Y=async()=>{C.value=!0,await K()},Z=async()=>{try{I.value=!0,p.success("保存成功"),C.value=!1}catch{p.error("保存失败")}finally{I.value=!1}},K=async()=>{try{N.value=10}catch{p.error("获取配置失败")}},x=async()=>{f.value=!0;try{const n=await D("member.list",{page:g.current,pageSize:g.pageSize,...v});n.code===0?(U.value=n.data.list,g.total=n.data.total):p.error(n.message)}finally{f.value=!1}},H=async(n="")=>{try{const e=await D("group.list",{page:1,pageSize:50,groupName:n});e.code===0&&(j.value=e.data.list||[])}catch{p.error("获取群组列表失败")}},ee=n=>{navigator.clipboard.writeText(n).then(()=>{p.success("链接已复制到剪贴板")}).catch(()=>{p.error("复制失败，请手动复制")})};return pe(()=>{x(),H()}),(n,e)=>{const te=i("a-input"),O=i("a-form-item"),ae=i("a-select-option"),ne=i("a-select"),h=i("a-button"),S=i("a-space"),R=i("a-form"),T=i("a-tag"),oe=i("a-popconfirm"),le=i("a-table"),re=i("a-input-number"),se=i("a-modal");return c(),b("div",be,[s("div",ye,[s("div",he,[s("div",ke,[a(R,{layout:"inline",model:v},{default:t(()=>[a(O,{label:"会员昵称"},{default:t(()=>[a(te,{value:v.memberNickname,"onUpdate:value":e[0]||(e[0]=o=>v.memberNickname=o),placeholder:"请输入会员昵称","allow-clear":""},null,8,["value"])]),_:1}),a(O,{label:"所属群组"},{default:t(()=>[a(ne,{value:v.groupId,"onUpdate:value":e[1]||(e[1]=o=>v.groupId=o),placeholder:"请选择群组","allow-clear":"","show-search":"","filter-option":!1,onSearch:H,style:{width:"200px"}},{default:t(()=>[(c(!0),b(V,null,A(j.value,o=>(c(),P(ae,{key:o.id,value:o.id},{default:t(()=>[m(w(o.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),a(O,null,{default:t(()=>[a(S,null,{default:t(()=>[a(h,{type:"primary",onClick:G},{default:t(()=>e[4]||(e[4]=[m("查询")])),_:1}),a(h,{onClick:M},{default:t(()=>e[5]||(e[5]=[m("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),s("div",we,[a(S,null,{default:t(()=>[a(h,{onClick:Y},{icon:t(()=>[a($(L))]),default:t(()=>[e[6]||(e[6]=m(" 邀请有礼 "))]),_:1}),a(h,{type:"primary",onClick:J},{icon:t(()=>[a($(fe))]),default:t(()=>[e[7]||(e[7]=m(" 新增会员 "))]),_:1})]),_:1})])]),a(le,{columns:F,"data-source":U.value,loading:f.value,pagination:g,onChange:q},{bodyCell:t(({column:o,record:k})=>[o.key==="accountList"?(c(),b("div",Ce,[(c(!0),b(V,null,A(k.accountList,u=>(c(),b("div",null,[s("div",null,[a(S,null,{default:t(()=>[m(" 账号："+w(u.account)+" ",1),a(T,{color:"warning"},{default:t(()=>[m(w($(r).getEnumText("AccountAuditStatus",u.accountAuditStatus)),1)]),_:2},1024)]),_:2},1024)]),s("div",xe,[e[9]||(e[9]=s("span",{class:"label"},"主页：",-1)),s("a",{href:u.homeUrl,target:"_blank",class:"link-text"},w(u.homeUrl),9,Oe),a(h,{type:"link",size:"small",onClick:Ne=>ee(u.homeUrl)},{default:t(()=>e[8]||(e[8]=[m(" 复制 ")])),_:2},1032,["onClick"])])]))),256))])):z("",!0),o.key==="groups"?(c(!0),b(V,{key:1},A(k.groups,u=>(c(),b("div",null,[s("span",null,w(u.groupName),1),u.isGroupOwner?(c(),P(T,{key:0,color:"blue",style:{"margin-left":"10px"}},{default:t(()=>e[10]||(e[10]=[m("群主")])),_:1})):z("",!0)]))),256)):z("",!0),o.key==="action"?(c(),P(S,{key:2},{default:t(()=>[s("a",{onClick:u=>Q(k)},"编辑",8,Se),s("a",{onClick:u=>W(k)},"查看",8,ze),a(oe,{title:"确定要删除吗？",onConfirm:u=>X(k)},{default:t(()=>e[11]||(e[11]=[s("a",{class:"danger"},"删除",-1)])),_:2},1032,["onConfirm"])]),_:2},1024)):z("",!0)]),_:1},8,["data-source","loading","pagination"])]),a(se,{open:C.value,"onUpdate:open":e[3]||(e[3]=o=>C.value=o),title:"邀请有礼配置",onOk:Z,confirmLoading:I.value},{default:t(()=>[a(R,{"label-col":{span:6},"wrapper-col":{span:16}},{default:t(()=>[a(O,{label:"奖励金额",extra:"设置每成功邀请一位新会员的奖励金额"},{default:t(()=>[a(re,{value:N.value,"onUpdate:value":e[2]||(e[2]=o=>N.value=o),min:0,precision:2,step:1,formatter:o=>`¥ ${o}`,parser:o=>o.replace("¥ ",""),style:{width:"100%"}},null,8,["value","formatter","parser"])]),_:1})]),_:1})]),_:1},8,["open","confirmLoading"])])}}},Ae=ue(Ie,[["__scopeId","data-v-c5e84ee6"]]);export{Ae as default};

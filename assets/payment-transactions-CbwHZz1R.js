import{P as W}from"./PageHeader-_I5KT-O-.js";import{_ as X,b as Z,r as g,c as z,n as x,j as aa,k as ta,d as I,f as t,e as b,w as e,g as l,l as ea,m as P,o as p,i as d,t as i,v as _,q as S,F as R,M as na}from"./index-D-6dhutF.js";const sa={class:"payment-transactions content-container"},oa={class:"table-container"},ra={class:"table-header"},la={__name:"payment-transactions",setup(ia){const{t:o}=Z(),Y=x(),y=g(!1),n=z({transactionStatus:void 0,memberId:"",orderId:"",withdrawalId:Y.query.withdrawalId,timeRange:[]}),v=g(!1),H=g({}),$=g(""),N=aa(()=>[{title:o("withdrawal.transactions.orderId"),dataIndex:"orderId",key:"orderId"},{title:o("withdrawal.transactions.withdrawalId"),dataIndex:"withdrawalId",key:"withdrawalId"},{title:o("withdrawal.transactions.amount"),dataIndex:"amount",key:"amount",align:"right"},{title:o("withdrawal.transactions.account"),dataIndex:"account",key:"account"},{title:o("withdrawal.transactions.requestParams"),key:"requestParams",align:"center"},{title:o("withdrawal.transactions.responseData"),key:"responseData",align:"center"},{title:o("withdrawal.transactions.transactionStatus"),key:"transactionStatus",align:"center"},{title:o("withdrawal.transactions.requestTime"),dataIndex:"requestTime",key:"requestTime"},{title:o("withdrawal.transactions.responseTime"),dataIndex:"responseTime",key:"responseTime"}]),D=g([]),c=z({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0}),F=a=>({pending:o("withdrawal.transactions.pending"),success:o("withdrawal.transactions.success"),failed:o("withdrawal.transactions.failed")})[a]||a,U=a=>({pending:"blue",success:"green",failed:"red"})[a]||"default",V=a=>!a&&a!==0?"--":`¥ ${Number(a).toFixed(2)}`,C=()=>{c.current=1,k()},j=()=>{Object.assign(n,{transactionStatus:void 0,memberId:"",orderId:"",withdrawalId:"",timeRange:[]}),C()},B=a=>{c.current=a.current,c.pageSize=a.pageSize,k()},M=a=>{H.value=a,$.value=JSON.stringify(a,null,2),v.value=!0},J=a=>{na.info({title:o("withdrawal.transactions.errorInfo"),content:a.errorMessage})},k=async()=>{var a,s;y.value=!0;try{const u={page:c.current,pageSize:c.pageSize,transactionStatus:n.transactionStatus,memberId:n.memberId,orderId:n.orderId,withdrawalId:n.withdrawalId,startDate:(a=n.timeRange)==null?void 0:a[0],endDate:(s=n.timeRange)==null?void 0:s[1]},m=await ea("withdrawals.paymentTransactions",u);m.code===0?(D.value=m.data.list||[],c.total=m.data.total||0):P.error(m.message)}catch(u){console.error("加载数据失败:",u),P.error(o("withdrawal.transactions.loadDataFailed"))}finally{y.value=!1}};return ta(()=>{k()}),(a,s)=>{const u=l("a-select-option"),m=l("a-select"),h=l("a-form-item"),T=l("a-input"),E=l("a-range-picker"),f=l("a-button"),O=l("a-space"),A=l("a-form"),K=l("a-tag"),Q=l("a-table"),G=l("a-typography"),L=l("a-modal");return p(),I("div",sa,[t(W,{title:a.$t("withdrawal.transactions.pageTitle"),back:!0,style:{"margin-bottom":"32px",padding:"0"}},null,8,["title"]),b("div",oa,[b("div",ra,[t(A,{layout:"inline",model:n},{default:e(()=>[t(h,{label:a.$t("withdrawal.transactions.transactionStatus")},{default:e(()=>[t(m,{value:n.transactionStatus,"onUpdate:value":s[0]||(s[0]=r=>n.transactionStatus=r),placeholder:a.$t("withdrawal.transactions.transactionStatusPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:e(()=>[t(u,{value:"pending"},{default:e(()=>[d(i(a.$t("withdrawal.transactions.pending")),1)]),_:1}),t(u,{value:"success"},{default:e(()=>[d(i(a.$t("withdrawal.transactions.success")),1)]),_:1}),t(u,{value:"failed"},{default:e(()=>[d(i(a.$t("withdrawal.transactions.failed")),1)]),_:1})]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),t(h,{label:a.$t("withdrawal.transactions.orderId")},{default:e(()=>[t(T,{value:n.orderId,"onUpdate:value":s[1]||(s[1]=r=>n.orderId=r),placeholder:a.$t("withdrawal.transactions.orderIdPlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),t(h,{label:a.$t("withdrawal.transactions.withdrawalId")},{default:e(()=>[t(T,{value:n.withdrawalId,"onUpdate:value":s[2]||(s[2]=r=>n.withdrawalId=r),placeholder:a.$t("withdrawal.transactions.withdrawalIdPlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),t(h,{label:a.$t("withdrawal.transactions.transactionTime")},{default:e(()=>[t(E,{value:n.timeRange,"onUpdate:value":s[3]||(s[3]=r=>n.timeRange=r),"show-time":{format:"HH:mm"},format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["value"])]),_:1},8,["label"]),t(h,null,{default:e(()=>[t(O,null,{default:e(()=>[t(f,{type:"primary",onClick:C},{default:e(()=>[d(i(a.$t("common.search")),1)]),_:1}),t(f,{onClick:j},{default:e(()=>[d(i(a.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),t(Q,{columns:N.value,"data-source":D.value,loading:y.value,pagination:c,onChange:B,rowKey:"id"},{bodyCell:e(({column:r,record:w})=>[r.key==="transactionStatus"?(p(),I(R,{key:0},[t(K,{color:U(w.transactionStatus)},{default:e(()=>[d(i(F(w.transactionStatus)),1)]),_:2},1032,["color"]),w.errorMessage?(p(),S(f,{key:0,type:"link",size:"small",onClick:q=>J(w)},{default:e(()=>[d(i(a.$t("withdrawal.transactions.view")),1)]),_:2},1032,["onClick"])):_("",!0)],64)):_("",!0),r.key==="amount"?(p(),I(R,{key:1},[d(i(V(w.amount)),1)],64)):_("",!0),r.key==="requestParams"?(p(),S(f,{key:2,type:"link",size:"small",onClick:q=>M(w.requestParams)},{default:e(()=>[d(i(a.$t("withdrawal.transactions.view")),1)]),_:2},1032,["onClick"])):_("",!0),r.key==="responseData"?(p(),S(f,{key:3,type:"link",size:"small",onClick:q=>M(w.responseData)},{default:e(()=>[d(i(a.$t("withdrawal.transactions.view")),1)]),_:2},1032,["onClick"])):_("",!0)]),_:1},8,["columns","data-source","loading","pagination"])]),t(L,{open:v.value,"onUpdate:open":s[4]||(s[4]=r=>v.value=r),title:a.$t("withdrawal.transactions.dataDetails"),width:"800px",footer:null},{default:e(()=>[t(G,null,{default:e(()=>[b("pre",null,i($.value),1)]),_:1})]),_:1},8,["open","title"])])}}},ua=X(la,[["__scopeId","data-v-13b4445d"]]);export{ua as default};

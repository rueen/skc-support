import{_ as ye,a as ke,b as be,j as J,r as _,c as Q,k as we,d as m,e as u,f as o,w as a,g as d,l as N,m as h,h as Ce,o as c,F as C,n as O,p as g,i as p,t as s,s as f,q as $e,A as W,M as X,v as Se}from"./index-D8kOh7io.js";import{_ as Y}from"./CopyContent-ma2SbJZ7.js";import{G as Ae}from"./GroupOwner-DUqKwmW8.js";const je={class:"account content-container"},Ie={class:"table-container"},Re={class:"table-header"},Ne={style:{width:"100%",display:"flex","justify-content":"space-between"}},Oe={class:"right"},Ue={key:0,class:"account-info"},ze={class:"link-text-container"},Pe={class:"label"},Fe=["href"],Te={class:"stats"},Be={key:0,class:"stat-item"},Ee={key:1,class:"stat-item"},De={key:2,class:"stat-item"},Me={key:1},Ve={class:"danger"},Ge=["onClick"],Le={class:"danger"},Ke={__name:"list",setup(qe){const U=Ce(),z=ke(),{t:r}=be(),Z=J(()=>z.loaded?z.getEnumOptions("AccountAuditStatus"):[]),P=_(!1),v=_([]),$=_(!1),F=_(!1),y=_(""),i=Q({keyword:"",channelId:void 0,accountAuditStatus:"pending",groupId:void 0,memberId:void 0}),E=_([]),D=_([]),M=_([]),x=J(()=>[{title:r("account.list.accountInfo"),key:"accountInfo",width:500},{title:r("account.list.memberInfo"),key:"member"},{title:r("account.list.submitTime"),dataIndex:"submitTime",key:"submitTime"},{title:r("account.list.auditStatus"),dataIndex:"accountAuditStatus",key:"accountAuditStatus"},{title:r("account.list.waiterName"),key:"waiterName"},{title:r("account.list.action"),key:"action"}]),ee={selectedRowKeys:v,onChange:e=>{v.value=e},getCheckboxProps:e=>({disabled:e.accountAuditStatus!=="pending"})},V=_([]),k=Q({current:1,pageSize:10,total:0}),G=()=>{k.current=1,b()},te=()=>{i.keyword="",i.channelId=void 0,i.accountAuditStatus=void 0,i.groupId=void 0,i.memberId=void 0,G()},ae=e=>{U.push(`/member/view/${e.memberId}`)},ne=e=>{U.push({name:"AccountEdit",params:{id:e.id}})},oe=e=>{X.error({content:e.rejectReason})},le=()=>{U.push("/account/old")},se=e=>{Object.assign(k,{current:e.current,pageSize:e.pageSize}),b()},ce=async e=>{v.value=[e.id],L()},L=async()=>{if(!v.value.length){h.warning(r("account.list.message.selectAccount"));return}const e=await W("account.batchResolve",{ids:v.value});if(e.code===0){const n=e.data.failed.map(T=>T.reason).join(",");n?X.error({title:r("account.list.batchRejectFailedTitle"),content:n}):(h.success(r("account.list.message.success")),v.value=[],b())}else h.error(e.message)},ue=async()=>{if(!v.value.length){h.warning(r("account.list.message.selectAccount"));return}y.value="",$.value=!0},ie=e=>{v.value=[e.id],y.value="",$.value=!0},de=async()=>{if(!y.value){h.error(r("account.list.message.rejectReason"));return}F.value=!0;try{const e=await W("account.batchReject",{ids:v.value,rejectReason:y.value});e.code===0?(h.success(r("account.list.message.success")),v.value=[],$.value=!1,b()):h.error(e.message)}catch(e){console.log(e)}finally{F.value=!1}},b=async()=>{P.value=!0;try{const e=await N("account.list",{page:k.current,pageSize:k.pageSize,...i});e.code===0?(V.value=e.data.list,k.total=e.data.total):h.error(e.message)}finally{P.value=!1}},re=async()=>{const e=await N("channel.list");e.code===0&&(E.value=e.data.list)},K=async(e="")=>{try{const n=await N("group.list",{page:1,pageSize:50,groupName:e});n.code===0&&(D.value=n.data.list||[])}catch{h.error("获取群组列表失败")}},q=async(e="")=>{const n=await N("member.list",{page:1,pageSize:50,memberNickname:e});n.code===0&&(M.value=n.data.list||[])},me=async e=>{const n=await Se("account.delete",{},{urlParams:{id:e.id}});n.code===0?(h.success(n.message),b()):h.error(n.message)};return we(()=>{b(),K(),re(),q()}),(e,n)=>{const T=d("a-input"),w=d("a-form-item"),I=d("a-select-option"),R=d("a-select"),S=d("a-button"),A=d("a-space"),pe=d("a-form"),fe=d("a-avatar"),H=d("a-typography-link"),he=d("info-circle-outlined"),B=d("a-popconfirm"),ve=d("a-table"),_e=d("a-textarea"),ge=d("a-modal");return c(),m("div",je,[u("div",Ie,[u("div",Re,[o(pe,{layout:"inline",model:i},{default:a(()=>[o(w,{label:e.$t("account.search.account")},{default:a(()=>[o(T,{value:i.keyword,"onUpdate:value":n[0]||(n[0]=t=>i.keyword=t),placeholder:e.$t("account.search.accountPlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),o(w,{label:e.$t("account.search.channel")},{default:a(()=>[o(R,{value:i.channelId,"onUpdate:value":n[1]||(n[1]=t=>i.channelId=t),placeholder:e.$t("account.search.channelPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:a(()=>[(c(!0),m(C,null,O(E.value,t=>(c(),g(I,{key:t.id,value:t.id},{default:a(()=>[p(s(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),o(w,{label:e.$t("account.search.auditStatus")},{default:a(()=>[o(R,{value:i.accountAuditStatus,"onUpdate:value":n[2]||(n[2]=t=>i.accountAuditStatus=t),placeholder:e.$t("account.search.auditStatusPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:a(()=>[(c(!0),m(C,null,O(Z.value,t=>(c(),g(I,{key:t.value,value:t.value},{default:a(()=>[p(s(t.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),o(w,{label:e.$t("account.search.group")},{default:a(()=>[o(R,{value:i.groupId,"onUpdate:value":n[3]||(n[3]=t=>i.groupId=t),placeholder:e.$t("account.search.groupPlaceholder"),style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:K},{default:a(()=>[(c(!0),m(C,null,O(D.value,t=>(c(),g(I,{key:t.id,value:t.id},{default:a(()=>[p(s(t.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),o(w,{label:e.$t("account.search.member")},{default:a(()=>[o(R,{value:i.memberId,"onUpdate:value":n[4]||(n[4]=t=>i.memberId=t),placeholder:e.$t("account.search.memberPlaceholder"),style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:q},{default:a(()=>[(c(!0),m(C,null,O(M.value,t=>(c(),g(I,{key:t.id,value:t.id},{default:a(()=>[p(s(t.nickname),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),o(w,null,{default:a(()=>[o(A,null,{default:a(()=>[o(S,{type:"primary",onClick:G},{default:a(()=>[p(s(e.$t("common.search")),1)]),_:1}),o(S,{onClick:te},{default:a(()=>[p(s(e.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),u("div",Ne,[o(S,{onClick:le},{default:a(()=>[p(s(e.$t("account.list.oldAccount")),1)]),_:1}),u("div",Oe,[o(A,null,{default:a(()=>[o(S,{type:"primary",onClick:L},{default:a(()=>[p(s(e.$t("common.batchResolve")),1)]),_:1}),o(S,{danger:"",onClick:ue},{default:a(()=>[p(s(e.$t("common.batchReject")),1)]),_:1})]),_:1})])])]),o(ve,{columns:x.value,"data-source":V.value,loading:P.value,pagination:k,"row-selection":ee,rowKey:"id",onChange:se},{bodyCell:a(({column:t,record:l})=>[t.key==="accountInfo"?(c(),m("div",Ue,[o(A,null,{default:a(()=>[o(fe,{src:l.channelIcon,size:"small"},null,8,["src"]),u("span",null,s(l.account),1)]),_:2},1024),u("div",null,[u("div",ze,[u("span",Pe,s(e.$t("account.list.homepage"))+"：",1),o(Y,{content:l.homeUrl},{default:a(()=>[o(H,null,{default:a(()=>[u("a",{href:l.homeUrl,target:"_blank"},s(l.homeUrl),9,Fe)]),_:2},1024)]),_:2},1032,["content"])])]),u("div",null,[n[7]||(n[7]=u("span",{class:"label"},"uid：",-1)),o(Y,{content:l.uid},null,8,["content"])]),u("div",Te,[l.channelCustomFields.includes("fansCount")?(c(),m("div",Be,s(e.$t("account.list.fansCount"))+"："+s(l.fansCount),1)):f("",!0),l.channelCustomFields.includes("friendsCount")?(c(),m("div",Ee,s(e.$t("account.list.friendsCount"))+"："+s(l.friendsCount),1)):f("",!0),l.channelCustomFields.includes("postsCount")?(c(),m("div",De,s(e.$t("account.list.postsCount"))+"："+s(l.postsCount),1)):f("",!0)])])):f("",!0),t.key==="member"?(c(),m("div",Me,[u("div",null,[o(H,{onClick:j=>ae(l)},{default:a(()=>[p(s(l.memberNickname),1)]),_:2},1032,["onClick"])]),o(A,{class:"group-name"},{default:a(()=>[u("span",null,s(l.groupName),1),l.isGroupOwner?(c(),g(Ae,{key:0})):f("",!0)]),_:2},1024)])):f("",!0),t.key==="accountAuditStatus"?(c(),m(C,{key:2},[p(s($e(z).getEnumText("AccountAuditStatus",l.accountAuditStatus))+" ",1),l.accountAuditStatus==="rejected"?(c(),g(he,{key:0,class:"danger",onClick:j=>oe(l)},null,8,["onClick"])):f("",!0)],64)):f("",!0),t.key==="waiterName"?(c(),m(C,{key:3},[p(s(l.waiterName||"--"),1)],64)):f("",!0),t.key==="action"?(c(),g(A,{key:4},{default:a(()=>[l.accountAuditStatus==="pending"?(c(),g(B,{key:0,title:e.$t("account.list.resolveConfirm"),onConfirm:j=>ce(l)},{default:a(()=>[u("a",null,s(e.$t("account.list.resolve")),1)]),_:2},1032,["title","onConfirm"])):f("",!0),l.accountAuditStatus==="pending"?(c(),g(B,{key:1,title:e.$t("account.list.rejectConfirm"),onConfirm:j=>ie(l)},{default:a(()=>[u("a",Ve,s(e.$t("account.list.reject")),1)]),_:2},1032,["title","onConfirm"])):f("",!0),u("a",{onClick:j=>ne(l)},s(e.$t("common.edit")),9,Ge),o(B,{title:e.$t("common.deleteConfirm"),onConfirm:j=>me(l)},{default:a(()=>[u("a",Le,s(e.$t("common.delete")),1)]),_:2},1032,["title","onConfirm"])]),_:2},1024)):f("",!0)]),_:1},8,["columns","data-source","loading","pagination"])]),o(ge,{open:$.value,"onUpdate:open":n[6]||(n[6]=t=>$.value=t),title:e.$t("account.list.rejectReason"),onOk:de,confirmLoading:F.value},{default:a(()=>[o(_e,{value:y.value,"onUpdate:value":n[5]||(n[5]=t=>y.value=t),placeholder:e.$t("account.list.rejectReasonPlaceholder"),rows:4},null,8,["value","placeholder"])]),_:1},8,["open","title","confirmLoading"])])}}},We=ye(Ke,[["__scopeId","data-v-0e89aceb"]]);export{We as default};

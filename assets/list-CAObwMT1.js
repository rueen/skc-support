import{c as a,I as re,_ as se,r as h,a as j,j as ie,b as k,d as s,w as t,e as i,k as u,f as ce,o as m,F as I,l as A,m as S,h as g,t as O,g as G,P as ue,n as x}from"./index-CUxxoPlX.js";import{g as H,p as de}from"./request-BwrBeGQu.js";var pe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 310H732.4c13.6-21.4 21.6-46.8 21.6-74 0-76.1-61.9-138-138-138-41.4 0-78.7 18.4-104 47.4-25.3-29-62.6-47.4-104-47.4-76.1 0-138 61.9-138 138 0 27.2 7.9 52.6 21.6 74H144c-17.7 0-32 14.3-32 32v200c0 4.4 3.6 8 8 8h40v344c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V550h40c4.4 0 8-3.6 8-8V342c0-17.7-14.3-32-32-32zm-334-74c0-38.6 31.4-70 70-70s70 31.4 70 70-31.4 70-70 70h-70v-70zm-138-70c38.6 0 70 31.4 70 70v70h-70c-38.6 0-70-31.4-70-70s31.4-70 70-70zM180 482V378h298v104H180zm48 68h250v308H228V550zm568 308H546V550h250v308zm48-376H546V378h298v104z"}}]},name:"gift",theme:"outlined"};function B(d){for(var l=1;l<arguments.length;l++){var r=arguments[l]!=null?Object(arguments[l]):{},c=Object.keys(r);typeof Object.getOwnPropertySymbols=="function"&&(c=c.concat(Object.getOwnPropertySymbols(r).filter(function(p){return Object.getOwnPropertyDescriptor(r,p).enumerable}))),c.forEach(function(p){me(d,p,r[p])})}return d}function me(d,l,r){return l in d?Object.defineProperty(d,l,{value:r,enumerable:!0,configurable:!0,writable:!0}):d[l]=r,d}var V=function(l,r){var c=B({},l,r.attrs);return a(re,B({},c,{icon:pe}),null)};V.displayName="GiftOutlined";V.inheritAttrs=!1;const fe={class:"member-list content-container"},_e={class:"table-container"},ve={class:"table-header"},ge={class:"left"},be={class:"right"},he={class:"home-link-container"},ye=["href"],ke=["onClick"],we=["onClick"],Ce={__name:"list",setup(d){const l=ce(),r=h(!1),c=h(!1),p=h(!1),z=h(10),f=j({memberName:"",groupId:void 0}),L=h([]),_=j({current:1,pageSize:10,total:0}),$=h([]),D=[{title:"会员名称",dataIndex:"name",key:"name"},{title:"账号信息",key:"channelAccountList"},{title:"所属群组",dataIndex:"groupName",key:"groupName"},{title:"创建时间",dataIndex:"createTime",key:"createTime",width:180},{title:"操作",key:"action",fixed:"right",width:200}],P=()=>{_.current=1,w()},R=()=>{Object.assign(f,{memberName:"",groupId:void 0}),P()},T=n=>{_.current=n.current,_.pageSize=n.pageSize,w()},E=()=>{l.push("/member/create")},F=n=>{l.push(`/member/edit/${n.id}`)},M=n=>{l.push(`/member/view/${n.id}`)},q=async n=>{try{const e=await de("member.delete",{id:n.id});e.success?(u.success("删除成功"),w()):u.error(e.message)}catch{u.error("删除失败")}},J=async()=>{c.value=!0,await W()},Q=async()=>{try{p.value=!0,u.success("保存成功"),c.value=!1}catch{u.error("保存失败")}finally{p.value=!1}},W=async()=>{try{z.value=10}catch{u.error("获取配置失败")}},w=async()=>{r.value=!0;try{const n=await H("member.list",{params:{page:_.current,pageSize:_.pageSize,...f}});n.success?(L.value=n.data.list,_.total=n.data.total):u.error(n.message)}finally{r.value=!1}},X=async(n="")=>{try{const e=await H("group.list",{params:{page:1,pageSize:50,keyword:n}});e.success&&($.value=e.data.list||[])}catch{u.error("获取群组列表失败")}},Y=n=>{navigator.clipboard.writeText(n).then(()=>{u.success("链接已复制到剪贴板")}).catch(()=>{u.error("复制失败，请手动复制")})};return ie(()=>{w(),X()}),(n,e)=>{const Z=i("a-input"),C=i("a-form-item"),K=i("a-select-option"),ee=i("a-select"),y=i("a-button"),N=i("a-space"),U=i("a-form"),te=i("a-tag"),ae=i("a-popconfirm"),ne=i("a-table"),oe=i("a-input-number"),le=i("a-modal");return m(),k("div",fe,[s("div",_e,[s("div",ve,[s("div",ge,[a(U,{layout:"inline",model:f},{default:t(()=>[a(C,{label:"会员名称"},{default:t(()=>[a(Z,{value:f.memberName,"onUpdate:value":e[0]||(e[0]=o=>f.memberName=o),placeholder:"请输入会员名称","allow-clear":""},null,8,["value"])]),_:1}),a(C,{label:"所属群组"},{default:t(()=>[a(ee,{value:f.groupId,"onUpdate:value":e[1]||(e[1]=o=>f.groupId=o),placeholder:"请选择群组",style:{width:"120px"},"allow-clear":""},{default:t(()=>[(m(!0),k(I,null,A($.value,o=>(m(),S(K,{key:o.id,value:o.id},{default:t(()=>[g(O(o.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),a(C,null,{default:t(()=>[a(N,null,{default:t(()=>[a(y,{type:"primary",onClick:P},{default:t(()=>e[4]||(e[4]=[g("查询")])),_:1}),a(y,{onClick:R},{default:t(()=>e[5]||(e[5]=[g("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),s("div",be,[a(N,null,{default:t(()=>[a(y,{onClick:J},{icon:t(()=>[a(G(V))]),default:t(()=>[e[6]||(e[6]=g(" 邀请有礼 "))]),_:1}),a(y,{type:"primary",onClick:E},{icon:t(()=>[a(G(ue))]),default:t(()=>[e[7]||(e[7]=g(" 新增会员 "))]),_:1})]),_:1})])]),a(ne,{columns:D,"data-source":L.value,loading:r.value,pagination:_,onChange:T},{bodyCell:t(({column:o,record:b})=>[o.key==="channelAccountList"?(m(!0),k(I,{key:0},A(b.channelAccountList,v=>(m(),k("div",null,[s("div",null,"账号："+O(v.account),1),s("div",he,[e[9]||(e[9]=s("span",null,"主页：",-1)),s("a",{href:v.homeUrl,target:"_blank",class:"home-link"},O(v.homeUrl),9,ye),a(y,{type:"link",size:"small",onClick:Oe=>Y(v.homeUrl),class:"copy-btn"},{default:t(()=>e[8]||(e[8]=[g(" 复制 ")])),_:2},1032,["onClick"])])]))),256)):x("",!0),o.key==="groupName"?(m(),k(I,{key:1},[s("span",null,O(b.groupName),1),b.isGroupOwner?(m(),S(te,{key:0,color:"blue",style:{"margin-left":"10px"}},{default:t(()=>e[10]||(e[10]=[g("群主")])),_:1})):x("",!0)],64)):x("",!0),o.key==="action"?(m(),S(N,{key:2},{default:t(()=>[s("a",{onClick:v=>F(b)},"编辑",8,ke),s("a",{onClick:v=>M(b)},"查看",8,we),a(ae,{title:"确定要删除吗？",onConfirm:v=>q(b)},{default:t(()=>e[11]||(e[11]=[s("a",{class:"danger"},"删除",-1)])),_:2},1032,["onConfirm"])]),_:2},1024)):x("",!0)]),_:1},8,["data-source","loading","pagination"])]),a(le,{open:c.value,"onUpdate:open":e[3]||(e[3]=o=>c.value=o),title:"邀请有礼配置",onOk:Q,confirmLoading:p.value},{default:t(()=>[a(U,{"label-col":{span:6},"wrapper-col":{span:16}},{default:t(()=>[a(C,{label:"奖励金额",extra:"设置每成功邀请一位新会员的奖励金额"},{default:t(()=>[a(oe,{value:z.value,"onUpdate:value":e[2]||(e[2]=o=>z.value=o),min:0,precision:2,step:1,formatter:o=>`¥ ${o}`,parser:o=>o.replace("¥ ",""),style:{width:"100%"}},null,8,["value","formatter","parser"])]),_:1})]),_:1})]),_:1},8,["open","confirmLoading"])])}}},Ne=se(Ce,[["__scopeId","data-v-85447baf"]]);export{Ne as default};

import{g as f,p as L}from"./request-DpAzyv0l.js";import{_ as N,r as i,a as P,j as q,b as D,d as m,c as o,w as s,e as n,o as v,m as E,n as M,k as y}from"./index-DCqgSKVo.js";const O={class:"article content-container"},j={class:"table-container"},z=["onClick"],$={class:"editor-wrapper"},F={__name:"index",setup(G){const c=i(!1),r=i(!1),d=i(!1),p=i(),a=P({id:null,title:"",content:""}),g={title:[{required:!0,message:"请输入文章标题"}],content:[{required:!0,message:"请输入文章内容"}]},k=[{title:"文章标题",dataIndex:"title",key:"title"},{title:"更新时间",dataIndex:"updatedAt",key:"updatedAt"},{title:"操作",key:"action",width:100}],u=i([]),w=e=>{a.id=e.id,a.title=e.title,a.content=e.content,r.value=!0},x=async()=>{p.value.validate().then(async()=>{d.value=!0;try{const e=await L("article.edit",{location:a.location,...a});e.code===0?(y.success("保存成功"),r.value=!1):y.error(e.message)}catch(e){console.error(e)}finally{d.value=!1}})},b=async()=>{c.value=!0;try{const e=await f("article.get",{params:{location:"userAgreement"}});e.code===0&&u.value.push(e.data||{})}finally{c.value=!1}},h=async()=>{c.value=!0;try{const e=await f("article.get",{params:{location:"privacyPolicy"}});e.code===0&&u.value.push(e.data||{})}finally{c.value=!1}};return q(()=>{b(),h()}),(e,l)=>{const C=n("a-space"),A=n("a-table"),B=n("a-input"),_=n("a-form-item"),R=n("a-textarea"),U=n("a-form"),V=n("a-modal");return v(),D("div",O,[m("div",j,[o(A,{columns:k,"data-source":u.value,loading:c.value,pagination:!1},{bodyCell:s(({column:t,record:I})=>[t.key==="action"?(v(),E(C,{key:0},{default:s(()=>[m("a",{onClick:H=>w(I)},"编辑",8,z)]),_:2},1024)):M("",!0)]),_:1},8,["data-source","loading"])]),o(V,{open:r.value,"onUpdate:open":l[2]||(l[2]=t=>r.value=t),title:"编辑文章",width:800,confirmLoading:d.value,onOk:x},{default:s(()=>[o(U,{ref_key:"formRef",ref:p,model:a,rules:g,"label-col":{span:4},"wrapper-col":{span:19}},{default:s(()=>[o(_,{label:"文章标题",name:"title"},{default:s(()=>[o(B,{value:a.title,"onUpdate:value":l[0]||(l[0]=t=>a.title=t),placeholder:"请输入文章标题"},null,8,["value"])]),_:1}),o(_,{label:"文章内容",name:"content"},{default:s(()=>[m("div",$,[o(R,{value:a.content,"onUpdate:value":l[1]||(l[1]=t=>a.content=t),placeholder:"请输入文章内容","auto-size":{minRows:10,maxRows:20}},null,8,["value"])])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","confirmLoading"])])}}},Q=N(F,[["__scopeId","data-v-6a53381f"]]);export{Q as default};

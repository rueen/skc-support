import{P as V}from"./index-B-oDVabI.js";import{_ as q,r as d,a as E,n as P,b as U,c as r,w as o,e as l,p as M,j as _,o as p,d as i,s as v,v as b,h as y,B as O}from"./index-CBL5KShI.js";const D={class:"system-config-container"},G={__name:"config",setup(H){const w=d(null),c=d(!1),f=d(!1),s=d(!0),t=E({max_group_members:null,group_owner_commission_rate:null,invite_reward_amount:null}),k={max_group_members:[{required:!0,message:"请输入最大群成员数",trigger:"blur"},{type:"number",min:10,max:1e3,message:"群成员数必须在 10-1000 之间",trigger:"blur"}],group_owner_commission_rate:[{required:!0,message:"请输入群主收益率",trigger:"blur"},{type:"number",min:0,max:100,message:"收益率必须在 0-100 之间",trigger:"blur"}],invite_reward_amount:[{required:!0,message:"请输入邀请奖励金额",trigger:"blur"},{type:"number",min:0,max:1e3,message:"奖励金额必须在 0-1000 之间",trigger:"blur"}]},x=async()=>{c.value=!0;try{const a=await M("system.getAllConfig");if(a&&a.data){const e={};Object.values(a.data).forEach(n=>{e[n.key]=n}),Object.assign(t,{max_group_members:e.max_group_members.value,group_owner_commission_rate:e.group_owner_commission_rate.value,invite_reward_amount:e.invite_reward_amount.value})}}catch(a){_.error("获取系统配置失败："+(a.message||"未知错误"))}finally{c.value=!1}},C=async()=>{f.value=!0;try{const a=await O("system.saveAllConfig",{configs:t});a&&a.code===0?(_.success("保存系统配置成功"),s.value=!0):_.error(a.message||"保存失败")}catch(a){_.error("保存系统配置失败："+(a.message||"未知错误"))}finally{f.value=!1}},B=()=>{w.value.validate().then(()=>{C()}).catch(a=>{console.error("表单验证失败",a)})},R=()=>{s.value=!1},j=()=>{x()};return P(()=>{x()}),(a,e)=>{const n=l("a-input-number"),u=l("a-form-item"),g=l("a-button"),A=l("a-space"),N=l("a-form"),S=l("a-spin");return p(),U("div",D,[r(V,{title:"系统配置",back:!0}),r(S,{spinning:c.value},{default:o(()=>[r(N,{model:t,rules:k,ref_key:"formRef",ref:w,"label-col":{span:6},"wrapper-col":{span:12}},{default:o(()=>[r(u,{label:"最大群成员数",name:"maxGroupMembers"},{default:o(()=>[r(n,{value:t.max_group_members,"onUpdate:value":e[0]||(e[0]=m=>t.max_group_members=m),min:1,max:1e3,placeholder:"请输入最大群成员数",disabled:s.value},null,8,["value","disabled"]),e[3]||(e[3]=i("div",{class:"form-item-desc"},[i("div",null,"设置单个群组可容纳的最大成员数量"),i("div",null,"群成员数量限制的配置修改后会立即生效，但不会对已有的超出新限制的群组产生影响")],-1))]),_:1}),r(u,{label:"群主收益率",name:"ownerProfitRate"},{default:o(()=>[r(n,{value:t.group_owner_commission_rate,"onUpdate:value":e[1]||(e[1]=m=>t.group_owner_commission_rate=m),min:0,max:100,step:.1,precision:1,addonAfter:"%",placeholder:"请输入群主收益率",disabled:s.value},null,8,["value","disabled"]),e[4]||(e[4]=i("div",{class:"form-item-desc"},"设置群主可获得的任务收益分成比例",-1))]),_:1}),r(u,{label:"邀请奖励金额",name:"inviteRewardAmount"},{default:o(()=>[r(n,{value:t.invite_reward_amount,"onUpdate:value":e[2]||(e[2]=m=>t.invite_reward_amount=m),min:0,max:1e3,step:.1,precision:1,addonBefore:"¥",placeholder:"请输入邀请奖励金额",disabled:s.value},null,8,["value","disabled"]),e[5]||(e[5]=i("div",{class:"form-item-desc"},"设置每成功邀请一位新会员的奖励金额",-1))]),_:1}),r(u,{"wrapper-col":{span:12,offset:6}},{default:o(()=>[r(A,null,{default:o(()=>[s.value?b("",!0):(p(),v(g,{key:0,type:"primary",onClick:B,loading:f.value},{default:o(()=>e[6]||(e[6]=[y("保存配置")])),_:1},8,["loading"])),s.value?(p(),v(g,{key:1,onClick:R},{default:o(()=>e[7]||(e[7]=[y("编辑配置")])),_:1})):b("",!0),s.value?b("",!0):(p(),v(g,{key:2,onClick:j},{default:o(()=>e[8]||(e[8]=[y("重置")])),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},z=q(G,[["__scopeId","data-v-a4b4dca1"]]);export{z as default};

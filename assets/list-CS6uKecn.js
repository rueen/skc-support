import{_ as Y,r as N,a as Z,b as x,c as B,j as D,k as ee,d,e as m,f as s,w as a,g as c,l as F,m as S,h as te,o as l,F as p,n as V,p as b,i as r,t as n,q,P as ae,s as h,v as se}from"./index-CgSCA0Xz.js";const ne={class:"task content-container"},le={class:"table-container"},oe={class:"table-header"},ue={class:"left"},ie={class:"right"},ce={key:0},de={key:1},re=["onClick"],ke={class:"danger"},me={__name:"list",setup(_e){const T=te(),C=N(!1),f=Z(),{t:k}=x(),o=B({taskName:"",channelId:void 0,taskStatus:void 0}),w=N([]),z=D(()=>f.loaded?f.getEnumOptions("TaskStatus"):[]),Q=D(()=>[{title:k("task.list.name"),key:"taskName"},{title:k("task.list.status"),dataIndex:"taskStatus",key:"taskStatus",customRender:({text:e})=>f.getEnumText("TaskStatus",e)},{title:k("task.list.quota"),key:"taskQuota"},{title:k("task.list.time"),key:"taskTime"},{title:k("task.list.action"),key:"action",fixed:"right",width:180}]),I=N([]),_=B({current:1,pageSize:10,total:0}),E=()=>{_.current=1,v()},R=()=>{o.taskName="",o.channelId=void 0,o.taskStatus=void 0,E()},U=e=>{Object.assign(_,e),v()},j=()=>{T.push("/task/create")},A=e=>{T.push(`/task/edit/${e.id}`)},L=async e=>{try{const u=await se("task.delete",{},{urlParams:{id:e.id}});u.code===0?(S.success(k("common.deleteSuccess")),v()):S.error(u.message)}catch{S.error(k("common.deleteFailed"))}},v=async()=>{C.value=!0;try{const e=await F("task.list",{page:_.current,pageSize:_.pageSize,...o});e.code===0?(I.value=e.data.list,_.total=e.data.total):S.error(e.message)}finally{C.value=!1}},M=async()=>{const e=await F("channel.list");e.code===0&&(w.value=e.data.list)};return ee(async()=>{v(),M()}),(e,u)=>{const G=c("a-input"),y=c("a-form-item"),O=c("a-select-option"),P=c("a-select"),$=c("a-button"),g=c("a-space"),H=c("a-form"),J=c("a-avatar"),K=c("a-popconfirm"),W=c("a-table");return l(),d("div",ne,[m("div",le,[m("div",oe,[m("div",ue,[s(H,{layout:"inline",model:o},{default:a(()=>[s(y,{label:e.$t("task.search.taskName")},{default:a(()=>[s(G,{value:o.taskName,"onUpdate:value":u[0]||(u[0]=t=>o.taskName=t),placeholder:e.$t("task.search.taskNamePlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),s(y,{label:e.$t("task.search.channelId")},{default:a(()=>[s(P,{value:o.channelId,"onUpdate:value":u[1]||(u[1]=t=>o.channelId=t),placeholder:e.$t("task.search.channelPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:a(()=>[(l(!0),d(p,null,V(w.value,t=>(l(),b(O,{key:t.id,value:t.id},{default:a(()=>[r(n(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),s(y,{label:e.$t("task.search.taskStatus")},{default:a(()=>[s(P,{value:o.taskStatus,"onUpdate:value":u[2]||(u[2]=t=>o.taskStatus=t),placeholder:e.$t("task.search.statusPlaceholder"),allowClear:""},{default:a(()=>[(l(!0),d(p,null,V(z.value,t=>(l(),b(O,{key:t.value,value:t.value},{default:a(()=>[r(n(t.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),s(y,null,{default:a(()=>[s(g,null,{default:a(()=>[s($,{type:"primary",onClick:E},{default:a(()=>[r(n(e.$t("common.search")),1)]),_:1}),s($,{onClick:R},{default:a(()=>[r(n(e.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),m("div",ie,[s(g,null,{default:a(()=>[s($,{type:"primary",onClick:j},{icon:a(()=>[s(q(ae))]),default:a(()=>[r(" "+n(e.$t("task.list.create")),1)]),_:1})]),_:1})])]),s(W,{columns:Q.value,"data-source":I.value,loading:C.value,pagination:_,onChange:U},{bodyCell:a(({column:t,record:i})=>[t.key==="taskName"?(l(),b(g,{key:0},{default:a(()=>[s(J,{src:i.channelIcon},null,8,["src"]),r(" "+n(i.taskName),1)]),_:2},1024)):h("",!0),t.key==="taskTime"?(l(),d(p,{key:1},[r(n(i.startTime)+" - "+n(i.endTime),1)],64)):h("",!0),t.key==="taskQuota"?(l(),d(p,{key:2},[i.unlimitedQuota?(l(),d("span",ce,n(e.$t("task.list.unlimited")),1)):(l(),d("span",de,n(i.quota),1)),m("span",null," / "+n(i.submittedCount),1)],64)):h("",!0),t.key==="taskStatus"?(l(),d(p,{key:3},[r(n(q(f).getEnumText("TaskStatus",i.taskStatus)),1)],64)):h("",!0),t.key==="action"?(l(),b(g,{key:4},{default:a(()=>[m("a",{onClick:X=>A(i)},n(e.$t("task.list.edit")),9,re),s(K,{title:e.$t("task.list.deleteConfirm"),onConfirm:X=>L(i)},{default:a(()=>[m("a",ke,n(e.$t("task.list.delete")),1)]),_:2},1032,["title","onConfirm"])]),_:2},1024)):h("",!0)]),_:1},8,["columns","data-source","loading","pagination"])])])}}},he=Y(me,[["__scopeId","data-v-e7eeee08"]]);export{he as default};

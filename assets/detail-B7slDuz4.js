import{_ as X,l as Y,r as S,a as T,n as Z,b as f,c as a,d as i,w as t,e as _,p as C,y as $,j as m,f as ee,o as d,h as s,t as l,g as B,v as g,F as x,q as N,s as b,B as O}from"./index-Dp6bA9zn.js";import{P as te}from"./index-DW59H2kk.js";const ae={class:"task-audit-detail content-container"},se={class:"detail-container"},le={class:"detail-section"},oe={class:"detail-section"},ne={key:0},re={class:"detail-section"},ie={class:"detail-section"},de={class:"footer-btns"},ue={class:"left"},ce={class:"right"},me={__name:"detail",setup(_e){const I=Y(),R=$(),h=ee(),v=S(!1),A=S(!1),k=S(""),c=T({submitContent:{}}),r=T({}),p=T({}),V=async()=>{const n=await O("taskSubmitted.batchResolve",{ids:[R.params.id]});n.code===0?(m.success("审核通过成功"),h.back()):m.error(n.message)},q=()=>{k.value="",v.value=!0},D=async()=>{if(!k.value){m.error("请输入拒绝原因");return}A.value=!0;const n=await O("taskSubmitted.batchReject",{ids:[R.params.id],reason:k.value});n.code===0?(m.success("审核拒绝成功"),v.value=!1,h.back()):m.error(n.message)},E=()=>{},L=()=>{},F=async n=>{try{const e=await C("task.detail",{},{urlParams:{id:n}});e.code===0?Object.assign(r,e.data):m.error(e.message)}catch{m.error("获取任务详情失败")}},M=async n=>{try{const e=await C("member.detail",{},{urlParams:{id:n}});e.code===0?Object.assign(p,e.data):m.error(e.message)}catch{m.error("获取会员详情失败")}},U=async()=>{try{const n=await C("taskSubmitted.detail",{},{urlParams:{id:R.params.id}});n.code===0&&(Object.assign(c,n.data),n.data.taskId!=null&&await F(n.data.taskId),n.data.memberId!=null&&await M(n.data.memberId))}catch{m.error("获取详情失败")}};return Z(()=>{U()}),(n,e)=>{const o=_("a-descriptions-item"),y=_("a-descriptions"),G=_("a-tag"),H=_("a-image"),j=_("a-button"),P=_("a-space"),Q=_("a-textarea"),z=_("a-modal");return d(),f("div",ae,[a(te,{title:"任务审核详情",back:!0}),i("div",se,[i("div",le,[e[2]||(e[2]=i("div",{class:"section-title"},"任务信息",-1)),a(y,{column:2},{default:t(()=>[a(o,{label:"任务名称"},{default:t(()=>[s(l(r.taskName),1)]),_:1}),a(o,{label:"平台渠道"},{default:t(()=>[s(l(r.channelName),1)]),_:1}),a(o,{label:"达人领域"},{default:t(()=>[s(l(r.category),1)]),_:1}),a(o,{label:"任务类型"},{default:t(()=>[s(l(B(I).getEnumText("TaskType",r.type)),1)]),_:1}),a(o,{label:"任务奖励"},{default:t(()=>[s(l(r.reward)+" 元",1)]),_:1}),a(o,{label:"品牌"},{default:t(()=>[s(l(r.brand),1)]),_:1}),a(o,{label:"指定群组"},{default:t(()=>{var u;return[s(l((u=r.groupNames)==null?void 0:u.join("、")),1)]}),_:1}),a(o,{label:"任务时间"},{default:t(()=>[s(l(r.startTime)+" 至 "+l(r.endTime),1)]),_:1}),a(o,{label:"任务名额"},{default:t(()=>[s(l(r.unlimitedQuota?"不限制":r.quota),1)]),_:1}),a(o,{label:"粉丝要求"},{default:t(()=>[s(l(r.fansRequired)+" 粉丝",1)]),_:1}),a(o,{label:"作品要求"},{default:t(()=>[s(l(r.contentRequirement),1)]),_:1}),a(o,{label:"任务信息"},{default:t(()=>[s(l(r.taskInfo),1)]),_:1})]),_:1})]),i("div",oe,[e[4]||(e[4]=i("div",{class:"section-title"},"会员信息",-1)),a(y,{column:2},{default:t(()=>[a(o,{label:"会员昵称"},{default:t(()=>[s(l(p.memberNickname),1)]),_:1}),a(o,{label:"账号"},{default:t(()=>[s(l(p.memberAccount),1)]),_:1}),a(o,{label:"所属群"},{default:t(()=>[(d(!0),f(x,null,N(p.groups,u=>(d(),f("div",null,[i("span",null,l(u.groupName),1),u.isGroupOwner?(d(),b(G,{key:0,color:"blue",style:{"margin-left":"10px"}},{default:t(()=>e[3]||(e[3]=[s("群主")])),_:1})):g("",!0)]))),256)),!p.groups||p.groups.length===0?(d(),f("span",ne,"--")):g("",!0)]),_:1})]),_:1})]),i("div",re,[e[5]||(e[5]=i("div",{class:"section-title"},"提交信息",-1)),a(y,{column:2},{default:t(()=>{var u;return[(d(!0),f(x,null,N((u=c==null?void 0:c.submitContent)==null?void 0:u.customFields,(w,J)=>(d(),b(o,{key:J,label:w.title},{default:t(()=>[w.type==="image"?(d(!0),f(x,{key:0},N(w.value,(K,W)=>(d(),b(H,{src:K.url,width:60,key:W},null,8,["src"]))),128)):(d(),f(x,{key:1},[s(l(w.value),1)],64))]),_:2},1032,["label"]))),128))]}),_:1})]),i("div",ie,[e[6]||(e[6]=i("div",{class:"section-title"},"审核信息",-1)),a(y,{column:2},{default:t(()=>[a(o,{label:"报名时间"},{default:t(()=>[s(l(c.applyTime),1)]),_:1}),a(o,{label:"提交时间"},{default:t(()=>[s(l(c.submitTime),1)]),_:1}),a(o,{label:"审核状态"},{default:t(()=>[s(l(B(I).getEnumText("TaskAuditStatus",c.taskAuditStatus)),1)]),_:1}),c.taskAuditStatus==="rejected"?(d(),b(o,{key:0,label:"拒绝原因"},{default:t(()=>[s(l(c.rejectReason),1)]),_:1})):g("",!0)]),_:1})]),i("div",de,[i("div",ue,[a(P,null,{default:t(()=>[c.taskAuditStatus==="pending"?(d(),b(j,{key:0,type:"primary",onClick:V},{default:t(()=>e[7]||(e[7]=[s(" 审核通过 ")])),_:1})):g("",!0),c.taskAuditStatus==="pending"?(d(),b(j,{key:1,danger:"",onClick:q},{default:t(()=>e[8]||(e[8]=[s(" 审核拒绝 ")])),_:1})):g("",!0)]),_:1})]),i("div",ce,[a(P,null,{default:t(()=>[a(j,{onClick:E},{default:t(()=>e[9]||(e[9]=[s("上一个")])),_:1}),a(j,{onClick:L},{default:t(()=>e[10]||(e[10]=[s("下一个")])),_:1})]),_:1})])])]),a(z,{open:v.value,"onUpdate:open":e[1]||(e[1]=u=>v.value=u),title:"拒绝原因",onOk:D,confirmLoading:A.value},{default:t(()=>[a(Q,{value:k.value,"onUpdate:value":e[0]||(e[0]=u=>k.value=u),placeholder:"请输入拒绝原因",rows:4},null,8,["value"])]),_:1},8,["open","confirmLoading"])])}}},be=X(me,[["__scopeId","data-v-598a6c3c"]]);export{be as default};

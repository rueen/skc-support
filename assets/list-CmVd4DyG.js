import{_ as X,a as Y,b as Z,r as S,c as U,x as ee,j as te,k as ae,d as u,e as l,f as a,w as t,g as c,l as V,m as v,h as ne,o,F as g,n as I,p as y,i as h,t as n,s as b,q as oe,v as se}from"./index-o2NTrzZ2.js";import{_ as le}from"./CopyContent-BiBNAReb.js";import{G as re}from"./GroupOwner-Y2cysy_X.js";const ie={class:"member-list content-container"},ce={class:"table-container"},ue={class:"table-header"},me={class:"left"},de={class:"right"},pe={key:0,style:{display:"inline-block"}},_e={class:"link-text-container"},he={class:"label"},be=["href"],fe={key:0},ge=["onClick"],ke=["onClick"],ve={class:"danger"},ye={__name:"list",setup($e){const B=Y(),{t:d}=Z(),$=ne(),D=ee(),w=S(!1),p=U({memberNickname:"",groupId:D.query.groupId}),z=S([]),_=U({current:1,pageSize:10,total:0}),T=S([]),E=te(()=>[{title:d("member.list.memberNickname"),dataIndex:"nickname",key:"nickname"},{title:d("member.list.memberAccount"),dataIndex:"account",key:"account"},{title:d("member.list.accounts"),key:"accountList"},{title:d("member.list.inviter"),key:"inviterNickname"},{title:d("member.list.group"),key:"groups"},{title:d("member.list.updateTime"),dataIndex:"updateTime",key:"updateTime",width:180},{title:d("member.list.action"),key:"action",fixed:"right",width:150}]),A=()=>{_.current=1,k()},L=()=>{Object.assign(p,{memberNickname:"",groupId:void 0}),A()},F=e=>{_.current=e.current,_.pageSize=e.pageSize,k()},G=()=>{$.push("/member/create")},P=e=>{$.push(`/member/edit/${e.id}`)},R=e=>{$.push(`/member/view/${e.id}`)},j=async e=>{const r=await se("member.delete",{},{urlParams:{id:e.id}});r.code===0?(v.success("删除成功"),k()):v.error(r.message)},k=async()=>{w.value=!0;try{const e=await V("member.list",{page:_.current,pageSize:_.pageSize,...p});e.code===0?(z.value=e.data.list,_.total=e.data.total):v.error(e.message)}finally{w.value=!1}},O=async(e="")=>{try{const r=await V("group.list",{page:1,pageSize:50,groupName:e});r.code===0&&(T.value=r.data.list||[])}catch{v.error("获取群组列表失败")}};return ae(()=>{k(),O()}),(e,r)=>{const q=c("a-input"),N=c("a-form-item"),x=c("a-select-option"),M=c("a-select"),C=c("a-button"),f=c("a-space"),H=c("a-form"),J=c("plus-outlined"),K=c("a-tag"),Q=c("a-popconfirm"),W=c("a-table");return o(),u("div",ie,[l("div",ce,[l("div",ue,[l("div",me,[a(H,{layout:"inline",model:p},{default:t(()=>[a(N,{label:e.$t("member.search.memberNickname")},{default:t(()=>[a(q,{value:p.memberNickname,"onUpdate:value":r[0]||(r[0]=s=>p.memberNickname=s),placeholder:e.$t("member.search.memberNicknamePlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),a(N,{label:e.$t("member.search.group")},{default:t(()=>[a(M,{value:p.groupId,"onUpdate:value":r[1]||(r[1]=s=>p.groupId=s),placeholder:e.$t("member.search.groupPlaceholder"),"allow-clear":"","show-search":"","filter-option":!1,onSearch:O,style:{width:"200px"}},{default:t(()=>[(o(!0),u(g,null,I(T.value,s=>(o(),y(x,{key:s.id,value:s.id},{default:t(()=>[h(n(s.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),a(N,null,{default:t(()=>[a(f,null,{default:t(()=>[a(C,{type:"primary",onClick:A},{default:t(()=>[h(n(e.$t("common.search")),1)]),_:1}),a(C,{onClick:L},{default:t(()=>[h(n(e.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),l("div",de,[a(f,null,{default:t(()=>[a(C,{type:"primary",onClick:G},{icon:t(()=>[a(J)]),default:t(()=>[h(" "+n(e.$t("member.list.add")),1)]),_:1})]),_:1})])]),a(W,{columns:E.value,"data-source":z.value,loading:w.value,pagination:_,onChange:F},{bodyCell:t(({column:s,record:m})=>[s.key==="accountList"?(o(),u("div",pe,[(o(!0),u(g,null,I(m.accountList,i=>(o(),u("div",null,[l("div",null,[a(f,null,{default:t(()=>[h(n(e.$t("member.list.account"))+"："+n(i.account)+" ",1),a(K,{color:"warning"},{default:t(()=>[h(n(oe(B).getEnumText("AccountAuditStatus",i.accountAuditStatus)),1)]),_:2},1024)]),_:2},1024)]),l("div",_e,[l("span",he,n(e.$t("member.list.homepage"))+"：",1),a(le,{content:i.homeUrl},{default:t(()=>[l("a",{href:i.homeUrl,target:"_blank",class:"link-text"},n(i.homeUrl),9,be)]),_:2},1032,["content"])])]))),256))])):b("",!0),s.key==="inviterNickname"?(o(),u(g,{key:1},[h(n(m.inviterNickname||"--"),1)],64)):b("",!0),s.key==="groups"?(o(),u(g,{key:2},[(o(!0),u(g,null,I(m.groups,i=>(o(),y(f,null,{default:t(()=>[l("span",null,n(i.groupName),1),i.isOwner?(o(),y(re,{key:0})):b("",!0)]),_:2},1024))),256)),!m.groups||m.groups.length===0?(o(),u("span",fe,"--")):b("",!0)],64)):b("",!0),s.key==="action"?(o(),y(f,{key:3},{default:t(()=>[l("a",{onClick:i=>P(m)},n(e.$t("member.list.edit")),9,ge),l("a",{onClick:i=>R(m)},n(e.$t("member.list.view")),9,ke),a(Q,{title:e.$t("member.list.deleteConfirm"),onConfirm:i=>j(m)},{default:t(()=>[l("a",ve,n(e.$t("member.list.delete")),1)]),_:2},1032,["title","onConfirm"])]),_:2},1024)):b("",!0)]),_:1},8,["columns","data-source","loading","pagination"])])])}}},Se=X(ye,[["__scopeId","data-v-f87c4470"]]);export{Se as default};

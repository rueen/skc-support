import{c as a,I as se,_ as ie,l as ue,r as y,a as B,n as ce,b,d as s,w as t,e as i,p as D,j as f,f as de,o as c,F as I,q as V,s as A,h as _,t as w,g as P,P as pe,v as S,x as me}from"./index-xdmi2-2f.js";var fe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 310H732.4c13.6-21.4 21.6-46.8 21.6-74 0-76.1-61.9-138-138-138-41.4 0-78.7 18.4-104 47.4-25.3-29-62.6-47.4-104-47.4-76.1 0-138 61.9-138 138 0 27.2 7.9 52.6 21.6 74H144c-17.7 0-32 14.3-32 32v200c0 4.4 3.6 8 8 8h40v344c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V550h40c4.4 0 8-3.6 8-8V342c0-17.7-14.3-32-32-32zm-334-74c0-38.6 31.4-70 70-70s70 31.4 70 70-31.4 70-70 70h-70v-70zm-138-70c38.6 0 70 31.4 70 70v70h-70c-38.6 0-70-31.4-70-70s31.4-70 70-70zM180 482V378h298v104H180zm48 68h250v308H228V550zm568 308H546V550h250v308zm48-376H546V378h298v104z"}}]},name:"gift",theme:"outlined"};function E(d){for(var r=1;r<arguments.length;r++){var l=arguments[r]!=null?Object(arguments[r]):{},p=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(p=p.concat(Object.getOwnPropertySymbols(l).filter(function(m){return Object.getOwnPropertyDescriptor(l,m).enumerable}))),p.forEach(function(m){_e(d,m,l[m])})}return d}function _e(d,r,l){return r in d?Object.defineProperty(d,r,{value:l,enumerable:!0,configurable:!0,writable:!0}):d[r]=l,d}var $=function(r,l){var p=E({},r,l.attrs);return a(se,E({},p,{icon:fe}),null)};$.displayName="GiftOutlined";$.inheritAttrs=!1;const ve={class:"member-list content-container"},ge={class:"table-container"},be={class:"table-header"},ye={class:"left"},he={class:"right"},ke={key:0,style:{display:"inline-block"}},we={class:"link-text-container"},Ce=["href"],xe=["onClick"],Oe=["onClick"],Se={__name:"list",setup(d){const r=ue(),l=de(),p=y(!1),m=y(!1),z=y(!1),N=y(10),v=B({memberNickname:"",groupId:void 0}),L=y([]),g=B({current:1,pageSize:10,total:0}),U=y([]),R=[{title:"会员昵称",dataIndex:"memberNickname",key:"memberNickname"},{title:"账号",dataIndex:"memberAccount",key:"memberAccount"},{title:"渠道账号信息",key:"accountList"},{title:"所属群组",dataIndex:"groups",key:"groups"},{title:"更新时间",dataIndex:"updateTime",key:"updateTime",width:180},{title:"操作",key:"action",fixed:"right",width:200}],j=()=>{g.current=1,C()},F=()=>{Object.assign(v,{memberNickname:"",groupId:void 0}),j()},M=n=>{g.current=n.current,g.pageSize=n.pageSize,C()},q=()=>{l.push("/member/create")},J=n=>{l.push(`/member/edit/${n.id}`)},Q=n=>{l.push(`/member/view/${n.id}`)},W=async n=>{const e=await me("member.delete",{},{urlParams:{id:n.id}});e.code===0?(f.success("删除成功"),C()):f.error(e.message)},X=async()=>{m.value=!0,await Z()},Y=async()=>{try{z.value=!0,f.success("保存成功"),m.value=!1}catch{f.error("保存失败")}finally{z.value=!1}},Z=async()=>{try{N.value=10}catch{f.error("获取配置失败")}},C=async()=>{p.value=!0;try{const n=await D("member.list",{page:g.current,pageSize:g.pageSize,...v});n.code===0?(L.value=n.data.list,g.total=n.data.total):f.error(n.message)}finally{p.value=!1}},G=async(n="")=>{try{const e=await D("group.list",{page:1,pageSize:50,groupName:n});e.code===0&&(U.value=e.data.list||[])}catch{f.error("获取群组列表失败")}},K=n=>{navigator.clipboard.writeText(n).then(()=>{f.success("链接已复制到剪贴板")}).catch(()=>{f.error("复制失败，请手动复制")})};return ce(()=>{C(),G()}),(n,e)=>{const ee=i("a-input"),x=i("a-form-item"),te=i("a-select-option"),ae=i("a-select"),h=i("a-button"),O=i("a-space"),H=i("a-form"),T=i("a-tag"),ne=i("a-popconfirm"),oe=i("a-table"),le=i("a-input-number"),re=i("a-modal");return c(),b("div",ve,[s("div",ge,[s("div",be,[s("div",ye,[a(H,{layout:"inline",model:v},{default:t(()=>[a(x,{label:"会员昵称"},{default:t(()=>[a(ee,{value:v.memberNickname,"onUpdate:value":e[0]||(e[0]=o=>v.memberNickname=o),placeholder:"请输入会员昵称","allow-clear":""},null,8,["value"])]),_:1}),a(x,{label:"所属群组"},{default:t(()=>[a(ae,{value:v.groupId,"onUpdate:value":e[1]||(e[1]=o=>v.groupId=o),placeholder:"请选择群组","allow-clear":"","show-search":"","filter-option":!1,onSearch:G,style:{width:"200px"}},{default:t(()=>[(c(!0),b(I,null,V(U.value,o=>(c(),A(te,{key:o.id,value:o.id},{default:t(()=>[_(w(o.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),a(x,null,{default:t(()=>[a(O,null,{default:t(()=>[a(h,{type:"primary",onClick:j},{default:t(()=>e[4]||(e[4]=[_("查询")])),_:1}),a(h,{onClick:F},{default:t(()=>e[5]||(e[5]=[_("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),s("div",he,[a(O,null,{default:t(()=>[a(h,{onClick:X},{icon:t(()=>[a(P($))]),default:t(()=>[e[6]||(e[6]=_(" 邀请有礼 "))]),_:1}),a(h,{type:"primary",onClick:q},{icon:t(()=>[a(P(pe))]),default:t(()=>[e[7]||(e[7]=_(" 新增会员 "))]),_:1})]),_:1})])]),a(oe,{columns:R,"data-source":L.value,loading:p.value,pagination:g,onChange:M},{bodyCell:t(({column:o,record:k})=>[o.key==="accountList"?(c(),b("div",ke,[(c(!0),b(I,null,V(k.accountList,u=>(c(),b("div",null,[s("div",null,[a(O,null,{default:t(()=>[_(" 账号："+w(u.account)+" ",1),a(T,{color:"warning"},{default:t(()=>[_(w(P(r).getEnumText("AccountAuditStatus",u.accountAuditStatus)),1)]),_:2},1024)]),_:2},1024)]),s("div",we,[e[9]||(e[9]=s("span",{class:"label"},"主页：",-1)),s("a",{href:u.homeUrl,target:"_blank",class:"link-text"},w(u.homeUrl),9,Ce),a(h,{type:"link",size:"small",onClick:ze=>K(u.homeUrl)},{default:t(()=>e[8]||(e[8]=[_(" 复制 ")])),_:2},1032,["onClick"])])]))),256))])):S("",!0),o.key==="groups"?(c(!0),b(I,{key:1},V(k.groups,u=>(c(),b("div",null,[s("span",null,w(u.groupName),1),u.isGroupOwner?(c(),A(T,{key:0,color:"blue",style:{"margin-left":"10px"}},{default:t(()=>e[10]||(e[10]=[_("群主")])),_:1})):S("",!0)]))),256)):S("",!0),o.key==="action"?(c(),A(O,{key:2},{default:t(()=>[s("a",{onClick:u=>J(k)},"编辑",8,xe),s("a",{onClick:u=>Q(k)},"查看",8,Oe),a(ne,{title:"确定要删除吗？",onConfirm:u=>W(k)},{default:t(()=>e[11]||(e[11]=[s("a",{class:"danger"},"删除",-1)])),_:2},1032,["onConfirm"])]),_:2},1024)):S("",!0)]),_:1},8,["data-source","loading","pagination"])]),a(re,{open:m.value,"onUpdate:open":e[3]||(e[3]=o=>m.value=o),title:"邀请有礼配置",onOk:Y,confirmLoading:z.value},{default:t(()=>[a(H,{"label-col":{span:6},"wrapper-col":{span:16}},{default:t(()=>[a(x,{label:"奖励金额",extra:"设置每成功邀请一位新会员的奖励金额"},{default:t(()=>[a(le,{value:N.value,"onUpdate:value":e[2]||(e[2]=o=>N.value=o),min:0,precision:2,step:1,formatter:o=>`¥ ${o}`,parser:o=>o.replace("¥ ",""),style:{width:"100%"}},null,8,["value","formatter","parser"])]),_:1})]),_:1})]),_:1},8,["open","confirmLoading"])])}}},Ie=ie(Se,[["__scopeId","data-v-8dc6a374"]]);export{Ie as default};

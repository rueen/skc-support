import{_ as $e,a as Se,b as je,j as ee,r as h,c as D,k as Re,d as f,e as d,f as n,w as l,g as p,l as z,m as y,h as Ae,o as s,F as k,n as E,p as g,i as m,t as u,s as r,q as Ue,A as te,M as ae,z as Ie}from"./index-QyF0JL28.js";import{_ as ne}from"./CopyContent-BbvB_JPC.js";import{G as Oe}from"./GroupOwner-D4a-IMLW.js";const Ne={class:"account content-container"},Fe={class:"table-container"},ze={class:"table-header"},Ee={class:"left"},Pe={class:"right"},Le={style:{"text-align":"left","margin-bottom":"16px"}},Be={key:0,class:"account-info"},Ve={class:"link-text-container"},De={class:"label"},Me={class:"stats"},Te={key:0,class:"stat-item"},Ge={key:1,class:"stat-item"},Ke={key:2,class:"stat-item"},qe={key:1},He={class:"danger"},Je={__name:"list",setup(Qe){const M=Ae(),P=Se(),{t:_}=je(),le=ee(()=>P.loaded?P.getEnumOptions("AccountAuditStatus"):[]),L=h(!1),C=h([]),j=h(!1),B=h(!1),w=h(""),c=D({keyword:"",channelId:void 0,accountAuditStatus:"pending",groupId:void 0,memberId:void 0}),T=h([]),G=h([]),K=h([]),R=h(null),oe=ee(()=>[{title:_("account.list.accountInfo"),key:"accountInfo",width:500},{title:_("account.list.member"),key:"member"},{title:_("account.list.auditStatus"),dataIndex:"accountAuditStatus",key:"accountAuditStatus"},{title:_("account.list.waiterName"),key:"waiterName"},{title:_("account.list.action"),key:"action"}]),se={selectedRowKeys:C,onChange:e=>{C.value=e},getCheckboxProps:e=>({disabled:e.accountAuditStatus!=="pending"})},q=h([]),$=D({current:1,pageSize:10,total:0}),H=()=>{$.current=1,S()},ue=()=>{c.keyword="",c.channelId=void 0,c.accountAuditStatus=void 0,c.groupId=void 0,c.memberId=void 0,H()},ce=e=>{M.push(`/member/view/${e.memberId}`)},I=h(!1),i=D({homeUrl:"",uid:"",account:"",fansCount:"",friendsCount:"",postsCount:""}),V=h(!1),ie=e=>{I.value=!0,R.value=e,Object.assign(i,{homeUrl:e.homeUrl,uid:e.uid,account:e.account,fansCount:e.fansCount,friendsCount:e.friendsCount,postsCount:e.postsCount})},de=async()=>{const e={};Object.keys(i).forEach(a=>{i[a]!=null&&(e[a]=i[a])}),V.value=!0;try{await Ie("account.edit",e,{urlParams:{id:R.value.id}}),y.success("success"),I.value=!1,S()}catch(a){console.log(a),y.error(a.message)}finally{V.value=!1}},re=e=>{ae.error({content:e.rejectReason})},pe=()=>{M.push("/account/old")},me=e=>{Object.assign($,{current:e.current,pageSize:e.pageSize}),S()},fe=async e=>{C.value=[e.id],J()},J=async()=>{if(!C.value.length){y.warning(_("account.list.message.selectAccount"));return}const e=await te("account.batchResolve",{ids:C.value});if(e.code===0){const a=e.data.failed.map(b=>b.reason).join(",");a?ae.error({title:_("account.list.batchRejectFailedTitle"),content:a}):(y.success(_("account.list.message.success")),C.value=[],S())}else y.error(e.message)},ve=async()=>{if(!C.value.length){y.warning(_("account.list.message.selectAccount"));return}w.value="",j.value=!0},he=e=>{C.value=[e.id],w.value="",j.value=!0},ge=async()=>{if(!w.value){y.error(_("account.list.message.rejectReason"));return}B.value=!0;try{const e=await te("account.batchReject",{ids:C.value,rejectReason:w.value});e.code===0?(y.success(_("account.list.message.success")),C.value=[],j.value=!1,S()):y.error(e.message)}catch(e){console.log(e)}finally{B.value=!1}},S=async()=>{L.value=!0;try{const e=await z("account.list",{page:$.current,pageSize:$.pageSize,...c});e.code===0?(q.value=e.data.list,$.total=e.data.total):y.error(e.message)}finally{L.value=!1}},_e=async()=>{const e=await z("channel.list");e.code===0&&(T.value=e.data.list)},Q=async(e="")=>{try{const a=await z("group.list",{page:1,pageSize:50,groupName:e});a.code===0&&(G.value=a.data.list||[])}catch{y.error("获取群组列表失败")}},W=async(e="")=>{const a=await z("member.list",{page:1,pageSize:50,memberNickname:e});a.code===0&&(K.value=a.data.list||[])};return Re(()=>{S(),Q(),_e(),W()}),(e,a)=>{const b=p("a-input"),v=p("a-form-item"),O=p("a-select-option"),N=p("a-select"),A=p("a-button"),U=p("a-space"),X=p("a-form"),ye=p("EditOutlined"),Ce=p("a-avatar"),Y=p("a-typography-link"),be=p("info-circle-outlined"),Z=p("a-popconfirm"),ke=p("a-table"),we=p("a-textarea"),x=p("a-modal");return s(),f("div",Ne,[d("div",Fe,[d("div",ze,[d("div",Ee,[n(X,{layout:"inline",model:c},{default:l(()=>[n(v,{label:e.$t("account.search.account")},{default:l(()=>[n(b,{value:c.keyword,"onUpdate:value":a[0]||(a[0]=t=>c.keyword=t),placeholder:e.$t("account.search.accountPlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),n(v,{label:e.$t("account.search.channel")},{default:l(()=>[n(N,{value:c.channelId,"onUpdate:value":a[1]||(a[1]=t=>c.channelId=t),placeholder:e.$t("account.search.channelPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:l(()=>[(s(!0),f(k,null,E(T.value,t=>(s(),g(O,{key:t.id,value:t.id},{default:l(()=>[m(u(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),n(v,{label:e.$t("account.search.auditStatus")},{default:l(()=>[n(N,{value:c.accountAuditStatus,"onUpdate:value":a[2]||(a[2]=t=>c.accountAuditStatus=t),placeholder:e.$t("account.search.auditStatusPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:l(()=>[(s(!0),f(k,null,E(le.value,t=>(s(),g(O,{key:t.value,value:t.value},{default:l(()=>[m(u(t.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),n(v,{label:e.$t("account.search.group")},{default:l(()=>[n(N,{value:c.groupId,"onUpdate:value":a[3]||(a[3]=t=>c.groupId=t),placeholder:e.$t("account.search.groupPlaceholder"),style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:Q},{default:l(()=>[(s(!0),f(k,null,E(G.value,t=>(s(),g(O,{key:t.id,value:t.id},{default:l(()=>[m(u(t.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),n(v,{label:e.$t("account.search.member")},{default:l(()=>[n(N,{value:c.memberId,"onUpdate:value":a[4]||(a[4]=t=>c.memberId=t),placeholder:e.$t("account.search.memberPlaceholder"),style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:W},{default:l(()=>[(s(!0),f(k,null,E(K.value,t=>(s(),g(O,{key:t.id,value:t.id},{default:l(()=>[m(u(t.nickname),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),n(v,null,{default:l(()=>[n(U,null,{default:l(()=>[n(A,{type:"primary",onClick:H},{default:l(()=>[m(u(e.$t("common.search")),1)]),_:1}),n(A,{onClick:ue},{default:l(()=>[m(u(e.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),d("div",Pe,[n(U,null,{default:l(()=>[n(A,{type:"primary",onClick:J},{default:l(()=>[m(u(e.$t("common.batchResolve")),1)]),_:1}),n(A,{danger:"",onClick:ve},{default:l(()=>[m(u(e.$t("common.batchReject")),1)]),_:1})]),_:1})])]),d("div",Le,[n(A,{onClick:pe},{default:l(()=>[m(u(e.$t("account.list.oldAccount")),1)]),_:1})]),n(ke,{columns:oe.value,"data-source":q.value,loading:L.value,pagination:$,"row-selection":se,rowKey:"id",onChange:me},{bodyCell:l(({column:t,record:o})=>[t.key==="accountInfo"?(s(),f("div",Be,[n(ye,{class:"edit-icon",onClick:F=>ie(o)},null,8,["onClick"]),n(U,null,{default:l(()=>[n(Ce,{src:o.channelIcon,size:"small"},null,8,["src"]),d("span",null,u(o.account),1)]),_:2},1024),d("div",null,[d("div",Ve,[d("span",De,u(e.$t("account.list.homepage"))+"：",1),n(ne,{content:o.homeUrl},{default:l(()=>[n(Y,null,{default:l(()=>[m(u(o.homeUrl),1)]),_:2},1024)]),_:2},1032,["content"])])]),d("div",null,[a[14]||(a[14]=d("span",{class:"label"},"uid：",-1)),n(ne,{content:o.uid},null,8,["content"])]),d("div",Me,[o.channelCustomFields.includes("fansCount")?(s(),f("div",Te,u(e.$t("account.list.fansCount"))+"："+u(o.fansCount),1)):r("",!0),o.channelCustomFields.includes("friendsCount")?(s(),f("div",Ge,u(e.$t("account.list.friendsCount"))+"："+u(o.friendsCount),1)):r("",!0),o.channelCustomFields.includes("postsCount")?(s(),f("div",Ke,u(e.$t("account.list.postsCount"))+"："+u(o.postsCount),1)):r("",!0)])])):r("",!0),t.key==="member"?(s(),f("div",qe,[d("div",null,[n(Y,{onClick:F=>ce(o)},{default:l(()=>[m(u(o.memberNickname),1)]),_:2},1032,["onClick"])]),n(U,{class:"group-name"},{default:l(()=>[d("span",null,u(o.groupName),1),o.isGroupOwner?(s(),g(Oe,{key:0})):r("",!0)]),_:2},1024)])):r("",!0),t.key==="accountAuditStatus"?(s(),f(k,{key:2},[m(u(Ue(P).getEnumText("AccountAuditStatus",o.accountAuditStatus))+" ",1),o.accountAuditStatus==="rejected"?(s(),g(be,{key:0,class:"danger",onClick:F=>re(o)},null,8,["onClick"])):r("",!0)],64)):r("",!0),t.key==="waiterName"?(s(),f(k,{key:3},[m(u(o.waiterName||"--"),1)],64)):r("",!0),t.key==="action"?(s(),g(U,{key:4},{default:l(()=>[o.accountAuditStatus==="pending"?(s(),g(Z,{key:0,title:e.$t("account.list.resolveConfirm"),onConfirm:F=>fe(o)},{default:l(()=>[d("a",null,u(e.$t("account.list.resolve")),1)]),_:2},1032,["title","onConfirm"])):r("",!0),o.accountAuditStatus==="pending"?(s(),g(Z,{key:1,title:e.$t("account.list.rejectConfirm"),onConfirm:F=>he(o)},{default:l(()=>[d("a",He,u(e.$t("account.list.reject")),1)]),_:2},1032,["title","onConfirm"])):r("",!0)]),_:2},1024)):r("",!0),t.key==="rejectReason"?(s(),f(k,{key:5},[m(u(o.rejectReason),1)],64)):r("",!0)]),_:1},8,["columns","data-source","loading","pagination"])]),n(x,{open:j.value,"onUpdate:open":a[6]||(a[6]=t=>j.value=t),title:e.$t("account.list.rejectReason"),onOk:ge,confirmLoading:B.value},{default:l(()=>[n(we,{value:w.value,"onUpdate:value":a[5]||(a[5]=t=>w.value=t),placeholder:e.$t("account.list.rejectReasonPlaceholder"),rows:4},null,8,["value","placeholder"])]),_:1},8,["open","title","confirmLoading"]),n(x,{open:I.value,"onUpdate:open":a[13]||(a[13]=t=>I.value=t),title:e.$t("account.list.editAccountTitle"),onOk:de,confirmLoading:V.value},{default:l(()=>[n(X,{ref:"formRef",model:i,"label-col":{span:6},"wrapper-col":{span:16}},{default:l(()=>[n(v,{label:e.$t("account.list.account"),name:"account"},{default:l(()=>[n(b,{value:i.account,"onUpdate:value":a[7]||(a[7]=t=>i.account=t)},null,8,["value"])]),_:1},8,["label"]),n(v,{label:e.$t("account.list.homepage"),name:"homeUrl"},{default:l(()=>[n(b,{value:i.homeUrl,"onUpdate:value":a[8]||(a[8]=t=>i.homeUrl=t)},null,8,["value"])]),_:1},8,["label"]),n(v,{label:"UID",name:"uid"},{default:l(()=>[n(b,{value:i.uid,"onUpdate:value":a[9]||(a[9]=t=>i.uid=t)},null,8,["value"])]),_:1}),R.value.channelCustomFields.includes("fansCount")?(s(),g(v,{key:0,label:e.$t("account.list.fansCount"),name:"fansCount"},{default:l(()=>[n(b,{value:i.fansCount,"onUpdate:value":a[10]||(a[10]=t=>i.fansCount=t)},null,8,["value"])]),_:1},8,["label"])):r("",!0),R.value.channelCustomFields.includes("friendsCount")?(s(),g(v,{key:1,label:e.$t("account.list.friendsCount"),name:"friendsCount"},{default:l(()=>[n(b,{value:i.friendsCount,"onUpdate:value":a[11]||(a[11]=t=>i.friendsCount=t)},null,8,["value"])]),_:1},8,["label"])):r("",!0),R.value.channelCustomFields.includes("postsCount")?(s(),g(v,{key:2,label:e.$t("account.list.postsCount"),name:"postsCount"},{default:l(()=>[n(b,{value:i.postsCount,"onUpdate:value":a[12]||(a[12]=t=>i.postsCount=t)},null,8,["value"])]),_:1},8,["label"])):r("",!0)]),_:1},8,["model"])]),_:1},8,["open","title","confirmLoading"])])}}},Ze=$e(Je,[["__scopeId","data-v-68c2f153"]]);export{Ze as default};

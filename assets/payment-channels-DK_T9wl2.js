import{_ as j,a as z,r as i,b as S,j as g,k as F,c as G,d as m,e as l,w as o,f as c,l as H,o as $,h as J,t as _,p as Q,s as W,v as X,m as d,z as Y,A as Z}from"./index-NSnZF2AZ.js";const x={class:"channel content-container"},ee={class:"table-container"},ae={class:"table-header"},ne={class:"right"},le=["onClick"],te={class:"danger"},se={__name:"payment-channels",setup(oe){const{t:s}=z(),y=i(!1),r=i(!1),v=i(!1),u=i("add"),b=i(),a=S({name:"",bank:"",merchantId:"",secretKey:""}),C=i(),N={name:[{required:!0,message:s("financial.paymentChannels.channelNamePlaceholder")}],bank:[{required:!0,message:s("financial.paymentChannels.bankNamePlaceholder")}],merchantId:[{required:!0,message:s("financial.paymentChannels.merchantIdPlaceholder")}]},w=g(()=>[{title:s("financial.paymentChannels.channelName"),dataIndex:"name",key:"name"},{title:s("financial.paymentChannels.bankName"),dataIndex:"bank",key:"bank"},{title:s("financial.paymentChannels.merchantId"),dataIndex:"merchantId",key:"merchantId"},{title:s("financial.paymentChannels.updateTime"),dataIndex:"updateTime",key:"updateTime"},{title:s("financial.paymentChannels.action"),key:"action",width:200}]),k=i([]),K=g(()=>({add:s("financial.paymentChannels.addTitle"),edit:s("financial.paymentChannels.editTitle")})[u.value]),P=()=>{u.value="add",a.name="",a.bank="",a.merchantId="",a.secretKey="",r.value=!0},T=e=>{u.value="edit",C.value=e.id,a.name=e.name,a.bank=e.bank,a.merchantId=e.merchantId,a.secretKey=null,r.value=!0},D=async e=>{try{const n=await X("paymentChannels.delete",{},{urlParams:{id:e.id}});n.code===0?(d.success("删除成功"),p()):d.error(n.message)}catch{d.error("删除失败")}},U=async()=>{if(!a.secretKey){d.error("请输入密钥");return}const e=await Z("paymentChannels.add",a);e.code===0?(d.success("添加成功"),r.value=!1,p()):d.error(e.message)},V=async()=>{const e=await Y("paymentChannels.edit",{...a,id:C.value},{urlParams:{id:C.value}});e.code===0?(d.success("编辑成功"),r.value=!1,p()):d.error(e.message)},B=async()=>{try{switch(await b.value.validate(),v.value=!0,u.value){case"add":U();break;case"edit":V();break}}catch(e){console.error(e)}finally{v.value=!1}},p=async()=>{y.value=!0;try{const e=await H("paymentChannels.list");k.value=e.data}finally{y.value=!1}};return F(()=>{p()}),(e,n)=>{const q=c("a-button"),L=c("a-popconfirm"),A=c("a-space"),E=c("a-table"),f=c("a-input"),h=c("a-form-item"),M=c("a-form"),O=c("a-modal");return $(),G("div",x,[m("div",ee,[m("div",ae,[n[5]||(n[5]=m("div",{class:"left"},null,-1)),m("div",ne,[l(q,{type:"primary",onClick:P},{default:o(()=>[J(_(e.$t("financial.paymentChannels.add")),1)]),_:1})])]),l(E,{columns:w.value,"data-source":k.value,loading:y.value,pagination:!1},{bodyCell:o(({column:t,record:I})=>[t.key==="action"?($(),Q(A,{key:0},{default:o(()=>[m("a",{onClick:R=>T(I)},_(e.$t("financial.paymentChannels.edit")),9,le),l(L,{title:e.$t("financial.paymentChannels.deleteConfirm"),onConfirm:R=>D(I)},{default:o(()=>[m("a",te,_(e.$t("financial.paymentChannels.delete")),1)]),_:2},1032,["title","onConfirm"])]),_:2},1024)):W("",!0)]),_:1},8,["columns","data-source","loading"])]),l(O,{open:r.value,"onUpdate:open":n[4]||(n[4]=t=>r.value=t),title:K.value,confirmLoading:v.value,onOk:B},{default:o(()=>[l(M,{ref_key:"formRef",ref:b,model:a,rules:N,"label-col":{span:6},"wrapper-col":{span:16}},{default:o(()=>[l(h,{label:e.$t("financial.paymentChannels.channelName"),name:"name"},{default:o(()=>[l(f,{value:a.name,"onUpdate:value":n[0]||(n[0]=t=>a.name=t),placeholder:e.$t("financial.paymentChannels.channelNamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),l(h,{label:e.$t("financial.paymentChannels.bankName"),name:"bank"},{default:o(()=>[l(f,{value:a.bank,"onUpdate:value":n[1]||(n[1]=t=>a.bank=t),placeholder:e.$t("financial.paymentChannels.bankNamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),l(h,{label:e.$t("financial.paymentChannels.merchantId"),name:"merchantId"},{default:o(()=>[l(f,{value:a.merchantId,"onUpdate:value":n[2]||(n[2]=t=>a.merchantId=t),placeholder:e.$t("financial.paymentChannels.merchantIdPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),l(h,{label:e.$t("financial.paymentChannels.secretKey"),name:"secretKey"},{default:o(()=>[l(f,{value:a.secretKey,"onUpdate:value":n[3]||(n[3]=t=>a.secretKey=t),placeholder:e.$t("financial.paymentChannels.secretKeyPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["open","title","confirmLoading"])])}}},de=j(se,[["__scopeId","data-v-99fef7e6"]]);export{de as default};

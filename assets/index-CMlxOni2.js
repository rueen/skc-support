import{P as T}from"./PageHeader-vix8vybD.js";import{_ as M,r as _,c as S,k as q,d as G,f as r,w as t,g as m,l as N,m as w,o as c,e as u,t as n,p as b,s as h,i as y,A as O}from"./index-CUoBUQge.js";const U={class:"system-config-container"},V={class:"form-item-desc"},E={class:"form-item-desc"},j={class:"form-item-desc"},H={class:"form-item-desc"},I={__name:"index",setup(z){const C=_(null),g=_(!1),p=_(!1),s=_(!0),o=S({max_group_members:null,group_owner_commission_rate:null,invite_reward_amount:null}),$={max_group_members:[{required:!0,message:"请输入最大群成员数",trigger:"blur"},{type:"number",min:10,max:1e3,message:"群成员数必须在 10-1000 之间",trigger:"blur"}],group_owner_commission_rate:[{required:!0,message:"请输入群主收益率",trigger:"blur"},{type:"number",min:0,max:100,message:"收益率必须在 0-100 之间",trigger:"blur"}],invite_reward_amount:[{required:!0,message:"请输入邀请奖励金额",trigger:"blur"},{type:"number",min:0,max:1e3,message:"奖励金额必须在 0-1000 之间",trigger:"blur"}],withdrawal_threshold:[{required:!0,message:"请输入提现门槛",trigger:"blur"},{type:"number",min:0,max:99999,message:"提现门槛必须在 0-99999 之间",trigger:"blur"}]},f=async()=>{g.value=!0;try{const e=await N("system.getAllConfig");if(e&&e.data){const a={};e.data.forEach(l=>{a[l.config_key]=l}),Object.assign(o,{max_group_members:a.max_group_members.config_value,group_owner_commission_rate:(a.group_owner_commission_rate.config_value-0)*100,invite_reward_amount:a.invite_reward_amount.config_value,withdrawal_threshold:a.withdrawal_threshold.config_value})}}catch(e){w.error("获取系统配置失败："+(e.message||"未知错误"))}finally{g.value=!1}},k=async()=>{p.value=!0;const e={max_group_members:o.max_group_members,group_owner_commission_rate:o.group_owner_commission_rate/100,invite_reward_amount:o.invite_reward_amount,withdrawal_threshold:o.withdrawal_threshold},a=await O("system.saveAllConfig",{configs:e});p.value=!1,a&&a.code===0?(w.success("保存系统配置成功"),f(),s.value=!0):w.error(a.message||"保存失败")},x=()=>{C.value.validate().then(()=>{k()}).catch(e=>{console.error("表单验证失败",e)})},R=()=>{s.value=!1},P=()=>{f()};return q(()=>{f()}),(e,a)=>{const l=m("a-input-number"),d=m("a-form-item"),v=m("a-button"),A=m("a-space"),D=m("a-form"),B=m("a-spin");return c(),G("div",U,[r(T,{title:e.$t("systemConfig.pageTitle"),back:!0},null,8,["title"]),r(B,{spinning:g.value},{default:t(()=>[r(D,{model:o,rules:$,ref_key:"formRef",ref:C,"label-col":{span:6},"wrapper-col":{span:12}},{default:t(()=>[r(d,{label:e.$t("systemConfig.maxGroupMembers"),name:"maxGroupMembers"},{default:t(()=>[r(l,{value:o.max_group_members,"onUpdate:value":a[0]||(a[0]=i=>o.max_group_members=i),min:1,max:3e3,placeholder:"请输入最大群成员数",disabled:s.value},null,8,["value","disabled"]),u("div",V,[u("div",null,n(e.$t("systemConfig.maxGroupMembersDesc1")),1),u("div",null,n(e.$t("systemConfig.maxGroupMembersDesc2")),1)])]),_:1},8,["label"]),r(d,{label:e.$t("systemConfig.groupOwnerProfitRate"),name:"ownerProfitRate"},{default:t(()=>[r(l,{value:o.group_owner_commission_rate,"onUpdate:value":a[1]||(a[1]=i=>o.group_owner_commission_rate=i),min:0,max:100,step:.1,precision:1,addonAfter:"%",placeholder:e.$t("systemConfig.groupOwnerProfitRatePlaceholder"),disabled:s.value},null,8,["value","placeholder","disabled"]),u("div",E,n(e.$t("systemConfig.groupOwnerProfitRateDesc")),1)]),_:1},8,["label"]),r(d,{label:e.$t("systemConfig.inviteRewardAmount"),name:"inviteRewardAmount"},{default:t(()=>[r(l,{value:o.invite_reward_amount,"onUpdate:value":a[2]||(a[2]=i=>o.invite_reward_amount=i),min:0,max:1e3,step:.1,precision:1,addonBefore:"¥",placeholder:e.$t("systemConfig.inviteRewardAmountPlaceholder"),disabled:s.value},null,8,["value","placeholder","disabled"]),u("div",j,n(e.$t("systemConfig.inviteRewardAmountDesc")),1)]),_:1},8,["label"]),r(d,{label:e.$t("systemConfig.withdrawalThreshold"),name:"withdrawalThreshold"},{default:t(()=>[r(l,{value:o.withdrawal_threshold,"onUpdate:value":a[3]||(a[3]=i=>o.withdrawal_threshold=i),min:0,max:99999,step:1,addonBefore:"¥",placeholder:e.$t("systemConfig.withdrawalThresholdPlaceholder"),disabled:s.value},null,8,["value","placeholder","disabled"]),u("div",H,n(e.$t("systemConfig.withdrawalThresholdDesc")),1)]),_:1},8,["label"]),r(d,{"wrapper-col":{span:12,offset:6}},{default:t(()=>[r(A,null,{default:t(()=>[s.value?h("",!0):(c(),b(v,{key:0,type:"primary",onClick:x,loading:p.value},{default:t(()=>[y(n(e.$t("common.save")),1)]),_:1},8,["loading"])),s.value?(c(),b(v,{key:1,onClick:R},{default:t(()=>[y(n(e.$t("common.edit")),1)]),_:1})):h("",!0),s.value?h("",!0):(c(),b(v,{key:2,onClick:P},{default:t(()=>[y(n(e.$t("common.reset")),1)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},K=M(I,[["__scopeId","data-v-a73c2dde"]]);export{K as default};

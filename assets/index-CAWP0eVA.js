import{P as S}from"./index-CQ0Taxam.js";import{_ as U,r as d,a as V,k as E,b as P,c as a,w as o,e as i,l as j,m as v,o as _,d as m,p as b,q as w,h as x,z as M}from"./index-C_f3BNdC.js";const T={class:"system-config-container"},z={__name:"index",setup(D){const y=d(null),p=d(!1),f=d(!1),s=d(!0),t=V({max_group_members:null,group_owner_commission_rate:null,invite_reward_amount:null}),k={max_group_members:[{required:!0,message:"请输入最大群成员数",trigger:"blur"},{type:"number",min:10,max:1e3,message:"群成员数必须在 10-1000 之间",trigger:"blur"}],group_owner_commission_rate:[{required:!0,message:"请输入群主收益率",trigger:"blur"},{type:"number",min:0,max:100,message:"收益率必须在 0-100 之间",trigger:"blur"}],invite_reward_amount:[{required:!0,message:"请输入邀请奖励金额",trigger:"blur"},{type:"number",min:0,max:1e3,message:"奖励金额必须在 0-1000 之间",trigger:"blur"}],withdrawal_threshold:[{required:!0,message:"请输入提现门槛",trigger:"blur"},{type:"number",min:0,max:99999,message:"提现门槛必须在 0-99999 之间",trigger:"blur"}]},g=async()=>{p.value=!0;try{const r=await j("system.getAllConfig");if(r&&r.data){const e={};r.data.forEach(n=>{e[n.config_key]=n}),Object.assign(t,{max_group_members:e.max_group_members.config_value,group_owner_commission_rate:e.group_owner_commission_rate.config_value,invite_reward_amount:e.invite_reward_amount.config_value,withdrawal_threshold:e.withdrawal_threshold.config_value})}}catch(r){v.error("获取系统配置失败："+(r.message||"未知错误"))}finally{p.value=!1}},h=async()=>{f.value=!0;const r=await M("system.saveAllConfig",{configs:t});f.value=!1,r&&r.code===0?(v.success("保存系统配置成功"),g(),s.value=!0):v.error(r.message||"保存失败")},C=()=>{y.value.validate().then(()=>{h()}).catch(r=>{console.error("表单验证失败",r)})},B=()=>{s.value=!1},q=()=>{g()};return E(()=>{g()}),(r,e)=>{const n=i("a-input-number"),u=i("a-form-item"),c=i("a-button"),R=i("a-space"),A=i("a-form"),N=i("a-spin");return _(),P("div",T,[a(S,{title:"系统配置",back:!0}),a(N,{spinning:p.value},{default:o(()=>[a(A,{model:t,rules:k,ref_key:"formRef",ref:y,"label-col":{span:6},"wrapper-col":{span:12}},{default:o(()=>[a(u,{label:"最大群成员数",name:"maxGroupMembers"},{default:o(()=>[a(n,{value:t.max_group_members,"onUpdate:value":e[0]||(e[0]=l=>t.max_group_members=l),min:1,max:1e3,placeholder:"请输入最大群成员数",disabled:s.value},null,8,["value","disabled"]),e[4]||(e[4]=m("div",{class:"form-item-desc"},[m("div",null,"设置单个群组可容纳的最大成员数量"),m("div",null,"群成员数量限制的配置修改后会立即生效，但不会对已有的超出新限制的群组产生影响")],-1))]),_:1}),a(u,{label:"群主收益率",name:"ownerProfitRate"},{default:o(()=>[a(n,{value:t.group_owner_commission_rate,"onUpdate:value":e[1]||(e[1]=l=>t.group_owner_commission_rate=l),min:0,max:100,step:.1,precision:1,addonAfter:"%",placeholder:"请输入群主收益率",disabled:s.value},null,8,["value","disabled"]),e[5]||(e[5]=m("div",{class:"form-item-desc"},"设置群主可获得的任务收益分成比例",-1))]),_:1}),a(u,{label:"邀请奖励金额",name:"inviteRewardAmount"},{default:o(()=>[a(n,{value:t.invite_reward_amount,"onUpdate:value":e[2]||(e[2]=l=>t.invite_reward_amount=l),min:0,max:1e3,step:.1,precision:1,addonBefore:"¥",placeholder:"请输入邀请奖励金额",disabled:s.value},null,8,["value","disabled"]),e[6]||(e[6]=m("div",{class:"form-item-desc"},"设置每成功邀请一位新会员的奖励金额",-1))]),_:1}),a(u,{label:"提现门槛",name:"withdrawalThreshold"},{default:o(()=>[a(n,{value:t.withdrawal_threshold,"onUpdate:value":e[3]||(e[3]=l=>t.withdrawal_threshold=l),min:0,max:99999,step:1,addonBefore:"¥",placeholder:"请输入提现门槛",disabled:s.value},null,8,["value","disabled"]),e[7]||(e[7]=m("div",{class:"form-item-desc"},"设置用户提现的最低门槛",-1))]),_:1}),a(u,{"wrapper-col":{span:12,offset:6}},{default:o(()=>[a(R,null,{default:o(()=>[s.value?w("",!0):(_(),b(c,{key:0,type:"primary",onClick:C,loading:f.value},{default:o(()=>e[8]||(e[8]=[x("保存配置")])),_:1},8,["loading"])),s.value?(_(),b(c,{key:1,onClick:B},{default:o(()=>e[9]||(e[9]=[x("编辑配置")])),_:1})):w("",!0),s.value?w("",!0):(_(),b(c,{key:2,onClick:q},{default:o(()=>e[10]||(e[10]=[x("重置")])),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},I=U(z,[["__scopeId","data-v-d12500bc"]]);export{I as default};

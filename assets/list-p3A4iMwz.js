import{_ as we,a as Ce,b as $e,j as W,r as g,c as J,k as Se,d as m,e as i,f as l,w as n,g as r,l as T,m as h,h as Ie,o as c,F as b,n as N,p as y,i as p,t as o,s as v,q as Re,A as Q,M as X,v as Ae}from"./index-C2eEvsUt.js";import{_ as Z}from"./CopyContent-Bzk6Zk3q.js";import{G as je}from"./GroupOwner-Bis9Mlqs.js";const Oe={class:"account content-container"},Te={class:"table-container"},Ne={class:"table-header"},Ue={style:{width:"100%",display:"flex","justify-content":"space-between"}},ze={class:"right"},De={key:0,class:"account-info"},Me={class:"link-text-container"},Pe={class:"label"},Ye=["href"],Ee={class:"stats"},Fe={key:0,class:"stat-item"},Be={key:1,class:"stat-item"},He={key:2,class:"stat-item"},Ve={key:1},Ge={class:"danger"},Le=["onClick"],Ke={class:"danger"},qe={__name:"list",setup(We){const U=Ie(),z=Ce(),{t:f}=$e(),x=W(()=>z.loaded?z.getEnumOptions("AccountAuditStatus"):[]),D=g(!1),_=g([]),$=g(!1),M=g(!1),k=g(""),u=J({keyword:"",channelId:void 0,accountAuditStatus:"pending",waiterId:void 0,groupId:void 0,memberId:void 0,submitTimeRange:[]}),E=g([]),F=g([]),B=g([]),P=g([]),ee=W(()=>[{title:f("account.list.accountInfo"),key:"accountInfo",width:500},{title:f("account.list.memberInfo"),key:"member"},{title:f("account.list.submitTime"),dataIndex:"submitTime",key:"submitTime"},{title:f("account.list.auditStatus"),dataIndex:"accountAuditStatus",key:"accountAuditStatus"},{title:f("account.list.waiterName"),key:"waiterName"},{title:f("account.list.action"),key:"action"}]),te={selectedRowKeys:_,onChange:e=>{_.value=e},getCheckboxProps:e=>({disabled:e.accountAuditStatus!=="pending"})},H=g([]),w=J({current:1,pageSize:10,total:0}),V=()=>{w.current=1,C()},ae=()=>{Object.assign(u,{keyword:"",channelId:void 0,accountAuditStatus:"pending",waiterId:void 0,groupId:void 0,memberId:void 0,submitTimeRange:[]}),V()},ne=e=>{U.push(`/member/view/${e.memberId}`)},le=e=>{U.push({name:"AccountEdit",params:{id:e.id}})},oe=e=>{X.error({content:e.rejectReason})},se=()=>{U.push("/account/old")},ue=e=>{Object.assign(w,{current:e.current,pageSize:e.pageSize}),C()},ce=async e=>{_.value=[e.id],G()},G=async()=>{if(!_.value.length){h.warning(f("account.list.message.selectAccount"));return}const e=await Q("account.batchResolve",{ids:_.value});if(e.code===0){const a=e.data.failed.map(S=>S.reason).join(",");a?X.error({title:f("account.list.batchRejectFailedTitle"),content:a}):(h.success(f("account.list.message.success")),_.value=[],C())}else h.error(e.message)},ie=async()=>{if(!_.value.length){h.warning(f("account.list.message.selectAccount"));return}k.value="",$.value=!0},re=e=>{_.value=[e.id],k.value="",$.value=!0},de=async()=>{if(!k.value){h.error(f("account.list.message.rejectReason"));return}M.value=!0;try{const e=await Q("account.batchReject",{ids:_.value,rejectReason:k.value});e.code===0?(h.success(f("account.list.message.success")),_.value=[],$.value=!1,C()):h.error(e.message)}catch(e){console.log(e)}finally{M.value=!1}},C=async()=>{var e,a;D.value=!0;try{const S={page:w.current,pageSize:w.pageSize,keyword:u.keyword,channelId:u.channelId,accountAuditStatus:u.accountAuditStatus,waiterId:u.waiterId,groupId:u.groupId,memberId:u.memberId,submitStartTime:(e=u.submitTimeRange)==null?void 0:e[0],submitEndTime:(a=u.submitTimeRange)==null?void 0:a[1]},d=await T("account.list",{...S});d.code===0?(H.value=d.data.list,w.total=d.data.total):h.error(d.message)}finally{D.value=!1}},me=async()=>{const e=await T("channel.list");e.code===0&&(E.value=e.data.list)},L=async(e="")=>{try{const a=await T("group.list",{page:1,pageSize:50,groupName:e});a.code===0&&(F.value=a.data.list||[])}catch{h.error("获取群组列表失败")}},K=async(e="")=>{const a=await T("member.list",{page:1,pageSize:50,memberNickname:e});a.code===0&&(B.value=a.data.list||[])},pe=async e=>{const a=await Ae("account.delete",{},{urlParams:{id:e.id}});a.code===0?(h.success(a.message),C()):h.error(a.message)},fe=async()=>{if(P.value.length)return;const e=await T("waiter.list",{page:1,pageSize:100});e.code===0&&(P.value=e.data.list||[])};return Se(()=>{C(),L(),me(),K(),fe()}),(e,a)=>{const S=r("a-input"),d=r("a-form-item"),I=r("a-select-option"),R=r("a-select"),ve=r("a-range-picker"),A=r("a-button"),j=r("a-space"),he=r("a-form"),_e=r("a-avatar"),q=r("a-typography-link"),ge=r("info-circle-outlined"),Y=r("a-popconfirm"),ye=r("a-table"),be=r("a-textarea"),ke=r("a-modal");return c(),m("div",Oe,[i("div",Te,[i("div",Ne,[l(he,{layout:"inline",model:u},{default:n(()=>[l(d,{label:e.$t("account.search.account")},{default:n(()=>[l(S,{value:u.keyword,"onUpdate:value":a[0]||(a[0]=t=>u.keyword=t),placeholder:e.$t("account.search.accountPlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),l(d,{label:e.$t("account.search.channel")},{default:n(()=>[l(R,{value:u.channelId,"onUpdate:value":a[1]||(a[1]=t=>u.channelId=t),placeholder:e.$t("account.search.channelPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:n(()=>[(c(!0),m(b,null,N(E.value,t=>(c(),y(I,{key:t.id,value:t.id},{default:n(()=>[p(o(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),l(d,{label:e.$t("account.search.submitTime")},{default:n(()=>[l(ve,{value:u.submitTimeRange,"onUpdate:value":a[2]||(a[2]=t=>u.submitTimeRange=t),"show-time":{format:"HH:mm"},format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm:ss",style:{width:"280px"}},null,8,["value"])]),_:1},8,["label"]),l(d,{label:e.$t("account.search.auditStatus")},{default:n(()=>[l(R,{value:u.accountAuditStatus,"onUpdate:value":a[3]||(a[3]=t=>u.accountAuditStatus=t),placeholder:e.$t("account.search.auditStatusPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:n(()=>[(c(!0),m(b,null,N(x.value,t=>(c(),y(I,{key:t.value,value:t.value},{default:n(()=>[p(o(t.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),l(d,{label:e.$t("account.search.auditor")},{default:n(()=>[l(R,{value:u.waiterId,"onUpdate:value":a[4]||(a[4]=t=>u.waiterId=t),placeholder:e.$t("account.search.auditorPlaceholder"),"allow-clear":"",style:{width:"120px"}},{default:n(()=>[(c(!0),m(b,null,N(P.value,t=>(c(),y(I,{key:t.id,value:t.id},{default:n(()=>[p(o(t.username),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),l(d,{label:e.$t("account.search.group")},{default:n(()=>[l(R,{value:u.groupId,"onUpdate:value":a[5]||(a[5]=t=>u.groupId=t),placeholder:e.$t("account.search.groupPlaceholder"),style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:L},{default:n(()=>[(c(!0),m(b,null,N(F.value,t=>(c(),y(I,{key:t.id,value:t.id},{default:n(()=>[p(o(t.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),l(d,{label:e.$t("account.search.member")},{default:n(()=>[l(R,{value:u.memberId,"onUpdate:value":a[6]||(a[6]=t=>u.memberId=t),placeholder:e.$t("account.search.memberPlaceholder"),style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:K},{default:n(()=>[(c(!0),m(b,null,N(B.value,t=>(c(),y(I,{key:t.id,value:t.id},{default:n(()=>[p(o(t.nickname),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),l(d,null,{default:n(()=>[l(j,null,{default:n(()=>[l(A,{type:"primary",onClick:V},{default:n(()=>[p(o(e.$t("common.search")),1)]),_:1}),l(A,{onClick:ae},{default:n(()=>[p(o(e.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),i("div",Ue,[l(A,{onClick:se},{default:n(()=>[p(o(e.$t("account.list.oldAccount")),1)]),_:1}),i("div",ze,[l(j,null,{default:n(()=>[l(A,{type:"primary",onClick:G},{default:n(()=>[p(o(e.$t("common.batchResolve")),1)]),_:1}),l(A,{danger:"",onClick:ie},{default:n(()=>[p(o(e.$t("common.batchReject")),1)]),_:1})]),_:1})])])]),l(ye,{columns:ee.value,"data-source":H.value,loading:D.value,pagination:w,"row-selection":te,rowKey:"id",onChange:ue},{bodyCell:n(({column:t,record:s})=>[t.key==="accountInfo"?(c(),m("div",De,[l(j,null,{default:n(()=>[l(_e,{src:s.channelIcon,size:"small"},null,8,["src"]),i("span",null,o(s.account),1)]),_:2},1024),i("div",null,[i("div",Me,[i("span",Pe,o(e.$t("account.list.homepage"))+"：",1),l(Z,{content:s.homeUrl},{default:n(()=>[l(q,null,{default:n(()=>[i("a",{href:s.homeUrl,target:"_blank"},o(s.homeUrl),9,Ye)]),_:2},1024)]),_:2},1032,["content"])])]),i("div",null,[a[9]||(a[9]=i("span",{class:"label"},"uid：",-1)),l(Z,{content:s.uid},null,8,["content"])]),i("div",Ee,[s.channelCustomFields.includes("fansCount")?(c(),m("div",Fe,o(e.$t("account.list.fansCount"))+"："+o(s.fansCount),1)):v("",!0),s.channelCustomFields.includes("friendsCount")?(c(),m("div",Be,o(e.$t("account.list.friendsCount"))+"："+o(s.friendsCount),1)):v("",!0),s.channelCustomFields.includes("postsCount")?(c(),m("div",He,o(e.$t("account.list.postsCount"))+"："+o(s.postsCount),1)):v("",!0)])])):v("",!0),t.key==="member"?(c(),m("div",Ve,[i("div",null,[l(q,{onClick:O=>ne(s)},{default:n(()=>[p(o(s.memberNickname),1)]),_:2},1032,["onClick"])]),l(j,{class:"group-name"},{default:n(()=>[i("span",null,o(s.groupName),1),s.isGroupOwner?(c(),y(je,{key:0})):v("",!0)]),_:2},1024)])):v("",!0),t.key==="accountAuditStatus"?(c(),m(b,{key:2},[p(o(Re(z).getEnumText("AccountAuditStatus",s.accountAuditStatus))+" ",1),s.accountAuditStatus==="rejected"?(c(),y(ge,{key:0,class:"danger",onClick:O=>oe(s)},null,8,["onClick"])):v("",!0)],64)):v("",!0),t.key==="waiterName"?(c(),m(b,{key:3},[p(o(s.waiterName||"--"),1)],64)):v("",!0),t.key==="action"?(c(),y(j,{key:4},{default:n(()=>[s.accountAuditStatus==="pending"?(c(),y(Y,{key:0,title:e.$t("account.list.resolveConfirm"),onConfirm:O=>ce(s)},{default:n(()=>[i("a",null,o(e.$t("account.list.resolve")),1)]),_:2},1032,["title","onConfirm"])):v("",!0),s.accountAuditStatus==="pending"?(c(),y(Y,{key:1,title:e.$t("account.list.rejectConfirm"),onConfirm:O=>re(s)},{default:n(()=>[i("a",Ge,o(e.$t("account.list.reject")),1)]),_:2},1032,["title","onConfirm"])):v("",!0),i("a",{onClick:O=>le(s)},o(e.$t("common.edit")),9,Le),l(Y,{title:e.$t("common.deleteConfirm"),onConfirm:O=>pe(s)},{default:n(()=>[i("a",Ke,o(e.$t("common.delete")),1)]),_:2},1032,["title","onConfirm"])]),_:2},1024)):v("",!0)]),_:1},8,["columns","data-source","loading","pagination"])]),l(ke,{open:$.value,"onUpdate:open":a[8]||(a[8]=t=>$.value=t),title:e.$t("account.list.rejectReason"),onOk:de,confirmLoading:M.value},{default:n(()=>[l(be,{value:k.value,"onUpdate:value":a[7]||(a[7]=t=>k.value=t),placeholder:e.$t("account.list.rejectReasonPlaceholder"),rows:4},null,8,["value","placeholder"])]),_:1},8,["open","title","confirmLoading"])])}}},Ze=we(qe,[["__scopeId","data-v-f1706650"]]);export{Ze as default};

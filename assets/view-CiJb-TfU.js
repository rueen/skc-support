import{_ as re,i as ue,r as _,a as x,j as ie,A as de,k as me,v as ce,b as f,c as e,d as r,w as a,e as d,F as q,n as G,l as I,o as m,h as l,t as u,g as T,U as pe,q as k,p as U,m as w,z as M}from"./index-D-NyEYsv.js";import{P as _e}from"./index-KThUC32V.js";const fe={class:"member-view content-container"},ve={class:"detail-container"},be={class:"section"},ge={key:0},ke={key:0},we={class:"section"},ye={class:"account-list"},Ce={class:"link-text-container"},xe=["href"],Ie={class:"section",style:{"padding-bottom":"24px"}},Se={class:"section",style:{"padding-bottom":"24px"}},Re={class:"section"},Te={__name:"view",setup(Ue){const F=ue(),p=ce(),S=_(""),i=x({}),L=_([]),N=ie(()=>`${de.h5Url}?inviteCode=${i.inviteCode}`),O=x({}),z=x({}),P=x({}),$=_(),v=_(!1),y=_("grant"),c=x({amount:"",remark:""}),C=_(!1),H=_({amount:[{required:!0,message:"请输入奖励金额"}],remark:[{required:!0,message:"请输入备注"}]}),h=n=>{navigator.clipboard.writeText(n).then(()=>{w.success("复制成功")}).catch(()=>{w.error("复制失败")})},J=async n=>{const t=await I("member.detail",{},{urlParams:{id:p.params.id}});t.code===0&&Object.assign(i,t.data||{})},K=async n=>{const t=await I("account.list",{memberId:n});t.code===0&&(L.value=t.data.list||[])},Q=async n=>{const t=await I("member.taskStats",{},{urlParams:{memberId:n}});t.code===0&&Object.assign(O,t.data||{})},W=async n=>{const t=await I("member.inviteStats",{},{urlParams:{memberId:n}});t.code===0&&Object.assign(z,t.data||{})},X=async n=>{const t=await I("member.groupsStats",{},{urlParams:{memberId:n}});t.code===0&&Object.assign(P,t.data||{})},Y=()=>{v.value=!0,y.value="grant"},Z=()=>{v.value=!0,y.value="deduct"},ee=async()=>{C.value=!0;const n=await M("member.grantReward",{memberId:S.value,amount:c.amount,remark:c.remark});n.code===0?(w.success("奖励发放成功"),v.value=!1):w.error(n.message),C.value=!1},te=async()=>{C.value=!0;const n=await M("member.deductReward",{memberId:S.value,amount:c.amount,remark:c.remark},{urlParams:{memberId:S.value}});n.code===0?(w.success("奖励扣除成功"),v.value=!1):w.error(n.message),C.value=!1},ae=async()=>{switch(await $.value.validate(),y.value){case"grant":ee();break;case"deduct":te();break}};return me(()=>{S.value=p.params.id,J(p.params.id),K(p.params.id),Q(p.params.id),W(p.params.id),X(p.params.id)}),(n,t)=>{const o=d("a-descriptions-item"),j=d("a-avatar"),A=d("a-tag"),R=d("a-button"),V=d("a-space"),B=d("a-descriptions"),b=d("a-statistic"),g=d("a-col"),E=d("a-row"),se=d("a-input"),D=d("a-form-item"),le=d("a-textarea"),ne=d("a-form"),oe=d("a-modal");return m(),f("div",fe,[e(_e,{title:"会员详情",back:!0}),r("div",ve,[r("div",be,[t[10]||(t[10]=r("div",{class:"section-title"},"会员信息",-1)),e(B,{column:2},{default:a(()=>[e(o,{label:"会员昵称"},{default:a(()=>[l(u(i.nickname),1)]),_:1}),e(o,{label:"会员账号"},{default:a(()=>[l(u(i.account),1)]),_:1}),e(o,{label:"会员头像"},{default:a(()=>[e(j,{src:i.avatar,size:"small"},{icon:a(()=>[e(T(pe))]),_:1},8,["src"])]),_:1}),e(o,{label:"性别"},{default:a(()=>[l(u(T(F).getEnumText("GenderType",i.gender)),1)]),_:1}),e(o,{label:"职业"},{default:a(()=>[l(u(T(F).getEnumText("OccupationType",i.occupation))+" ",1),i.occupation===null?(m(),f("span",ge," - ")):k("",!0)]),_:1}),e(o,{label:"电子邮箱"},{default:a(()=>[l(u(i.email||"-"),1)]),_:1}),e(o,{label:"手机号码"},{default:a(()=>[l(u(i.phone||"-"),1)]),_:1}),e(o,{label:"Telegram"},{default:a(()=>[l(u(i.telegram||"-"),1)]),_:1}),e(o,{label:"所属群组"},{default:a(()=>[(m(!0),f(q,null,G(i.groups,s=>(m(),f("div",{key:s.id},[l(u(s.groupName)+" ",1),s.isOwner?(m(),U(A,{key:0,color:"blue",style:{"margin-left":"8px"}},{default:a(()=>t[6]||(t[6]=[l("群主")])),_:1})):k("",!0)]))),128)),!i.groups||!i.groups.length?(m(),f("span",ke,"未加入群组")):k("",!0)]),_:1}),e(o,{label:"邀请人"},{default:a(()=>[l(u(i.inviterNickname||"-"),1)]),_:1}),e(o,{label:"邀请链接"},{default:a(()=>[r("span",null,u(N.value),1),e(R,{type:"link",size:"small",onClick:t[0]||(t[0]=s=>h(N.value))},{default:a(()=>t[7]||(t[7]=[l(" 复制 ")])),_:1})]),_:1}),e(o,{label:"账户余额"},{default:a(()=>[e(V,null,{default:a(()=>[r("span",null,u(i.balance),1),e(R,{type:"link",size:"small",onClick:t[1]||(t[1]=s=>Y())},{default:a(()=>t[8]||(t[8]=[l(" 奖励发放 ")])),_:1}),e(R,{type:"link",size:"small",onClick:t[2]||(t[2]=s=>Z())},{default:a(()=>t[9]||(t[9]=[l(" 奖励扣除 ")])),_:1})]),_:1})]),_:1})]),_:1})]),r("div",we,[t[12]||(t[12]=r("div",{class:"section-title"},"账号信息",-1)),r("div",ye,[(m(!0),f(q,null,G(L.value,s=>(m(),f("div",{key:s.channelId},[e(B,{column:1},{default:a(()=>[e(o,{label:"账号"},{default:a(()=>[e(V,null,{default:a(()=>[e(j,{src:s.channelIcon,size:"small"},null,8,["src"]),r("span",null,u(s.account),1),e(A,{color:"warning"},{default:a(()=>[l(u(T(F).getEnumText("AccountAuditStatus",s.accountAuditStatus)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(o,{label:"主页"},{default:a(()=>[r("div",Ce,[r("a",{href:s.homeUrl,target:"_blank",class:"link-text"},u(s.homeUrl),9,xe),e(R,{type:"link",size:"small",onClick:Fe=>h(s.homeUrl)},{default:a(()=>t[11]||(t[11]=[l(" 复制 ")])),_:2},1032,["onClick"])])]),_:2},1024),s.channelCustomFields.includes("fansCount")?(m(),U(o,{key:0,label:"粉丝数"},{default:a(()=>[l(u(s.fansCount),1)]),_:2},1024)):k("",!0),s.channelCustomFields.includes("friendsCount")?(m(),U(o,{key:1,label:"好友数"},{default:a(()=>[l(u(s.friendsCount),1)]),_:2},1024)):k("",!0),s.channelCustomFields.includes("postsCount")?(m(),U(o,{key:2,label:"发帖数"},{default:a(()=>[l(u(s.postsCount),1)]),_:2},1024)):k("",!0)]),_:2},1024)]))),128))])]),r("div",Ie,[t[13]||(t[13]=r("div",{class:"section-title"},"任务信息",-1)),e(E,{gutter:16},{default:a(()=>[e(g,{span:6},{default:a(()=>[e(b,{title:"完成任务次数",value:O.completedTaskCount},null,8,["value"])]),_:1}),e(g,{span:6},{default:a(()=>[e(b,{title:"任务奖励",value:O.totalTaskReward,precision:2,prefix:"¥"},null,8,["value"])]),_:1})]),_:1})]),r("div",Se,[t[14]||(t[14]=r("div",{class:"section-title"},"邀请信息",-1)),e(E,null,{default:a(()=>[e(g,{span:6},{default:a(()=>[e(b,{title:"累计邀请",value:z.inviteCount},null,8,["value"])]),_:1}),e(g,{span:6},{default:a(()=>[e(b,{title:"邀请奖励",value:z.totalReward,prefix:"¥"},null,8,["value"])]),_:1})]),_:1})]),r("div",Re,[t[15]||(t[15]=r("div",{class:"section-title"},"群组信息",-1)),e(E,null,{default:a(()=>[e(g,{span:6},{default:a(()=>[e(b,{title:"管理群数量",value:P.groupCount},null,8,["value"])]),_:1}),e(g,{span:6},{default:a(()=>[e(b,{title:"群收益",value:P.totalEarnings,prefix:"¥"},null,8,["value"])]),_:1})]),_:1})])]),e(oe,{open:v.value,"onUpdate:open":t[5]||(t[5]=s=>v.value=s),title:y.value==="grant"?"奖励发放":"奖励扣除",onOk:ae,confirmLoading:C.value},{default:a(()=>[e(ne,{ref_key:"rewardFormRef",ref:$,model:c,rules:H.value,"label-col":{span:6},"wrapper-col":{span:16}},{default:a(()=>[e(D,{label:y.value==="grant"?"奖励金额":"扣除金额",name:"amount"},{default:a(()=>[e(se,{value:c.amount,"onUpdate:value":t[3]||(t[3]=s=>c.amount=s)},null,8,["value"])]),_:1},8,["label"]),e(D,{label:"备注",name:"remark"},{default:a(()=>[e(le,{value:c.remark,"onUpdate:value":t[4]||(t[4]=s=>c.remark=s),rows:4},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["open","title","confirmLoading"])])}}},Pe=re(Te,[["__scopeId","data-v-93eecce1"]]);export{Pe as default};

import{_ as J,b as K,a as Q,j as g,r as B,c as O,k as X,d as n,e as S,f as o,w as s,g as u,l as Y,m as Z,h as ee,o as a,F as d,n as D,p as f,i as k,t as i,s as p,q as T,M as te}from"./index-QyF0JL28.js";const ae={class:"other-bill content-container"},le={class:"table-container"},ne={class:"table-header"},se={class:"left"},ie=["onClick"],oe=["onClick"],ue={key:1},ce={key:1},me={key:0},re={key:1},de={key:0},pe={key:1},_e={__name:"bills",setup(be){const{t:m}=K(),r=Q(),N=ee(),F=g(()=>r.loaded?r.getEnumOptions("BillType"):[]),M=g(()=>r.loaded?r.getEnumOptions("SettlementStatus"):[]),h=B(!1),c=O({memberNickname:"",billType:void 0,settlementStatus:void 0}),R=e=>{te.error({title:"结算失败原因",content:e.failureReason})},V=g(()=>[{title:m("financial.bills.memberNickname"),key:"memberNickname"},{title:m("financial.bills.billType"),dataIndex:"billType",key:"billType"},{title:m("financial.bills.relatedTaskName"),key:"taskName"},{title:m("financial.bills.amount"),dataIndex:"amount",key:"amount",align:"right"},{title:m("financial.bills.remark"),key:"remark"},{title:m("financial.bills.createTime"),dataIndex:"createTime",key:"createTime"},{title:m("financial.bills.settlementStatus"),key:"settlementStatus"}]),w=B([]),_=O({current:1,pageSize:10,total:0}),C=()=>{_.current=1,v()},j=()=>{Object.assign(c,{memberNickname:"",billType:void 0,settlementStatus:void 0}),C()},z=e=>{Object.assign(_,e),v()},P=e=>{N.push(`/member/view/${e.memberId}`)},U=e=>{N.push(`/submitted-tasks/detail/${e.submittedId}`)},v=async()=>{h.value=!0;try{const e=await Y("finance.bills",{page:_.current,pageSize:_.pageSize,...c});e.code===0?(w.value=e.data.list,_.total=e.data.total):Z.error(e.message)}finally{h.value=!1}};return X(()=>{v()}),(e,b)=>{const q=u("a-input"),y=u("a-form-item"),$=u("a-select-option"),x=u("a-select"),E=u("a-button"),L=u("a-space"),W=u("a-form"),A=u("a-typography-text"),G=u("info-circle-outlined"),H=u("a-table");return a(),n("div",ae,[S("div",le,[S("div",ne,[S("div",se,[o(W,{layout:"inline",model:c},{default:s(()=>[o(y,{label:e.$t("financial.bills.memberNickname")},{default:s(()=>[o(q,{value:c.memberNickname,"onUpdate:value":b[0]||(b[0]=t=>c.memberNickname=t),placeholder:e.$t("financial.bills.memberNicknamePlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),o(y,{label:e.$t("financial.bills.billType")},{default:s(()=>[o(x,{value:c.billType,"onUpdate:value":b[1]||(b[1]=t=>c.billType=t),placeholder:e.$t("financial.bills.billTypePlaceholder"),style:{width:"120px"},"allow-clear":""},{default:s(()=>[(a(!0),n(d,null,D(F.value,t=>(a(),f($,{key:t.value,value:t.value},{default:s(()=>[k(i(t.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),o(y,{label:e.$t("financial.bills.settlementStatus")},{default:s(()=>[o(x,{value:c.settlementStatus,"onUpdate:value":b[2]||(b[2]=t=>c.settlementStatus=t),placeholder:e.$t("financial.bills.settlementStatusPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:s(()=>[(a(!0),n(d,null,D(M.value,t=>(a(),f($,{key:t.value,value:t.value},{default:s(()=>[k(i(t.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),o(y,null,{default:s(()=>[o(L,null,{default:s(()=>[o(E,{type:"primary",onClick:C},{default:s(()=>[k(i(e.$t("common.search")),1)]),_:1}),o(E,{onClick:j},{default:s(()=>[k(i(e.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),o(H,{columns:V.value,"data-source":w.value,loading:h.value,pagination:_,onChange:z},{bodyCell:s(({column:t,record:l})=>[t.key==="memberNickname"?(a(),n("a",{key:0,onClick:I=>P(l)},i(l.memberNickname),9,ie)):p("",!0),t.key==="taskName"?(a(),n(d,{key:1},[l.taskName?(a(),n("a",{key:0,onClick:I=>U(l)},i(l.taskName),9,oe)):(a(),n("span",ue,"--"))],64)):p("",!0),t.key==="billType"?(a(),n(d,{key:2},[k(i(T(r).getEnumText("BillType",l.billType)),1)],64)):p("",!0),t.key==="amount"?(a(),n(d,{key:3},[l.billType==="reward_deduction"?(a(),f(A,{key:0,type:"danger"},{default:s(()=>[k(" - "+i(l.amount),1)]),_:2},1024)):(a(),n("span",ce,i(l.amount),1))],64)):p("",!0),t.key==="remark"?(a(),n(d,{key:4},[l.remark?(a(),n("span",me,i(l.remark)+"("+i(e.$t("financial.bills.operator"))+": "+i(l.waiterName)+")",1)):(a(),n("span",re,"--"))],64)):p("",!0),t.key==="settlementStatus"?(a(),n(d,{key:5},[l.billType==="withdrawal"?(a(),n("span",de,i(T(r).getEnumText("WithdrawalStatus",l.withdrawalStatus)),1)):(a(),n("span",pe,i(T(r).getEnumText("SettlementStatus",l.settlementStatus)),1)),l.settlementStatus==="failed"||l.withdrawalStatus==="failed"?(a(),f(G,{key:2,class:"status-icon",onClick:I=>R(l)},null,8,["onClick"])):p("",!0)],64)):p("",!0)]),_:1},8,["columns","data-source","loading","pagination"])])])}}},ye=J(_e,[["__scopeId","data-v-91569b33"]]);export{ye as default};

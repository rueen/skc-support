import{_ as ne,r as d,a as x,l as le,b as N,d as _,c as t,w as n,e as r,m as B,j as o,o as g,F as H,n as oe,p as O,h as m,t as h,g as se,D as re,q as z,A as j}from"./index-CrZnNwoR.js";import{e as ie}from"./enum-Ciewj-1_.js";const ce={class:"withdrawal content-container"},ue={class:"table-container"},de={class:"table-header"},me={class:"left"},pe={class:"right"},ve=["onClick"],_e={__name:"withdrawal",setup(fe){const y=d(!1),k=d(null),c=d([]),f=d(!1),b=d(!1),p=d(""),s=x({memberNickname:"",withdrawalStatus:void 0,timeRange:[]}),A=[{title:"会员昵称",dataIndex:"memberNickname",key:"memberNickname"},{title:"提现账户",dataIndex:"memberAccount",key:"memberAccount"},{title:"账户类型",dataIndex:"memberAccountType",key:"memberAccountType"},{title:"申请提现金额",dataIndex:"amount",key:"amount",align:"right"},{title:"真实姓名",dataIndex:"realName",key:"realName"},{title:"申请时间",dataIndex:"applyTime",key:"applyTime"},{title:"提现状态",dataIndex:"withdrawalStatus",key:"withdrawalStatus"},{title:"操作",key:"action",width:150}],D=d([]),u=x({current:1,pageSize:10,total:0}),I=()=>{u.current=1,v()},E=()=>{Object.assign(s,{memberNickname:"",withdrawalStatus:void 0,timeRange:[]}),I()},L=a=>{Object.assign(u,a),v()},M=a=>{c.value=a},U=async()=>{const a=await B("settlement.withdrawalExport",{params:{page:u.current,pageSize:u.pageSize,...s}});a.code===0?o.success("导出成功"):o.error(a.message)},V=async a=>{try{const e=await j("settlement.batchResolve",{ids:[a.id]});e.code===0?(o.success("操作成功"),v()):o.error(e.message)}catch{o.error("操作失败")}},$=async()=>{if(!c.value.length){o.warning("请选择要操作的记录");return}try{const a=await j("settlement.batchResolve",{ids:c.value});a.code===0?(o.success("操作成功"),c.value=[],v()):o.error(a.message)}catch{o.error("操作失败")}},F=a=>{k.value=a,p.value="",f.value=!0},K=()=>{if(!c.value.length){o.warning("请选择要操作的记录");return}p.value="",f.value=!0},W=async()=>{if(!p.value){o.error("请输入打款失败原因");return}try{b.value=!0;const a={failReason:p.value,ids:k.value?[k.value.id]:c.value},e=await j("settlement.batchReject",a);e.code===0?(o.success("操作成功"),f.value=!1,c.value=[],v()):o.error(e.message)}catch{o.error("操作失败")}finally{b.value=!1}},v=async()=>{var a,e;y.value=!0;try{const S={page:u.current,pageSize:u.pageSize,memberNickname:s.memberNickname,withdrawalStatus:s.withdrawalStatus,startTime:(a=s.timeRange)==null?void 0:a[0],endTime:(e=s.timeRange)==null?void 0:e[1]},i=await B("settlement.withdrawal",{params:S});i.code===0?(D.value=i.data.list||[],u.total=i.data.total||0):o.error(i.message)}finally{y.value=!1}},T=d([]),Y=x({}),q=async()=>{const a=await ie();T.value=Object.values(a),Object.values(a).map(e=>{Y[e.value]=e.text})};return le(()=>{q(),v()}),(a,e)=>{const S=r("a-input"),i=r("a-form-item"),J=r("a-select-option"),G=r("a-select"),P=r("a-range-picker"),w=r("a-button"),R=r("a-space"),Q=r("a-form"),X=r("a-popconfirm"),Z=r("a-table"),ee=r("a-textarea"),ae=r("a-modal");return g(),N("div",ce,[_("div",ue,[_("div",de,[_("div",me,[t(Q,{layout:"inline",model:s},{default:n(()=>[t(i,{label:"会员昵称"},{default:n(()=>[t(S,{value:s.memberNickname,"onUpdate:value":e[0]||(e[0]=l=>s.memberNickname=l),placeholder:"请输入会员昵称","allow-clear":""},null,8,["value"])]),_:1}),t(i,{label:"提现状态"},{default:n(()=>[t(G,{value:s.withdrawalStatus,"onUpdate:value":e[1]||(e[1]=l=>s.withdrawalStatus=l),placeholder:"请选择状态",style:{width:"120px"},"allow-clear":""},{default:n(()=>[(g(!0),N(H,null,oe(T.value,l=>(g(),O(J,{key:l.value,value:l.value},{default:n(()=>[m(h(l.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),t(i,{label:"申请时间"},{default:n(()=>[t(P,{value:s.timeRange,"onUpdate:value":e[2]||(e[2]=l=>s.timeRange=l),"show-time":{format:"HH:mm"},format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["value"])]),_:1}),t(i,null,{default:n(()=>[t(R,null,{default:n(()=>[t(w,{type:"primary",onClick:I},{default:n(()=>[m(h(a.$t("common.search")),1)]),_:1}),t(w,{onClick:E},{default:n(()=>[m(h(a.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_("div",pe,[t(R,null,{default:n(()=>[t(w,{type:"primary",onClick:U},{icon:n(()=>[t(se(re))]),default:n(()=>[e[5]||(e[5]=m(" 导出 "))]),_:1}),t(w,{type:"primary",onClick:$},{default:n(()=>e[6]||(e[6]=[m("批量已打款")])),_:1}),t(w,{danger:"",onClick:K},{default:n(()=>e[7]||(e[7]=[m("批量打款失败")])),_:1})]),_:1})])]),t(Z,{columns:A,"data-source":D.value,loading:y.value,pagination:u,"row-selection":{selectedRowKeys:c.value,onChange:M},onChange:L},{bodyCell:n(({column:l,record:C})=>[l.key==="withdrawalStatus"?(g(),N(H,{key:0},[m(h(Y[C.withdrawalStatus]),1)],64)):z("",!0),l.key==="action"?(g(),O(R,{key:1},{default:n(()=>[t(X,{title:"确定要标记为已打款吗？",onConfirm:te=>V(C)},{default:n(()=>e[8]||(e[8]=[_("a",null,"已打款",-1)])),_:2},1032,["onConfirm"]),_("a",{class:"danger",onClick:te=>F(C)},"打款失败",8,ve)]),_:2},1024)):z("",!0)]),_:1},8,["data-source","loading","pagination","row-selection"])]),t(ae,{open:f.value,"onUpdate:open":e[4]||(e[4]=l=>f.value=l),title:"打款失败原因",onOk:W,confirmLoading:b.value},{default:n(()=>[t(ee,{value:p.value,"onUpdate:value":e[3]||(e[3]=l=>p.value=l),placeholder:"请输入打款失败原因",rows:4},null,8,["value"])]),_:1},8,["open","confirmLoading"])])}}},he=ne(_e,[["__scopeId","data-v-754339a4"]]);export{he as default};

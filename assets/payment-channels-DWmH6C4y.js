import{c as z,r as d,e as F,d as I,p as G,f as H,g as m,h as t,w as s,i,q as J,o as $,k as N,t as _,n as Q,x as W,y as X,v as c,B as Y,C as Z}from"./index-DeJfwwDd.js";const x={class:"channel content-container"},ee={class:"table-container"},ae={class:"table-header"},ne={class:"right"},te=["onClick"],oe={__name:"payment-channels",setup(le){const{t:o}=z(),y=d(!1),r=d(!1),v=d(!1),u=d("add"),b=d(),a=F({name:"",bank:"",merchantId:"",secretKey:""}),C=d(),w={name:[{required:!0,message:o("financial.paymentChannels.channelNamePlaceholder")}],bank:[{required:!0,message:o("financial.paymentChannels.bankNamePlaceholder")}],merchantId:[{required:!0,message:o("financial.paymentChannels.merchantIdPlaceholder")}]},K=I(()=>[{title:o("financial.paymentChannels.channelName"),dataIndex:"name",key:"name"},{title:o("financial.paymentChannels.bankName"),dataIndex:"bank",key:"bank"},{title:o("financial.paymentChannels.merchantId"),dataIndex:"merchantId",key:"merchantId"},{title:o("financial.paymentChannels.updateTime"),dataIndex:"updateTime",key:"updateTime"},{title:o("financial.paymentChannels.action"),key:"action",width:200}]),k=d([]),P=I(()=>({add:o("financial.paymentChannels.addTitle"),edit:o("financial.paymentChannels.editTitle")})[u.value]),T=()=>{u.value="add",a.name="",a.bank="",a.merchantId="",a.secretKey="",r.value=!0},B=e=>{u.value="edit",C.value=e.id,a.name=e.name,a.bank=e.bank,a.merchantId=e.merchantId,a.secretKey=null,r.value=!0},D=async e=>{try{const n=await X("paymentChannels.delete",{},{urlParams:{id:e.id}});n.code===0?(c.success("删除成功"),p()):c.error(n.message)}catch{c.error("删除失败")}},U=async()=>{if(!a.secretKey){c.error("请输入密钥");return}const e=await Z("paymentChannels.add",a);e.code===0?(c.success("添加成功"),r.value=!1,p()):c.error(e.message)},V=async()=>{const e=await Y("paymentChannels.edit",{...a,id:C.value},{urlParams:{id:C.value}});e.code===0?(c.success("编辑成功"),r.value=!1,p()):c.error(e.message)},q=async()=>{try{switch(await b.value.validate(),v.value=!0,u.value){case"add":U();break;case"edit":V();break}}catch(e){console.error(e)}finally{v.value=!1}},p=async()=>{y.value=!0;try{const e=await J("paymentChannels.list");k.value=e.data}finally{y.value=!1}};return G(()=>{p()}),(e,n)=>{const L=i("a-button"),E=i("a-typography-text"),M=i("a-popconfirm"),O=i("a-space"),R=i("a-table"),h=i("a-input"),f=i("a-form-item"),A=i("a-form"),S=i("a-modal");return $(),H("div",x,[m("div",ee,[m("div",ae,[n[5]||(n[5]=m("div",{class:"left"},null,-1)),m("div",ne,[t(L,{type:"primary",onClick:T},{default:s(()=>[N(_(e.$t("financial.paymentChannels.add")),1)]),_:1})])]),t(R,{columns:K.value,"data-source":k.value,loading:y.value,pagination:!1},{bodyCell:s(({column:l,record:g})=>[l.key==="action"?($(),Q(O,{key:0},{default:s(()=>[m("a",{onClick:j=>B(g)},_(e.$t("financial.paymentChannels.edit")),9,te),t(M,{title:e.$t("financial.paymentChannels.deleteConfirm"),onConfirm:j=>D(g)},{default:s(()=>[m("a",null,[t(E,{type:"danger"},{default:s(()=>[N(_(e.$t("financial.paymentChannels.delete")),1)]),_:1})])]),_:2},1032,["title","onConfirm"])]),_:2},1024)):W("",!0)]),_:1},8,["columns","data-source","loading"])]),t(S,{open:r.value,"onUpdate:open":n[4]||(n[4]=l=>r.value=l),title:P.value,confirmLoading:v.value,onOk:q},{default:s(()=>[t(A,{ref_key:"formRef",ref:b,model:a,rules:w,"label-col":{span:6},"wrapper-col":{span:16}},{default:s(()=>[t(f,{label:e.$t("financial.paymentChannels.channelName"),name:"name"},{default:s(()=>[t(h,{value:a.name,"onUpdate:value":n[0]||(n[0]=l=>a.name=l),placeholder:e.$t("financial.paymentChannels.channelNamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(f,{label:e.$t("financial.paymentChannels.bankName"),name:"bank"},{default:s(()=>[t(h,{value:a.bank,"onUpdate:value":n[1]||(n[1]=l=>a.bank=l),placeholder:e.$t("financial.paymentChannels.bankNamePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(f,{label:e.$t("financial.paymentChannels.merchantId"),name:"merchantId"},{default:s(()=>[t(h,{value:a.merchantId,"onUpdate:value":n[2]||(n[2]=l=>a.merchantId=l),placeholder:e.$t("financial.paymentChannels.merchantIdPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(f,{label:e.$t("financial.paymentChannels.secretKey"),name:"secretKey"},{default:s(()=>[t(h,{value:a.secretKey,"onUpdate:value":n[3]||(n[3]=l=>a.secretKey=l),placeholder:e.$t("financial.paymentChannels.secretKeyPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["open","title","confirmLoading"])])}}};export{oe as default};

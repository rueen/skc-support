import{_ as $e,a as Se,b as je,j as x,r as h,c as D,k as Re,d as m,e as d,f as n,w as l,g as p,l as z,m as y,h as Ue,o as s,F as k,n as E,p as g,i as f,t as u,s as r,q as Ae,A as ee,M as te,z as Ie}from"./index-BWKDvxYJ.js";import{_ as ae}from"./CopyContent-DxAkdaSo.js";import{G as Oe}from"./GroupOwner-D3-mrNyJ.js";const Ne={class:"account content-container"},Fe={class:"table-container"},ze={class:"table-header"},Ee={class:"left"},Pe={class:"right"},Le={style:{"text-align":"left","margin-bottom":"16px"}},Be={key:0,class:"account-info"},Ve={class:"link-text-container"},De={class:"label"},Me=["href"],Te={class:"stats"},Ge={key:0,class:"stat-item"},Ke={key:1,class:"stat-item"},qe={key:2,class:"stat-item"},He={key:1},Je={class:"danger"},Qe={__name:"list",setup(We){const M=Ue(),P=Se(),{t:_}=je(),ne=x(()=>P.loaded?P.getEnumOptions("AccountAuditStatus"):[]),L=h(!1),b=h([]),j=h(!1),B=h(!1),w=h(""),c=D({keyword:"",channelId:void 0,accountAuditStatus:"pending",groupId:void 0,memberId:void 0}),T=h([]),G=h([]),K=h([]),R=h(null),le=x(()=>[{title:_("account.list.accountInfo"),key:"accountInfo",width:500},{title:_("account.list.member"),key:"member"},{title:_("account.list.auditStatus"),dataIndex:"accountAuditStatus",key:"accountAuditStatus"},{title:_("account.list.waiterName"),key:"waiterName"},{title:_("account.list.action"),key:"action"}]),oe={selectedRowKeys:b,onChange:e=>{b.value=e},getCheckboxProps:e=>({disabled:e.accountAuditStatus!=="pending"})},q=h([]),$=D({current:1,pageSize:10,total:0}),H=()=>{$.current=1,S()},se=()=>{c.keyword="",c.channelId=void 0,c.accountAuditStatus=void 0,c.groupId=void 0,c.memberId=void 0,H()},ue=e=>{M.push(`/member/view/${e.memberId}`)},I=h(!1),i=D({homeUrl:"",uid:"",account:"",fansCount:"",friendsCount:"",postsCount:""}),V=h(!1),ce=e=>{I.value=!0,R.value=e,Object.assign(i,{homeUrl:e.homeUrl,uid:e.uid,account:e.account,fansCount:e.fansCount,friendsCount:e.friendsCount,postsCount:e.postsCount})},ie=async()=>{const e={};Object.keys(i).forEach(a=>{i[a]!=null&&(e[a]=i[a])}),V.value=!0;try{await Ie("account.edit",e,{urlParams:{id:R.value.id}}),y.success("success"),I.value=!1,S()}catch(a){console.log(a),y.error(a.message)}finally{V.value=!1}},de=e=>{te.error({content:e.rejectReason})},re=()=>{M.push("/account/old")},pe=e=>{Object.assign($,{current:e.current,pageSize:e.pageSize}),S()},me=async e=>{b.value=[e.id],J()},J=async()=>{if(!b.value.length){y.warning(_("account.list.message.selectAccount"));return}const e=await ee("account.batchResolve",{ids:b.value});if(e.code===0){const a=e.data.failed.map(C=>C.reason).join(",");a?te.error({title:_("account.list.batchRejectFailedTitle"),content:a}):(y.success(_("account.list.message.success")),b.value=[],S())}else y.error(e.message)},fe=async()=>{if(!b.value.length){y.warning(_("account.list.message.selectAccount"));return}w.value="",j.value=!0},ve=e=>{b.value=[e.id],w.value="",j.value=!0},he=async()=>{if(!w.value){y.error(_("account.list.message.rejectReason"));return}B.value=!0;try{const e=await ee("account.batchReject",{ids:b.value,rejectReason:w.value});e.code===0?(y.success(_("account.list.message.success")),b.value=[],j.value=!1,S()):y.error(e.message)}catch(e){console.log(e)}finally{B.value=!1}},S=async()=>{L.value=!0;try{const e=await z("account.list",{page:$.current,pageSize:$.pageSize,...c});e.code===0?(q.value=e.data.list,$.total=e.data.total):y.error(e.message)}finally{L.value=!1}},ge=async()=>{const e=await z("channel.list");e.code===0&&(T.value=e.data.list)},Q=async(e="")=>{try{const a=await z("group.list",{page:1,pageSize:50,groupName:e});a.code===0&&(G.value=a.data.list||[])}catch{y.error("获取群组列表失败")}},W=async(e="")=>{const a=await z("member.list",{page:1,pageSize:50,memberNickname:e});a.code===0&&(K.value=a.data.list||[])};return Re(()=>{S(),Q(),ge(),W()}),(e,a)=>{const C=p("a-input"),v=p("a-form-item"),O=p("a-select-option"),N=p("a-select"),U=p("a-button"),A=p("a-space"),X=p("a-form"),_e=p("EditOutlined"),ye=p("a-avatar"),be=p("a-typography-link"),Ce=p("info-circle-outlined"),Y=p("a-popconfirm"),ke=p("a-table"),we=p("a-textarea"),Z=p("a-modal");return s(),m("div",Ne,[d("div",Fe,[d("div",ze,[d("div",Ee,[n(X,{layout:"inline",model:c},{default:l(()=>[n(v,{label:e.$t("account.search.account")},{default:l(()=>[n(C,{value:c.keyword,"onUpdate:value":a[0]||(a[0]=t=>c.keyword=t),placeholder:e.$t("account.search.accountPlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),n(v,{label:e.$t("account.search.channel")},{default:l(()=>[n(N,{value:c.channelId,"onUpdate:value":a[1]||(a[1]=t=>c.channelId=t),placeholder:e.$t("account.search.channelPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:l(()=>[(s(!0),m(k,null,E(T.value,t=>(s(),g(O,{key:t.id,value:t.id},{default:l(()=>[f(u(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),n(v,{label:e.$t("account.search.auditStatus")},{default:l(()=>[n(N,{value:c.accountAuditStatus,"onUpdate:value":a[2]||(a[2]=t=>c.accountAuditStatus=t),placeholder:e.$t("account.search.auditStatusPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:l(()=>[(s(!0),m(k,null,E(ne.value,t=>(s(),g(O,{key:t.value,value:t.value},{default:l(()=>[f(u(t.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),n(v,{label:e.$t("account.search.group")},{default:l(()=>[n(N,{value:c.groupId,"onUpdate:value":a[3]||(a[3]=t=>c.groupId=t),placeholder:e.$t("account.search.groupPlaceholder"),style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:Q},{default:l(()=>[(s(!0),m(k,null,E(G.value,t=>(s(),g(O,{key:t.id,value:t.id},{default:l(()=>[f(u(t.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),n(v,{label:e.$t("account.search.member")},{default:l(()=>[n(N,{value:c.memberId,"onUpdate:value":a[4]||(a[4]=t=>c.memberId=t),placeholder:e.$t("account.search.memberPlaceholder"),style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:W},{default:l(()=>[(s(!0),m(k,null,E(K.value,t=>(s(),g(O,{key:t.id,value:t.id},{default:l(()=>[f(u(t.nickname),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),n(v,null,{default:l(()=>[n(A,null,{default:l(()=>[n(U,{type:"primary",onClick:H},{default:l(()=>[f(u(e.$t("common.search")),1)]),_:1}),n(U,{onClick:se},{default:l(()=>[f(u(e.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),d("div",Pe,[n(A,null,{default:l(()=>[n(U,{type:"primary",onClick:J},{default:l(()=>[f(u(e.$t("common.batchResolve")),1)]),_:1}),n(U,{danger:"",onClick:fe},{default:l(()=>[f(u(e.$t("common.batchReject")),1)]),_:1})]),_:1})])]),d("div",Le,[n(U,{onClick:re},{default:l(()=>[f(u(e.$t("account.list.oldAccount")),1)]),_:1})]),n(ke,{columns:le.value,"data-source":q.value,loading:L.value,pagination:$,"row-selection":oe,rowKey:"id",onChange:pe},{bodyCell:l(({column:t,record:o})=>[t.key==="accountInfo"?(s(),m("div",Be,[n(_e,{class:"edit-icon",onClick:F=>ce(o)},null,8,["onClick"]),n(A,null,{default:l(()=>[n(ye,{src:o.channelIcon,size:"small"},null,8,["src"]),d("span",null,u(o.account),1)]),_:2},1024),d("div",null,[d("div",Ve,[d("span",De,u(e.$t("account.list.homepage"))+"：",1),n(ae,{content:o.homeUrl},{default:l(()=>[d("a",{href:o.homeUrl,target:"_blank",class:"link-text"},u(o.homeUrl),9,Me)]),_:2},1032,["content"])])]),d("div",null,[a[14]||(a[14]=d("span",{class:"label"},"uid：",-1)),n(ae,{content:o.uid},null,8,["content"])]),d("div",Te,[o.channelCustomFields.includes("fansCount")?(s(),m("div",Ge,u(e.$t("account.list.fansCount"))+"："+u(o.fansCount),1)):r("",!0),o.channelCustomFields.includes("friendsCount")?(s(),m("div",Ke,u(e.$t("account.list.friendsCount"))+"："+u(o.friendsCount),1)):r("",!0),o.channelCustomFields.includes("postsCount")?(s(),m("div",qe,u(e.$t("account.list.postsCount"))+"："+u(o.postsCount),1)):r("",!0)])])):r("",!0),t.key==="member"?(s(),m("div",He,[n(be,{onClick:F=>ue(o)},{default:l(()=>[f(u(o.memberNickname),1)]),_:2},1032,["onClick"]),n(A,{class:"group-name"},{default:l(()=>[d("span",null,u(o.groupName),1),o.isGroupOwner?(s(),g(Oe,{key:0})):r("",!0)]),_:2},1024)])):r("",!0),t.key==="accountAuditStatus"?(s(),m(k,{key:2},[f(u(Ae(P).getEnumText("AccountAuditStatus",o.accountAuditStatus))+" ",1),o.accountAuditStatus==="rejected"?(s(),g(Ce,{key:0,class:"danger",onClick:F=>de(o)},null,8,["onClick"])):r("",!0)],64)):r("",!0),t.key==="waiterName"?(s(),m(k,{key:3},[f(u(o.waiterName||"--"),1)],64)):r("",!0),t.key==="action"?(s(),g(A,{key:4},{default:l(()=>[o.accountAuditStatus==="pending"?(s(),g(Y,{key:0,title:e.$t("account.list.resolveConfirm"),onConfirm:F=>me(o)},{default:l(()=>[d("a",null,u(e.$t("account.list.resolve")),1)]),_:2},1032,["title","onConfirm"])):r("",!0),o.accountAuditStatus==="pending"?(s(),g(Y,{key:1,title:e.$t("account.list.rejectConfirm"),onConfirm:F=>ve(o)},{default:l(()=>[d("a",Je,u(e.$t("account.list.reject")),1)]),_:2},1032,["title","onConfirm"])):r("",!0)]),_:2},1024)):r("",!0),t.key==="rejectReason"?(s(),m(k,{key:5},[f(u(o.rejectReason),1)],64)):r("",!0)]),_:1},8,["columns","data-source","loading","pagination"])]),n(Z,{open:j.value,"onUpdate:open":a[6]||(a[6]=t=>j.value=t),title:e.$t("account.list.rejectReason"),onOk:he,confirmLoading:B.value},{default:l(()=>[n(we,{value:w.value,"onUpdate:value":a[5]||(a[5]=t=>w.value=t),placeholder:e.$t("account.list.rejectReasonPlaceholder"),rows:4},null,8,["value","placeholder"])]),_:1},8,["open","title","confirmLoading"]),n(Z,{open:I.value,"onUpdate:open":a[13]||(a[13]=t=>I.value=t),title:e.$t("account.list.editAccountTitle"),onOk:ie,confirmLoading:V.value},{default:l(()=>[n(X,{ref:"formRef",model:i,"label-col":{span:6},"wrapper-col":{span:16}},{default:l(()=>[n(v,{label:e.$t("account.list.account"),name:"account"},{default:l(()=>[n(C,{value:i.account,"onUpdate:value":a[7]||(a[7]=t=>i.account=t)},null,8,["value"])]),_:1},8,["label"]),n(v,{label:e.$t("account.list.homepage"),name:"homeUrl"},{default:l(()=>[n(C,{value:i.homeUrl,"onUpdate:value":a[8]||(a[8]=t=>i.homeUrl=t)},null,8,["value"])]),_:1},8,["label"]),n(v,{label:"UID",name:"uid"},{default:l(()=>[n(C,{value:i.uid,"onUpdate:value":a[9]||(a[9]=t=>i.uid=t)},null,8,["value"])]),_:1}),R.value.channelCustomFields.includes("fansCount")?(s(),g(v,{key:0,label:e.$t("account.list.fansCount"),name:"fansCount"},{default:l(()=>[n(C,{value:i.fansCount,"onUpdate:value":a[10]||(a[10]=t=>i.fansCount=t)},null,8,["value"])]),_:1},8,["label"])):r("",!0),R.value.channelCustomFields.includes("friendsCount")?(s(),g(v,{key:1,label:e.$t("account.list.friendsCount"),name:"friendsCount"},{default:l(()=>[n(C,{value:i.friendsCount,"onUpdate:value":a[11]||(a[11]=t=>i.friendsCount=t)},null,8,["value"])]),_:1},8,["label"])):r("",!0),R.value.channelCustomFields.includes("postsCount")?(s(),g(v,{key:2,label:e.$t("account.list.postsCount"),name:"postsCount"},{default:l(()=>[n(C,{value:i.postsCount,"onUpdate:value":a[12]||(a[12]=t=>i.postsCount=t)},null,8,["value"])]),_:1},8,["label"])):r("",!0)]),_:1},8,["model"])]),_:1},8,["open","title","confirmLoading"])])}}},xe=$e(Qe,[["__scopeId","data-v-edbaab93"]]);export{xe as default};

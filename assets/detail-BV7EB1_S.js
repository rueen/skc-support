import{_ as Y,i as Z,r as ee,n as ae,p as te,a as le,q as ne,b as p,c as a,d as g,w as n,e as u,f as oe,o as s,k as f,l as O,F as b,j as k,h as r,t as C,g as R,P as ue,m as j}from"./index-DYCLiFn2.js";import{P as de}from"./index-DMLVy4Uo.js";import{C as se,c as re,g as B,d as ie,e as pe}from"./enums-C8EG5C38.js";const me={class:"task-form content-container"},ve={class:"form-container"},fe={class:"group-select"},ce={key:1,class:"group-tip"},_e={class:"custom-fields"},ge={__name:"detail",setup(be){const x=te(),F=oe(),{locale:N}=Z(),M=ee(),i=ae(()=>x.name==="TaskEdit"),l=le({taskName:"",channelId:void 0,categoryId:void 0,type:void 0,reward:void 0,brand:"",groupIds:[],groupMode:0,customFields:[{title:"",type:"input"}],startTime:null,endTime:null,quota:void 0,unlimitedQuota:!0,fansRequired:void 0,contentRequirement:"",taskInfo:"",notice:`1.请尽快完成发布，填写发布链接。
2.任务结束后无法填写，不能结算。
3.发布内容不符合要求，将无法审核通过。
4.填写链接无法访问或其他无关链接，视为放弃结算。`}),D={taskName:[{required:!0,message:"请输入任务名称"}],channelId:[{required:!0,message:"请选择平台渠道"}],categoryId:[{required:!0,message:"请选择达人领域"}],type:[{required:!0,message:"请选择任务类型"}],reward:[{required:!0,message:"请输入任务奖励"}],fansRequired:[{required:!0,message:"请输入粉丝要求"}],groupIds:[{validator:(d,e)=>l.groupMode===1&&(!e||e.length===0)?Promise.reject("请选择指定群组"):Promise.resolve()}]},Q=[{id:1,name:"抖音"},{id:2,name:"快手"}],V=[{id:1,name:"群组1"},{id:2,name:"群组2"},{id:3,name:"群组3"}],E=()=>{l.customFields.length<10&&l.customFields.push({title:"",type:"input"})},h=d=>{l.customFields.splice(d,1)},S=d=>B(ie,d,N.value),z=d=>B(pe,d,N.value),G=d=>{d.target.value===0&&(l.groupIds=[])},H=()=>{M.value.validate().then(async()=>{try{submitLoading.value=!0;const d={...l,groupIds:l.groupMode===0?[]:l.groupIds};j.success("提交成功"),F.back()}catch{j.error("提交失败")}finally{submitLoading.value=!1}})},$=()=>{F.back()},A=async d=>{};return ne(()=>{i.value&&A(x.params.id)}),(d,e)=>{const y=u("a-input"),o=u("a-form-item"),m=u("a-select-option"),v=u("a-select"),q=u("a-input-number"),L=u("a-radio"),J=u("a-radio-group"),c=u("a-button"),I=u("a-space"),P=u("a-date-picker"),w=u("a-col"),K=u("a-row"),W=u("a-checkbox"),T=u("a-textarea"),X=u("a-form");return s(),p("div",me,[a(de,{title:i.value?"编辑任务":"新建任务",back:!0,class:"page-header"},null,8,["title"]),g("div",ve,[a(X,{ref_key:"formRef",ref:M,model:l,rules:D,"label-col":{span:3},"wrapper-col":{span:20},layout:"horizontal"},{default:n(()=>[a(o,{label:"任务名称",name:"taskName"},{default:n(()=>[a(y,{value:l.taskName,"onUpdate:value":e[0]||(e[0]=t=>l.taskName=t),placeholder:"请输入任务名称"},null,8,["value"])]),_:1}),a(o,{label:"平台渠道",name:"channelId"},{default:n(()=>[a(v,{value:l.channelId,"onUpdate:value":e[1]||(e[1]=t=>l.channelId=t),placeholder:"请选择平台渠道"},{default:n(()=>[(s(),p(b,null,k(Q,t=>a(m,{key:t.id,value:t.id},{default:n(()=>[r(C(t.name),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1}),a(o,{label:"达人领域",name:"categoryId"},{default:n(()=>[a(v,{value:l.categoryId,"onUpdate:value":e[2]||(e[2]=t=>l.categoryId=t),placeholder:"请选择达人领域"},{default:n(()=>[(s(!0),p(b,null,k(Object.values(R(se)),t=>(s(),f(m,{key:t,value:t},{default:n(()=>[r(C(S(t)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),a(o,{label:"任务类型",name:"type"},{default:n(()=>[a(v,{value:l.type,"onUpdate:value":e[3]||(e[3]=t=>l.type=t),placeholder:"请选择任务类型"},{default:n(()=>[(s(!0),p(b,null,k(Object.values(R(re)),t=>(s(),f(m,{key:t,value:t},{default:n(()=>[r(C(z(t)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),a(o,{label:"任务奖励",name:"reward"},{default:n(()=>[a(q,{value:l.reward,"onUpdate:value":e[4]||(e[4]=t=>l.reward=t),min:0,precision:2,step:.1,placeholder:"请输入任务奖励","addon-after":"元"},null,8,["value"])]),_:1}),a(o,{label:"品牌",name:"brand"},{default:n(()=>[a(y,{value:l.brand,"onUpdate:value":e[5]||(e[5]=t=>l.brand=t),placeholder:"请输入品牌名称"},null,8,["value"])]),_:1}),a(o,{label:"指定群组",name:"groupIds"},{default:n(()=>[g("div",fe,[a(J,{value:l.groupMode,"onUpdate:value":e[6]||(e[6]=t=>l.groupMode=t),onChange:G},{default:n(()=>[a(L,{value:0},{default:n(()=>e[16]||(e[16]=[r("不指定")])),_:1}),a(L,{value:1},{default:n(()=>e[17]||(e[17]=[r("指定群组")])),_:1})]),_:1},8,["value"]),l.groupMode===1?(s(),f(v,{key:0,value:l.groupIds,"onUpdate:value":e[7]||(e[7]=t=>l.groupIds=t),mode:"multiple",placeholder:"请选择群组",style:{width:"100%","margin-top":"8px"},options:V,loading:d.groupLoading},null,8,["value","loading"])):(s(),p("div",ce," 所有群组的会员都可以接取该任务 "))])]),_:1}),a(o,{label:"自定义字段"},{default:n(()=>[g("div",_e,[(s(!0),p(b,null,k(l.customFields,(t,U)=>(s(),p("div",{key:U,class:"field-item"},[a(I,{align:"baseline"},{default:n(()=>[a(o,{name:["customFields",U,"title"],rules:[{required:!0,message:"请输入字段标题"}]},{default:n(()=>[a(y,{value:t.title,"onUpdate:value":_=>t.title=_,placeholder:"请输入字段标题"},null,8,["value","onUpdate:value"])]),_:2},1032,["name"]),a(v,{value:t.type,"onUpdate:value":_=>t.type=_,style:{width:"120px"}},{default:n(()=>[a(m,{value:"input"},{default:n(()=>e[18]||(e[18]=[r("输入框")])),_:1}),a(m,{value:"image"},{default:n(()=>e[19]||(e[19]=[r("上传图片")])),_:1})]),_:2},1032,["value","onUpdate:value"]),a(c,{type:"link",danger:"",onClick:_=>h(U)},{default:n(()=>e[20]||(e[20]=[r(" 删除 ")])),_:2},1032,["onClick"])]),_:2},1024)]))),128)),l.customFields.length<10?(s(),f(c,{key:0,type:"dashed",block:"",onClick:E},{default:n(()=>[a(R(ue)),e[21]||(e[21]=r("添加字段 "))]),_:1})):O("",!0)])]),_:1}),a(o,{label:"任务时间",required:""},{default:n(()=>[a(K,{gutter:8},{default:n(()=>[a(w,{span:11},{default:n(()=>[a(o,{name:"startTime",rules:[{required:!0,message:"请选择开始时间"}],disabled:i.value},{default:n(()=>[a(P,{value:l.startTime,"onUpdate:value":e[8]||(e[8]=t=>l.startTime=t),"show-time":"",style:{width:"100%"},placeholder:"开始时间"},null,8,["value"])]),_:1},8,["disabled"])]),_:1}),a(w,{span:2,class:"text-center"},{default:n(()=>e[22]||(e[22]=[g("span",null,"至",-1)])),_:1}),a(w,{span:11},{default:n(()=>[a(o,{name:"endTime",rules:[{required:!0,message:"请选择结束时间"}],disabled:i.value},{default:n(()=>[a(P,{value:l.endTime,"onUpdate:value":e[9]||(e[9]=t=>l.endTime=t),"show-time":"",style:{width:"100%"},placeholder:"结束时间"},null,8,["value"])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),a(o,{label:"任务名额"},{default:n(()=>[a(I,{align:"baseline"},{default:n(()=>[a(o,{name:"quota"},{default:n(()=>[a(q,{value:l.quota,"onUpdate:value":e[10]||(e[10]=t=>l.quota=t),min:0,precision:0,disabled:l.unlimitedQuota||i.value,placeholder:"请输入任务名额"},null,8,["value","disabled"])]),_:1}),a(W,{checked:l.unlimitedQuota,"onUpdate:checked":e[11]||(e[11]=t=>l.unlimitedQuota=t),disabled:i.value},{default:n(()=>e[23]||(e[23]=[r(" 不限制 ")])),_:1},8,["checked","disabled"])]),_:1})]),_:1}),a(o,{label:"粉丝要求",name:"fansRequired"},{default:n(()=>[a(q,{value:l.fansRequired,"onUpdate:value":e[12]||(e[12]=t=>l.fansRequired=t),min:0,precision:0,step:1e3,placeholder:"请输入最低粉丝数要求","addon-after":"粉丝",disabled:i.value},null,8,["value","disabled"])]),_:1}),a(o,{label:"作品要求",name:"contentRequirement"},{default:n(()=>[a(T,{value:l.contentRequirement,"onUpdate:value":e[13]||(e[13]=t=>l.contentRequirement=t),rows:4,placeholder:"请输入作品要求",disabled:i.value},null,8,["value","disabled"])]),_:1}),a(o,{label:"任务信息",name:"taskInfo"},{default:n(()=>[a(T,{value:l.taskInfo,"onUpdate:value":e[14]||(e[14]=t=>l.taskInfo=t),rows:4,placeholder:"请输入任务信息",disabled:i.value},null,8,["value","disabled"])]),_:1}),a(o,{label:"温馨提示",name:"notice"},{default:n(()=>[a(T,{value:l.notice,"onUpdate:value":e[15]||(e[15]=t=>l.notice=t),rows:4,placeholder:"请输入温馨提示",disabled:i.value},null,8,["value","disabled"])]),_:1}),i.value?O("",!0):(s(),f(o,{key:0,"wrapper-col":{span:16,offset:4}},{default:n(()=>[a(I,null,{default:n(()=>[a(c,{type:"primary",onClick:H},{default:n(()=>e[24]||(e[24]=[r("提交")])),_:1}),a(c,{onClick:$},{default:n(()=>e[25]||(e[25]=[r("取消")])),_:1})]),_:1})]),_:1}))]),_:1},8,["model"])])])}}},Ie=Y(ge,[["__scopeId","data-v-6d3a19ba"]]);export{Ie as default};

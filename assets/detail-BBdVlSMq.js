import{r as c,b as V,c as A,k as I,d as j,f as l,e as z,w as n,g as r,x as E,l as O,m as v,h as S,o as f,p as b,s as C,i as _,t as y,z as T}from"./index-C2N8CbWR.js";import{P as G}from"./PageHeader-CyoSootQ.js";import{d as H}from"./routeParamsEncryption-BKFTaOaF.js";const L={class:"content-container"},M={class:"form-container"},X={__name:"detail",setup(J){const i=E(),g=S(),k=c(),{t:$}=V(),d=c({}),m=c([]),h=c(null),B=()=>{const e=i.query.filters;e&&(h.value=H(e))},t=A({homeUrl:"",uid:"",account:"",fansCount:"",friendsCount:"",postsCount:""}),P={memberAccount:[{required:!0,message:$("member.detail.memberAccountPlaceholder")}]},q=async()=>{const e=await O("account.detail",{},{urlParams:{id:i.params.id}});e.code===0?(Object.assign(t,e.data),d.value=e.data,m.value=e.data.channelCustomFields):v.error(e.message)},p=c(!1),w=()=>{k.value.validate().then(async()=>{try{const e={};Object.keys(t).forEach(a=>{t[a]!=null&&(["account","homeUrl","uid"].includes(a)?e[a]=t[a].trim():e[a]=t[a])}),p.value=!0,await T("account.edit",e,{urlParams:{id:d.value.id}}),v.success("success"),g.back()}catch(e){console.log(e),v.error("submit failed")}finally{p.value=!1}})},D=()=>{const e={};i.query.filters&&(e.filters=i.query.filters),g.push({path:"/account",query:e})};return I(async()=>{B(),q()}),(e,a)=>{const F=r("a-avatar"),s=r("a-form-item"),u=r("a-input"),U=r("a-button"),N=r("a-space"),R=r("a-form");return f(),j("div",L,[l(G,{title:e.$t("account.detail.editTitle"),back:!0,useDefaultBack:!1,onBack:D},null,8,["title"]),z("div",M,[l(R,{ref_key:"formRef",ref:k,model:t,rules:P,"label-col":{span:6},"wrapper-col":{span:16}},{default:n(()=>[l(s,{label:e.$t("account.detail.platform"),name:"platform"},{default:n(()=>[l(F,{src:d.value.channelIcon,size:"small"},null,8,["src"]),_(" "+y(d.value.channelName),1)]),_:1},8,["label"]),l(s,{label:e.$t("account.detail.account"),name:"account"},{default:n(()=>[l(u,{value:t.account,"onUpdate:value":a[0]||(a[0]=o=>t.account=o)},null,8,["value"])]),_:1},8,["label"]),l(s,{label:e.$t("account.detail.homepage"),name:"homeUrl"},{default:n(()=>[l(u,{value:t.homeUrl,"onUpdate:value":a[1]||(a[1]=o=>t.homeUrl=o)},null,8,["value"])]),_:1},8,["label"]),l(s,{label:"UID",name:"uid"},{default:n(()=>[l(u,{value:t.uid,"onUpdate:value":a[2]||(a[2]=o=>t.uid=o)},null,8,["value"])]),_:1}),m.value.includes("fansCount")?(f(),b(s,{key:0,label:e.$t("account.detail.fansCount"),name:"fansCount"},{default:n(()=>[l(u,{value:t.fansCount,"onUpdate:value":a[3]||(a[3]=o=>t.fansCount=o)},null,8,["value"])]),_:1},8,["label"])):C("",!0),m.value.includes("friendsCount")?(f(),b(s,{key:1,label:e.$t("account.detail.friendsCount"),name:"friendsCount"},{default:n(()=>[l(u,{value:t.friendsCount,"onUpdate:value":a[4]||(a[4]=o=>t.friendsCount=o)},null,8,["value"])]),_:1},8,["label"])):C("",!0),m.value.includes("postsCount")?(f(),b(s,{key:2,label:e.$t("account.detail.postsCount"),name:"postsCount"},{default:n(()=>[l(u,{value:t.postsCount,"onUpdate:value":a[5]||(a[5]=o=>t.postsCount=o)},null,8,["value"])]),_:1},8,["label"])):C("",!0),l(s,{"wrapper-col":{offset:4}},{default:n(()=>[l(N,null,{default:n(()=>[l(U,{type:"primary",loading:p.value,onClick:w},{default:n(()=>[_(y(e.$t("common.submit")),1)]),_:1},8,["loading"]),l(U,{onClick:a[6]||(a[6]=o=>e.$router.back())},{default:n(()=>[_(y(e.$t("common.cancel")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])])}}};export{X as default};

import{_ as ue,i as ie,r as f,a as I,j as de,A as ce,k as me,v as _e,b as p,c as e,d as r,w as t,e as d,F as D,n as q,l as k,o as c,h as u,t as i,g as S,U as fe,q as w,p as R,z as G,m as y}from"./index-BwTQ22HL.js";import{P as pe}from"./PageHeader-C4OqPB1b.js";import{_ as E}from"./CopyContent-Co9InXW6.js";const ve={class:"member-view content-container"},be={class:"detail-container"},ge={class:"section"},ke={key:0},we={key:0},ye={class:"section"},xe={class:"account-list"},Ce={class:"link-text-container",style:{"max-width":"300px"}},Ie=["href"],Se={class:"section",style:{"padding-bottom":"24px"}},Re={class:"section",style:{"padding-bottom":"24px"}},he={class:"section"},Te={__name:"view",setup(Ue){const h=ie(),M=_e(),m=f(""),o=I({}),L=f([]),H=de(()=>`${ce.h5Url}?inviteCode=${o.inviteCode}`),T=I({}),U=I({}),F=I({}),N=f(),v=f(!1),x=f("grant"),_=I({amount:"",remark:""}),C=f(!1),J=f({amount:[{required:!0,message:"请输入奖励金额"}],remark:[{required:!0,message:"请输入备注"}]}),K=async()=>{const a=await k("member.detail",{},{urlParams:{id:m.value}});a.code===0&&Object.assign(o,a.data||{})},O=async()=>{const a=await k("member.balance",{},{urlParams:{memberId:m.value}});a.code===0&&(o.balance=a.data.balance)},Q=async()=>{const a=await k("account.list",{memberId:m.value});a.code===0&&(L.value=a.data.list||[])},W=async()=>{const a=await k("member.taskStats",{},{urlParams:{memberId:m.value}});a.code===0&&Object.assign(T,a.data||{})},X=async()=>{const a=await k("member.inviteStats",{},{urlParams:{memberId:m.value}});a.code===0&&Object.assign(U,a.data||{})},Y=async()=>{const a=await k("member.groupsStats",{},{urlParams:{memberId:m.value}});a.code===0&&Object.assign(F,a.data||{})},Z=()=>{v.value=!0,x.value="grant"},ee=()=>{v.value=!0,x.value="deduct"},te=async()=>{C.value=!0;try{const a=await G("member.grantReward",{memberId:m.value,amount:_.amount,remark:_.remark});a.code===0?(y.success("奖励发放成功"),v.value=!1,O()):y.error(a.message)}catch{y.error("奖励发放失败")}finally{C.value=!1}},ae=async()=>{C.value=!0;try{const a=await G("member.deductReward",{memberId:m.value,amount:_.amount,remark:_.remark},{urlParams:{memberId:m.value}});a.code===0?(y.success("奖励扣除成功"),v.value=!1,O()):y.error(a.message)}catch{y.error("奖励扣除失败")}finally{C.value=!1}},le=async()=>{switch(await N.value.validate(),x.value){case"grant":te();break;case"deduct":ae();break}};return me(()=>{m.value=M.params.id,K(),O(),Q(),W(),X(),Y()}),(a,l)=>{const s=d("a-descriptions-item"),j=d("a-avatar"),z=d("a-tag"),A=d("a-button"),B=d("a-space"),V=d("a-descriptions"),b=d("a-statistic"),g=d("a-col"),P=d("a-row"),ne=d("a-input"),$=d("a-form-item"),se=d("a-textarea"),oe=d("a-form"),re=d("a-modal");return c(),p("div",ve,[e(pe,{title:"会员详情",back:!0}),r("div",be,[r("div",ge,[l[8]||(l[8]=r("div",{class:"section-title"},"会员信息",-1)),e(V,{column:2},{default:t(()=>[e(s,{label:"会员昵称"},{default:t(()=>[u(i(o.nickname),1)]),_:1}),e(s,{label:"会员账号"},{default:t(()=>[u(i(o.account),1)]),_:1}),e(s,{label:"会员头像"},{default:t(()=>[e(j,{src:o.avatar,size:"small"},{icon:t(()=>[e(S(fe))]),_:1},8,["src"])]),_:1}),e(s,{label:"性别"},{default:t(()=>[u(i(S(h).getEnumText("GenderType",o.gender)),1)]),_:1}),e(s,{label:"职业"},{default:t(()=>[u(i(S(h).getEnumText("OccupationType",o.occupation))+" ",1),o.occupation===null?(c(),p("span",ke," - ")):w("",!0)]),_:1}),e(s,{label:"电子邮箱"},{default:t(()=>[u(i(o.email||"-"),1)]),_:1}),e(s,{label:"手机号码"},{default:t(()=>[u(i(o.phone||"-"),1)]),_:1}),e(s,{label:"Telegram"},{default:t(()=>[u(i(o.telegram||"-"),1)]),_:1}),e(s,{label:"所属群组"},{default:t(()=>[(c(!0),p(D,null,q(o.groups,n=>(c(),p("div",{key:n.id},[u(i(n.groupName)+" ",1),n.isOwner?(c(),R(z,{key:0,color:"blue",style:{"margin-left":"8px"}},{default:t(()=>l[5]||(l[5]=[u("群主")])),_:1})):w("",!0)]))),128)),!o.groups||!o.groups.length?(c(),p("span",we,"未加入群组")):w("",!0)]),_:1}),e(s,{label:"邀请人"},{default:t(()=>[u(i(o.inviterNickname||"-"),1)]),_:1}),e(s,{label:"邀请链接"},{default:t(()=>[e(E,{content:H.value},null,8,["content"])]),_:1}),e(s,{label:"账户余额"},{default:t(()=>[e(B,null,{default:t(()=>[r("span",null,i(o.balance),1),e(A,{type:"link",size:"small",onClick:l[0]||(l[0]=n=>Z())},{default:t(()=>l[6]||(l[6]=[u(" 奖励发放 ")])),_:1}),e(A,{type:"link",size:"small",onClick:l[1]||(l[1]=n=>ee())},{default:t(()=>l[7]||(l[7]=[u(" 奖励扣除 ")])),_:1})]),_:1})]),_:1})]),_:1})]),r("div",ye,[l[9]||(l[9]=r("div",{class:"section-title"},"账号信息",-1)),r("div",xe,[(c(!0),p(D,null,q(L.value,n=>(c(),p("div",{key:n.channelId},[e(V,{column:1},{default:t(()=>[e(s,{label:"账号"},{default:t(()=>[e(B,null,{default:t(()=>[e(j,{src:n.channelIcon,size:"small"},null,8,["src"]),r("span",null,i(n.account),1),e(z,{color:"warning"},{default:t(()=>[u(i(S(h).getEnumText("AccountAuditStatus",n.accountAuditStatus)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(s,{label:"主页"},{default:t(()=>[e(E,{content:n.homeUrl},{default:t(()=>[r("div",Ce,[r("a",{href:n.homeUrl,target:"_blank",class:"link-text"},i(n.homeUrl),9,Ie)])]),_:2},1032,["content"])]),_:2},1024),e(s,{label:"uid"},{default:t(()=>[e(E,{content:n.uid},null,8,["content"])]),_:2},1024),n.channelCustomFields.includes("fansCount")?(c(),R(s,{key:0,label:"粉丝数"},{default:t(()=>[u(i(n.fansCount),1)]),_:2},1024)):w("",!0),n.channelCustomFields.includes("friendsCount")?(c(),R(s,{key:1,label:"好友数"},{default:t(()=>[u(i(n.friendsCount),1)]),_:2},1024)):w("",!0),n.channelCustomFields.includes("postsCount")?(c(),R(s,{key:2,label:"发帖数"},{default:t(()=>[u(i(n.postsCount),1)]),_:2},1024)):w("",!0)]),_:2},1024)]))),128))])]),r("div",Se,[l[10]||(l[10]=r("div",{class:"section-title"},"任务信息",-1)),e(P,{gutter:16},{default:t(()=>[e(g,{span:6},{default:t(()=>[e(b,{title:"完成任务次数",value:T.completedTaskCount},null,8,["value"])]),_:1}),e(g,{span:6},{default:t(()=>[e(b,{title:"任务奖励",value:T.totalTaskReward,precision:2,prefix:"¥"},null,8,["value"])]),_:1})]),_:1})]),r("div",Re,[l[11]||(l[11]=r("div",{class:"section-title"},"邀请信息",-1)),e(P,null,{default:t(()=>[e(g,{span:6},{default:t(()=>[e(b,{title:"累计邀请",value:U.inviteCount},null,8,["value"])]),_:1}),e(g,{span:6},{default:t(()=>[e(b,{title:"邀请奖励",value:U.totalReward,prefix:"¥"},null,8,["value"])]),_:1})]),_:1})]),r("div",he,[l[12]||(l[12]=r("div",{class:"section-title"},"群组信息",-1)),e(P,null,{default:t(()=>[e(g,{span:6},{default:t(()=>[e(b,{title:"管理群数量",value:F.groupCount},null,8,["value"])]),_:1}),e(g,{span:6},{default:t(()=>[e(b,{title:"群收益",value:F.totalEarnings,prefix:"¥"},null,8,["value"])]),_:1})]),_:1})])]),e(re,{open:v.value,"onUpdate:open":l[4]||(l[4]=n=>v.value=n),title:x.value==="grant"?"奖励发放":"奖励扣除",onOk:le,confirmLoading:C.value},{default:t(()=>[e(oe,{ref_key:"rewardFormRef",ref:N,model:_,rules:J.value,"label-col":{span:6},"wrapper-col":{span:16}},{default:t(()=>[e($,{label:x.value==="grant"?"奖励金额":"扣除金额",name:"amount"},{default:t(()=>[e(ne,{value:_.amount,"onUpdate:value":l[2]||(l[2]=n=>_.amount=n)},null,8,["value"])]),_:1},8,["label"]),e($,{label:"备注",name:"remark"},{default:t(()=>[e(se,{value:_.remark,"onUpdate:value":l[3]||(l[3]=n=>_.remark=n),rows:4},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["open","title","confirmLoading"])])}}},Ee=ue(Te,[["__scopeId","data-v-47f5cd1e"]]);export{Ee as default};

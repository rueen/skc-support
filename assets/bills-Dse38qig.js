import{_ as K,b as Q,a as X,j as N,r as E,c as x,k as Z,d as o,e as T,f as i,w as s,g as r,l as ee,m as te,h as ae,o as a,F as _,n as B,p as f,i as p,t as u,s as k,q as S,M as le}from"./index-C3WC679c.js";const ne={class:"other-bill content-container"},se={class:"table-container"},ie={class:"table-header"},oe={class:"left"},ue={key:1},me={key:1},re={key:0},ce={key:1},de={key:0},pe={key:1},be={__name:"bills",setup(_e){const{t:d}=Q(),b=X(),w=ae(),H=N(()=>b.loaded?b.getEnumOptions("BillType"):[]),O=N(()=>b.loaded?b.getEnumOptions("SettlementStatus"):[]),h=E(!1),l=x({billNo:"",billType:void 0,settlementStatus:void 0,timeRange:[],taskName:""}),U=t=>{le.error({title:"结算失败原因",content:t.failureReason})},F=N(()=>[{title:d("financial.bills.billNo"),dataIndex:"billNo",key:"billNo"},{title:d("financial.bills.memberNickname"),key:"memberNickname"},{title:d("financial.bills.billType"),dataIndex:"billType",key:"billType"},{title:d("financial.bills.relatedTaskName"),key:"taskName"},{title:d("financial.bills.amount"),dataIndex:"amount",key:"amount",align:"right"},{title:d("financial.bills.remark"),key:"remark"},{title:d("financial.bills.createTime"),dataIndex:"createTime",key:"createTime"},{title:d("financial.bills.settlementStatus"),key:"settlementStatus"}]),$=E([]),y=x({current:1,pageSize:10,total:0}),C=()=>{y.current=1,g()},P=()=>{Object.assign(l,{billNo:"",billType:void 0,settlementStatus:void 0,timeRange:[],taskName:""}),C()},V=t=>{Object.assign(y,t),g()},j=t=>{w.push(`/member/view/${t.memberId}`)},z=t=>{w.push(`/submitted-tasks/detail/${t.submittedId}?type=confirm`)},g=async()=>{var t,m;h.value=!0;try{const v={page:y.current,pageSize:y.pageSize,billNo:l.billNo,billType:l.billType,settlementStatus:l.settlementStatus,startTime:(t=l.timeRange)==null?void 0:t[0],endTime:(m=l.timeRange)==null?void 0:m[1],taskName:l.taskName},c=await ee("finance.bills",{...v});c.code===0?($.value=c.data.list,y.total=c.data.total):te.error(c.message)}finally{h.value=!1}};return Z(()=>{g()}),(t,m)=>{const v=r("a-input"),c=r("a-form-item"),R=r("a-select-option"),D=r("a-select"),q=r("a-range-picker"),I=r("a-button"),L=r("a-space"),W=r("a-form"),M=r("a-typography-link"),A=r("a-typography-text"),G=r("info-circle-outlined"),J=r("a-table");return a(),o("div",ne,[T("div",se,[T("div",ie,[T("div",oe,[i(W,{layout:"inline",model:l},{default:s(()=>[i(c,{label:t.$t("financial.bills.billNo")},{default:s(()=>[i(v,{value:l.billNo,"onUpdate:value":m[0]||(m[0]=e=>l.billNo=e),placeholder:t.$t("financial.bills.billNoPlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),i(c,{label:t.$t("financial.bills.billType")},{default:s(()=>[i(D,{value:l.billType,"onUpdate:value":m[1]||(m[1]=e=>l.billType=e),placeholder:t.$t("financial.bills.billTypePlaceholder"),style:{width:"120px"},"allow-clear":""},{default:s(()=>[(a(!0),o(_,null,B(H.value,e=>(a(),f(R,{key:e.value,value:e.value},{default:s(()=>[p(u(e.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),i(c,{label:t.$t("financial.bills.settlementStatus")},{default:s(()=>[i(D,{value:l.settlementStatus,"onUpdate:value":m[2]||(m[2]=e=>l.settlementStatus=e),placeholder:t.$t("financial.bills.settlementStatusPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:s(()=>[(a(!0),o(_,null,B(O.value,e=>(a(),f(R,{key:e.value,value:e.value},{default:s(()=>[p(u(e.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),i(c,{label:t.$t("financial.bills.createTime")},{default:s(()=>[i(q,{value:l.timeRange,"onUpdate:value":m[3]||(m[3]=e=>l.timeRange=e),"show-time":{format:"HH:mm"},format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["value"])]),_:1},8,["label"]),i(c,{label:t.$t("financial.bills.taskName")},{default:s(()=>[i(v,{value:l.taskName,"onUpdate:value":m[4]||(m[4]=e=>l.taskName=e),placeholder:t.$t("financial.bills.taskNamePlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),i(c,null,{default:s(()=>[i(L,null,{default:s(()=>[i(I,{type:"primary",onClick:C},{default:s(()=>[p(u(t.$t("common.search")),1)]),_:1}),i(I,{onClick:P},{default:s(()=>[p(u(t.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),i(J,{columns:F.value,"data-source":$.value,loading:h.value,pagination:y,onChange:V},{bodyCell:s(({column:e,record:n})=>[e.key==="memberNickname"?(a(),f(M,{key:0,onClick:Y=>j(n)},{default:s(()=>[p(u(n.memberNickname),1)]),_:2},1032,["onClick"])):k("",!0),e.key==="taskName"?(a(),o(_,{key:1},[n.taskName?(a(),f(M,{key:0,onClick:Y=>z(n)},{default:s(()=>[p(u(n.taskName),1)]),_:2},1032,["onClick"])):(a(),o("span",ue,"--"))],64)):k("",!0),e.key==="billType"?(a(),o(_,{key:2},[p(u(S(b).getEnumText("BillType",n.billType)),1)],64)):k("",!0),e.key==="amount"?(a(),o(_,{key:3},[n.billType==="reward_deduction"?(a(),f(A,{key:0,type:"danger"},{default:s(()=>[p(" - "+u(n.amount),1)]),_:2},1024)):(a(),o("span",me,u(n.amount),1))],64)):k("",!0),e.key==="remark"?(a(),o(_,{key:4},[n.remark?(a(),o("span",re,u(n.remark)+"("+u(t.$t("financial.bills.operator"))+": "+u(n.waiterName)+")",1)):(a(),o("span",ce,"--"))],64)):k("",!0),e.key==="settlementStatus"?(a(),o(_,{key:5},[n.billType==="withdrawal"?(a(),o("span",de,u(S(b).getEnumText("WithdrawalStatus",n.withdrawalStatus)),1)):(a(),o("span",pe,u(S(b).getEnumText("SettlementStatus",n.settlementStatus)),1)),n.settlementStatus==="failed"||n.withdrawalStatus==="failed"?(a(),f(G,{key:2,class:"status-icon",onClick:Y=>U(n)},null,8,["onClick"])):k("",!0)],64)):k("",!0)]),_:1},8,["columns","data-source","loading","pagination"])])])}}},ye=K(be,[["__scopeId","data-v-a9b00d93"]]);export{ye as default};

import{_ as ue,i as ie,r as v,a as I,j as de,A as ce,k as me,v as pe,b as f,c as e,d as u,w as t,e as d,F as q,n as G,l as w,o as c,h as n,t as i,g as R,U as _e,q as y,p as T,m as _,z as M}from"./index-DfdbcBxU.js";import{P as ve}from"./PageHeader-Dxc7uqpX.js";const fe={class:"member-view content-container"},be={class:"detail-container"},ge={class:"section"},ke={key:0},we={key:0},ye={class:"section"},Ce={class:"account-list"},xe={class:"link-text-container"},Ie=["href"],Se={class:"section",style:{"padding-bottom":"24px"}},Re={class:"section",style:{"padding-bottom":"24px"}},Te={class:"section"},Ue={__name:"view",setup(Fe){const U=ie(),H=pe(),m=v(""),o=I({}),E=v([]),L=de(()=>`${ce.h5Url}?inviteCode=${o.inviteCode}`),F=I({}),O=I({}),P=I({}),N=v(),b=v(!1),C=v("grant"),p=I({amount:"",remark:""}),x=v(!1),J=v({amount:[{required:!0,message:"请输入奖励金额"}],remark:[{required:!0,message:"请输入备注"}]}),$=l=>{navigator.clipboard.writeText(l).then(()=>{_.success("复制成功")}).catch(()=>{_.error("复制失败")})},K=async()=>{const l=await w("member.detail",{},{urlParams:{id:m.value}});l.code===0&&Object.assign(o,l.data||{})},h=async()=>{const l=await w("member.balance",{},{urlParams:{memberId:m.value}});l.code===0&&(o.balance=l.data.balance)},Q=async()=>{const l=await w("account.list",{memberId:m.value});l.code===0&&(E.value=l.data.list||[])},W=async()=>{const l=await w("member.taskStats",{},{urlParams:{memberId:m.value}});l.code===0&&Object.assign(F,l.data||{})},X=async()=>{const l=await w("member.inviteStats",{},{urlParams:{memberId:m.value}});l.code===0&&Object.assign(O,l.data||{})},Y=async()=>{const l=await w("member.groupsStats",{},{urlParams:{memberId:m.value}});l.code===0&&Object.assign(P,l.data||{})},Z=()=>{b.value=!0,C.value="grant"},ee=()=>{b.value=!0,C.value="deduct"},te=async()=>{x.value=!0;try{const l=await M("member.grantReward",{memberId:m.value,amount:p.amount,remark:p.remark});l.code===0?(_.success("奖励发放成功"),b.value=!1,h()):_.error(l.message)}catch{_.error("奖励发放失败")}finally{x.value=!1}},ae=async()=>{x.value=!0;try{const l=await M("member.deductReward",{memberId:m.value,amount:p.amount,remark:p.remark},{urlParams:{memberId:m.value}});l.code===0?(_.success("奖励扣除成功"),b.value=!1,h()):_.error(l.message)}catch{_.error("奖励扣除失败")}finally{x.value=!1}},le=async()=>{switch(await N.value.validate(),C.value){case"grant":te();break;case"deduct":ae();break}};return me(()=>{m.value=H.params.id,K(),h(),Q(),W(),X(),Y()}),(l,a)=>{const r=d("a-descriptions-item"),j=d("a-avatar"),A=d("a-tag"),S=d("a-button"),B=d("a-space"),V=d("a-descriptions"),g=d("a-statistic"),k=d("a-col"),z=d("a-row"),se=d("a-input"),D=d("a-form-item"),ne=d("a-textarea"),oe=d("a-form"),re=d("a-modal");return c(),f("div",fe,[e(ve,{title:"会员详情",back:!0}),u("div",be,[u("div",ge,[a[10]||(a[10]=u("div",{class:"section-title"},"会员信息",-1)),e(V,{column:2},{default:t(()=>[e(r,{label:"会员昵称"},{default:t(()=>[n(i(o.nickname),1)]),_:1}),e(r,{label:"会员账号"},{default:t(()=>[n(i(o.account),1)]),_:1}),e(r,{label:"会员头像"},{default:t(()=>[e(j,{src:o.avatar,size:"small"},{icon:t(()=>[e(R(_e))]),_:1},8,["src"])]),_:1}),e(r,{label:"性别"},{default:t(()=>[n(i(R(U).getEnumText("GenderType",o.gender)),1)]),_:1}),e(r,{label:"职业"},{default:t(()=>[n(i(R(U).getEnumText("OccupationType",o.occupation))+" ",1),o.occupation===null?(c(),f("span",ke," - ")):y("",!0)]),_:1}),e(r,{label:"电子邮箱"},{default:t(()=>[n(i(o.email||"-"),1)]),_:1}),e(r,{label:"手机号码"},{default:t(()=>[n(i(o.phone||"-"),1)]),_:1}),e(r,{label:"Telegram"},{default:t(()=>[n(i(o.telegram||"-"),1)]),_:1}),e(r,{label:"所属群组"},{default:t(()=>[(c(!0),f(q,null,G(o.groups,s=>(c(),f("div",{key:s.id},[n(i(s.groupName)+" ",1),s.isOwner?(c(),T(A,{key:0,color:"blue",style:{"margin-left":"8px"}},{default:t(()=>a[6]||(a[6]=[n("群主")])),_:1})):y("",!0)]))),128)),!o.groups||!o.groups.length?(c(),f("span",we,"未加入群组")):y("",!0)]),_:1}),e(r,{label:"邀请人"},{default:t(()=>[n(i(o.inviterNickname||"-"),1)]),_:1}),e(r,{label:"邀请链接"},{default:t(()=>[u("span",null,i(L.value),1),e(S,{type:"link",size:"small",onClick:a[0]||(a[0]=s=>$(L.value))},{default:t(()=>a[7]||(a[7]=[n(" 复制 ")])),_:1})]),_:1}),e(r,{label:"账户余额"},{default:t(()=>[e(B,null,{default:t(()=>[u("span",null,i(o.balance),1),e(S,{type:"link",size:"small",onClick:a[1]||(a[1]=s=>Z())},{default:t(()=>a[8]||(a[8]=[n(" 奖励发放 ")])),_:1}),e(S,{type:"link",size:"small",onClick:a[2]||(a[2]=s=>ee())},{default:t(()=>a[9]||(a[9]=[n(" 奖励扣除 ")])),_:1})]),_:1})]),_:1})]),_:1})]),u("div",ye,[a[12]||(a[12]=u("div",{class:"section-title"},"账号信息",-1)),u("div",Ce,[(c(!0),f(q,null,G(E.value,s=>(c(),f("div",{key:s.channelId},[e(V,{column:1},{default:t(()=>[e(r,{label:"账号"},{default:t(()=>[e(B,null,{default:t(()=>[e(j,{src:s.channelIcon,size:"small"},null,8,["src"]),u("span",null,i(s.account),1),e(A,{color:"warning"},{default:t(()=>[n(i(R(U).getEnumText("AccountAuditStatus",s.accountAuditStatus)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(r,{label:"主页"},{default:t(()=>[u("div",xe,[u("a",{href:s.homeUrl,target:"_blank",class:"link-text"},i(s.homeUrl),9,Ie),e(S,{type:"link",size:"small",onClick:Oe=>$(s.homeUrl)},{default:t(()=>a[11]||(a[11]=[n(" 复制 ")])),_:2},1032,["onClick"])])]),_:2},1024),s.channelCustomFields.includes("fansCount")?(c(),T(r,{key:0,label:"粉丝数"},{default:t(()=>[n(i(s.fansCount),1)]),_:2},1024)):y("",!0),s.channelCustomFields.includes("friendsCount")?(c(),T(r,{key:1,label:"好友数"},{default:t(()=>[n(i(s.friendsCount),1)]),_:2},1024)):y("",!0),s.channelCustomFields.includes("postsCount")?(c(),T(r,{key:2,label:"发帖数"},{default:t(()=>[n(i(s.postsCount),1)]),_:2},1024)):y("",!0)]),_:2},1024)]))),128))])]),u("div",Se,[a[13]||(a[13]=u("div",{class:"section-title"},"任务信息",-1)),e(z,{gutter:16},{default:t(()=>[e(k,{span:6},{default:t(()=>[e(g,{title:"完成任务次数",value:F.completedTaskCount},null,8,["value"])]),_:1}),e(k,{span:6},{default:t(()=>[e(g,{title:"任务奖励",value:F.totalTaskReward,precision:2,prefix:"¥"},null,8,["value"])]),_:1})]),_:1})]),u("div",Re,[a[14]||(a[14]=u("div",{class:"section-title"},"邀请信息",-1)),e(z,null,{default:t(()=>[e(k,{span:6},{default:t(()=>[e(g,{title:"累计邀请",value:O.inviteCount},null,8,["value"])]),_:1}),e(k,{span:6},{default:t(()=>[e(g,{title:"邀请奖励",value:O.totalReward,prefix:"¥"},null,8,["value"])]),_:1})]),_:1})]),u("div",Te,[a[15]||(a[15]=u("div",{class:"section-title"},"群组信息",-1)),e(z,null,{default:t(()=>[e(k,{span:6},{default:t(()=>[e(g,{title:"管理群数量",value:P.groupCount},null,8,["value"])]),_:1}),e(k,{span:6},{default:t(()=>[e(g,{title:"群收益",value:P.totalEarnings,prefix:"¥"},null,8,["value"])]),_:1})]),_:1})])]),e(re,{open:b.value,"onUpdate:open":a[5]||(a[5]=s=>b.value=s),title:C.value==="grant"?"奖励发放":"奖励扣除",onOk:le,confirmLoading:x.value},{default:t(()=>[e(oe,{ref_key:"rewardFormRef",ref:N,model:p,rules:J.value,"label-col":{span:6},"wrapper-col":{span:16}},{default:t(()=>[e(D,{label:C.value==="grant"?"奖励金额":"扣除金额",name:"amount"},{default:t(()=>[e(se,{value:p.amount,"onUpdate:value":a[3]||(a[3]=s=>p.amount=s)},null,8,["value"])]),_:1},8,["label"]),e(D,{label:"备注",name:"remark"},{default:t(()=>[e(ne,{value:p.remark,"onUpdate:value":a[4]||(a[4]=s=>p.remark=s),rows:4},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["open","title","confirmLoading"])])}}},ze=ue(Ue,[["__scopeId","data-v-d2b514bc"]]);export{ze as default};

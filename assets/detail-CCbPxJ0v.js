import{_ as ae,i as se,r as T,a as N,k as le,v as ne,b as m,c as t,d as c,w as e,e as _,F as w,n as S,p as f,q as k,l as R,m as p,f as oe,o as r,t as l,h as n,g as F,z as V}from"./index-B0Ea87iG.js";import{P as de}from"./index-C0S2z7Gj.js";const re={class:"task-audit-detail content-container"},ue={class:"detail-container"},ie={key:0},ce={key:1},me={class:"detail-section"},_e={key:0},fe={class:"link-text-container"},pe=["href"],ke={class:"detail-section"},be={class:"detail-section"},ve={class:"footer-btns"},ge={class:"left"},ye={class:"right"},Ie={__name:"detail",setup(he){const A=se(),q=ne(),L=oe(),x=T(!1),P=T(!1),g=T(""),b=T(null),u=N({submitContent:{}}),i=N({}),v=N({}),z=async()=>{const o=await V("taskSubmitted.batchResolve",{ids:[b.value]});o.code===0?(p.success("审核通过成功"),y()):p.error(o.message)},B=()=>{g.value="",x.value=!0},D=async()=>{if(!g.value){p.error("请输入拒绝原因");return}P.value=!0;const o=await V("taskSubmitted.batchReject",{ids:[b.value],reason:g.value});o.code===0?(p.success("审核拒绝成功"),x.value=!1,y()):p.error(o.message)},M=()=>{L.push(`/submitted-tasks/detail/${u.prevTaskId}`),b.value=u.prevTaskId,y()},$=()=>{L.push(`/submitted-tasks/detail/${u.nextTaskId}`),b.value=u.nextTaskId,y()},H=async o=>{try{const a=await R("task.detail",{},{urlParams:{id:o}});a.code===0?Object.assign(i,a.data):p.error(a.message)}catch{p.error("获取任务详情失败")}},Q=async o=>{try{const a=await R("member.detail",{},{urlParams:{id:o}});a.code===0?Object.assign(v,a.data):p.error(a.message)}catch{p.error("获取会员详情失败")}},y=async()=>{try{const o=await R("taskSubmitted.detail",{},{urlParams:{id:b.value}});o.code===0&&(Object.assign(u,o.data),o.data.taskId!=null&&await H(o.data.taskId),o.data.memberId!=null&&await Q(o.data.memberId),o.data.taskId!=null&&o.data.memberId!=null&&await G())}catch{p.error("获取详情失败")}},E=T([]),G=async()=>{const o=await R("account.list",{taskId:u.taskId,memberId:u.memberId,channelId:i.channelId});o.code===0&&(E.value=o.data.list||[])};return le(async()=>{b.value=q.params.id,await y()}),(o,a)=>{const O=_("a-avatar"),j=_("a-space"),d=_("a-descriptions-item"),I=_("a-descriptions"),J=_("a-collapse-panel"),K=_("a-collapse"),U=_("a-tag"),h=_("a-button"),W=_("a-image"),X=_("a-textarea"),Y=_("a-modal");return r(),m("div",re,[t(de,{title:"任务审核详情",back:!0}),c("div",ue,[t(K,{ghost:"",class:"collapse"},{default:e(()=>[t(J,{header:"任务信息"},{default:e(()=>[t(I,{column:2},{default:e(()=>[t(d,{label:"任务名称"},{default:e(()=>[t(j,null,{default:e(()=>[t(O,{src:i.channelIcon,size:"small"},null,8,["src"]),c("span",null,l(i.taskName),1)]),_:1})]),_:1}),t(d,{label:"达人领域"},{default:e(()=>[n(l(i.category),1)]),_:1}),t(d,{label:"任务类型"},{default:e(()=>[n(l(F(A).getEnumText("TaskType",i.taskType)),1)]),_:1}),t(d,{label:"任务奖励"},{default:e(()=>[n(l(i.reward)+" 元",1)]),_:1}),t(d,{label:"品牌"},{default:e(()=>[n(l(i.brand),1)]),_:1}),t(d,{label:"指定群组"},{default:e(()=>{var s;return[i.groupMode===0?(r(),m("span",ie,"不指定")):(r(),m("span",ce,l((s=i.groupNames)==null?void 0:s.join("、")),1))]}),_:1}),t(d,{label:"任务时间"},{default:e(()=>[n(l(i.startTime)+" 至 "+l(i.endTime),1)]),_:1}),t(d,{label:"任务名额"},{default:e(()=>[n(l(i.unlimitedQuota?"不限制":i.quota),1)]),_:1}),t(d,{label:"粉丝要求"},{default:e(()=>[n(l(i.fansRequired)+" 粉丝",1)]),_:1}),t(d,{label:"作品要求"},{default:e(()=>[n(l(i.contentRequirement),1)]),_:1}),t(d,{label:"任务信息"},{default:e(()=>[n(l(i.taskInfo),1)]),_:1})]),_:1})]),_:1})]),_:1}),c("div",me,[a[4]||(a[4]=c("div",{class:"section-title"},"会员信息",-1)),t(I,{column:2},{default:e(()=>[t(d,{label:"会员昵称"},{default:e(()=>[n(l(v.nickname),1)]),_:1}),t(d,{label:"账号"},{default:e(()=>[n(l(v.account),1)]),_:1}),t(d,{label:"所属群"},{default:e(()=>[(r(!0),m(w,null,S(v.groups,s=>(r(),m("div",null,[c("span",null,l(s.groupName),1),s.isOwner?(r(),f(U,{key:0,color:"blue",style:{"margin-left":"10px"}},{default:e(()=>a[2]||(a[2]=[n("群主")])),_:1})):k("",!0)]))),256)),!v.groups||v.groups.length===0?(r(),m("span",_e,"--")):k("",!0)]),_:1})]),_:1}),(r(!0),m(w,null,S(E.value,s=>(r(),m("div",{key:s.channelId},[t(I,{column:2},{default:e(()=>[t(d,{label:"账号"},{default:e(()=>[t(j,null,{default:e(()=>[t(O,{src:s.channelIcon,size:"small"},null,8,["src"]),c("span",null,l(s.account),1),t(U,{color:"warning"},{default:e(()=>[n(l(F(A).getEnumText("AccountAuditStatus",s.accountAuditStatus)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(d,{label:"主页"},{default:e(()=>[c("div",fe,[c("a",{href:s.homeUrl,target:"_blank",class:"link-text"},l(s.homeUrl),9,pe),t(h,{type:"link",size:"small",onClick:C=>o.handleCopy(s.homeUrl)},{default:e(()=>a[3]||(a[3]=[n(" 复制 ")])),_:2},1032,["onClick"])])]),_:2},1024),s.channelCustomFields.includes("fansCount")?(r(),f(d,{key:0,label:"粉丝数"},{default:e(()=>[n(l(s.fansCount),1)]),_:2},1024)):k("",!0),s.channelCustomFields.includes("friendsCount")?(r(),f(d,{key:1,label:"好友数"},{default:e(()=>[n(l(s.friendsCount),1)]),_:2},1024)):k("",!0),s.channelCustomFields.includes("postsCount")?(r(),f(d,{key:2,label:"发帖数"},{default:e(()=>[n(l(s.postsCount),1)]),_:2},1024)):k("",!0)]),_:2},1024)]))),128))]),c("div",ke,[a[5]||(a[5]=c("div",{class:"section-title"},"提交信息",-1)),t(I,{column:2},{default:e(()=>{var s;return[(r(!0),m(w,null,S((s=u==null?void 0:u.submitContent)==null?void 0:s.customFields,(C,Z)=>(r(),f(d,{key:Z,label:C.title},{default:e(()=>[C.type==="image"?(r(!0),m(w,{key:0},S(C.value,(ee,te)=>(r(),f(W,{src:ee.url,width:60,key:te},null,8,["src"]))),128)):(r(),m(w,{key:1},[n(l(C.value),1)],64))]),_:2},1032,["label"]))),128))]}),_:1})]),c("div",be,[a[6]||(a[6]=c("div",{class:"section-title"},"审核信息",-1)),t(I,{column:2},{default:e(()=>[t(d,{label:"提交时间"},{default:e(()=>[n(l(u.submitTime),1)]),_:1}),t(d,{label:"审核状态"},{default:e(()=>[n(l(F(A).getEnumText("TaskAuditStatus",u.taskAuditStatus)),1)]),_:1}),u.taskAuditStatus==="rejected"?(r(),f(d,{key:0,label:"拒绝原因"},{default:e(()=>[n(l(u.rejectReason),1)]),_:1})):k("",!0)]),_:1})]),c("div",ve,[c("div",ge,[u.taskAuditStatus==="pending"?(r(),f(j,{key:0},{default:e(()=>[t(h,{type:"primary",onClick:z},{default:e(()=>a[7]||(a[7]=[n(" 审核通过 ")])),_:1}),t(h,{danger:"",onClick:B},{default:e(()=>a[8]||(a[8]=[n(" 审核拒绝 ")])),_:1})]),_:1})):k("",!0)]),c("div",ye,[t(j,null,{default:e(()=>[u.prevTaskId&&u.prevTaskId!==u.nextTaskId?(r(),f(h,{key:0,onClick:M},{default:e(()=>a[9]||(a[9]=[n("上一个")])),_:1})):k("",!0),u.nextTaskId?(r(),f(h,{key:1,onClick:$},{default:e(()=>a[10]||(a[10]=[n("下一个")])),_:1})):k("",!0)]),_:1})])])]),t(Y,{open:x.value,"onUpdate:open":a[1]||(a[1]=s=>x.value=s),title:"拒绝原因",onOk:D,confirmLoading:P.value},{default:e(()=>[t(X,{value:g.value,"onUpdate:value":a[0]||(a[0]=s=>g.value=s),placeholder:"请输入拒绝原因",rows:4},null,8,["value"])]),_:1},8,["open","confirmLoading"])])}}},we=ae(Ie,[["__scopeId","data-v-5bfa6079"]]);export{we as default};

import{_ as X,i as Y,r as w,a as N,j as Z,q as $,b as j,c as a,d,w as t,e as _,k as u,f as ee,o as m,h as s,t as o,m as f,n as y,F as L,l as te,g as I}from"./index-B2ol4n4k.js";import{P as ae}from"./index-C-HGa82N.js";import{e as R,g as E,d as se,h as oe,f as le}from"./enums-Vx4wKXVy.js";import{g as x,p as O}from"./request-CsDob0LQ.js";const ne={class:"task-audit-detail content-container"},re={class:"detail-container"},ie={class:"detail-section"},de={class:"detail-section"},ue={class:"detail-section"},ce={class:"detail-section"},me={class:"footer-btns"},_e={class:"left"},fe={class:"right"},pe={__name:"detail",setup(be){const T=$(),C=ee(),{locale:A}=Y(),k=w(!1),S=w(!1),p=w(""),c=N({}),r=N({}),b=N({}),P=l=>E(se,l,A.value),V=l=>E(le,l,A.value),q=l=>oe[l],B=async()=>{try{const l=await O("taskSubmitted.batchResolve",{ids:[T.params.id]});l.code===0?(u.success("审核通过成功"),C.back()):u.error(l.message)}catch{u.error("审核通过失败")}},M=()=>{p.value="",k.value=!0},F=async()=>{if(!p.value){u.error("请输入拒绝原因");return}try{S.value=!0;const l=await O("taskSubmitted.batchReject",{ids:[T.params.id],reason:p.value});l.code===0?(u.success("审核拒绝成功"),k.value=!1,C.back()):u.error(l.message)}catch{u.error("审核拒绝失败")}finally{S.value=!1}},G=()=>{},U=()=>{},H=async l=>{try{const e=await x("task.detail",{params:{id:l}});e.code===0?Object.assign(r,e.data):u.error(e.message)}catch{u.error("获取任务详情失败")}},J=async l=>{try{const e=await x("member.detail",{params:{id:l}});e.code===0?Object.assign(b,e.data):u.error(e.message)}catch{u.error("获取会员详情失败")}},Q=async l=>{try{const e=await x("taskSubmitted.detail",{params:{id:l}});e.code===0&&(Object.assign(c,e.data),e.data.relatedTaskId&&await H(e.data.relatedTaskId),e.data.relatedMemberId&&await J(e.data.relatedMemberId))}catch{u.error("获取详情失败")}};return Z(()=>{Q(T.params.id)}),(l,e)=>{const n=_("a-descriptions-item"),v=_("a-descriptions"),h=_("a-tag"),z=_("a-image"),g=_("a-button"),D=_("a-space"),K=_("a-textarea"),W=_("a-modal");return m(),j("div",ne,[a(ae,{title:"任务审核详情",back:!0}),d("div",re,[d("div",ie,[e[2]||(e[2]=d("div",{class:"section-title"},"任务信息",-1)),a(v,{column:2},{default:t(()=>[a(n,{label:"任务名称"},{default:t(()=>[s(o(r.taskName),1)]),_:1}),a(n,{label:"平台渠道"},{default:t(()=>[s(o(r.channelName),1)]),_:1}),a(n,{label:"达人领域"},{default:t(()=>[s(o(r.category),1)]),_:1}),a(n,{label:"任务类型"},{default:t(()=>[s(o(P(r.type)),1)]),_:1}),a(n,{label:"任务奖励"},{default:t(()=>[s(o(r.reward)+" 元",1)]),_:1}),a(n,{label:"品牌"},{default:t(()=>[s(o(r.brand),1)]),_:1}),a(n,{label:"指定群组"},{default:t(()=>{var i;return[s(o((i=r.groupNames)==null?void 0:i.join("、")),1)]}),_:1}),a(n,{label:"任务时间"},{default:t(()=>[s(o(r.startTime)+" 至 "+o(r.endTime),1)]),_:1}),a(n,{label:"任务名额"},{default:t(()=>[s(o(r.unlimitedQuota?"不限制":r.quota),1)]),_:1}),a(n,{label:"粉丝要求"},{default:t(()=>[s(o(r.fansRequired)+" 粉丝",1)]),_:1}),a(n,{label:"作品要求"},{default:t(()=>[s(o(r.contentRequirement),1)]),_:1}),a(n,{label:"任务信息"},{default:t(()=>[s(o(r.taskInfo),1)]),_:1})]),_:1})]),d("div",de,[e[4]||(e[4]=d("div",{class:"section-title"},"会员信息",-1)),a(v,{column:2},{default:t(()=>[a(n,{label:"会员名称"},{default:t(()=>[s(o(b.nickname),1)]),_:1}),a(n,{label:"账号"},{default:t(()=>[s(o(b.account),1)]),_:1}),a(n,{label:"所属群"},{default:t(()=>[s(o(b.groupName)+" ",1),b.isGroupOwner?(m(),f(h,{key:0,color:"blue"},{default:t(()=>e[3]||(e[3]=[s("群主")])),_:1})):y("",!0)]),_:1})]),_:1})]),d("div",ue,[e[5]||(e[5]=d("div",{class:"section-title"},"提交信息",-1)),a(v,{column:2},{default:t(()=>[(m(!0),j(L,null,te(r.customFields,i=>(m(),f(n,{key:i.title,label:i.title},{default:t(()=>[i.type==="image"?(m(),f(z,{key:0,src:i.value,width:120},null,8,["src"])):(m(),j(L,{key:1},[s(o(i.value),1)],64))]),_:2},1032,["label"]))),128))]),_:1})]),d("div",ce,[e[6]||(e[6]=d("div",{class:"section-title"},"审核信息",-1)),a(v,{column:2},{default:t(()=>[a(n,{label:"报名时间"},{default:t(()=>[s(o(c.applyTime),1)]),_:1}),a(n,{label:"提交时间"},{default:t(()=>[s(o(c.submitTime),1)]),_:1}),a(n,{label:"审核状态"},{default:t(()=>[a(h,{color:q(c.taskAuditStatus)},{default:t(()=>[s(o(V(c.taskAuditStatus)),1)]),_:1},8,["color"])]),_:1}),c.taskAuditStatus===I(R).REJECTED?(m(),f(n,{key:0,label:"拒绝原因"},{default:t(()=>[s(o(c.rejectReason),1)]),_:1})):y("",!0)]),_:1})]),d("div",me,[d("div",_e,[a(D,null,{default:t(()=>[c.taskAuditStatus===I(R).PENDING?(m(),f(g,{key:0,type:"primary",onClick:B},{default:t(()=>e[7]||(e[7]=[s(" 审核通过 ")])),_:1})):y("",!0),c.taskAuditStatus===I(R).PENDING?(m(),f(g,{key:1,danger:"",onClick:M},{default:t(()=>e[8]||(e[8]=[s(" 审核拒绝 ")])),_:1})):y("",!0)]),_:1})]),d("div",fe,[a(D,null,{default:t(()=>[a(g,{onClick:G},{default:t(()=>e[9]||(e[9]=[s("上一个")])),_:1}),a(g,{onClick:U},{default:t(()=>e[10]||(e[10]=[s("下一个")])),_:1})]),_:1})])])]),a(W,{open:k.value,"onUpdate:open":e[1]||(e[1]=i=>k.value=i),title:"拒绝原因",onOk:F,confirmLoading:S.value},{default:t(()=>[a(K,{value:p.value,"onUpdate:value":e[0]||(e[0]=i=>p.value=i),placeholder:"请输入拒绝原因",rows:4},null,8,["value"])]),_:1},8,["open","confirmLoading"])])}}},Te=X(pe,[["__scopeId","data-v-9f6af189"]]);export{Te as default};

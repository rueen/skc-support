import{_ as fe,i as me,j as ve,r as v,a as K,k as _e,b as d,d as i,c as l,w as n,e as r,l as j,m as _,f as ye,o as s,F as g,n as R,p as y,h as p,t as c,q as f,g as ge,z as q,M as ke}from"./index-BwTQ22HL.js";import{_ as P}from"./CopyContent-Co9InXW6.js";const he={class:"account content-container"},be={class:"table-container"},we={class:"table-header"},Se={class:"left"},Ce={class:"right"},xe={style:{"text-align":"left","margin-bottom":"16px"}},Ae={key:1,class:"account-info"},Ie={class:"link-text-container"},je=["href"],Re={class:"stats"},Ne={key:0,class:"stat-item"},Oe={key:1,class:"stat-item"},Ue={key:2,class:"stat-item"},ze={key:2},Be={class:"group-name"},Fe={__name:"list",setup(Ve){const H=ye(),N=me(),J=ve(()=>N.loaded?N.getEnumOptions("AccountAuditStatus"):[]),O=v(!1),m=v([]),w=v(!1),U=v(!1),k=v(""),u=K({keyword:"",channelId:void 0,accountAuditStatus:"pending",groupId:void 0,memberId:void 0}),F=v([]),V=v([]),E=v([]),z=[{title:"账号名称",key:"account"},{title:"账号详情",key:"accountInfo"},{title:"会员信息",key:"member"},{title:"审核状态",dataIndex:"accountAuditStatus",key:"accountAuditStatus"},{title:"审核员",key:"waiterName"}],Q=[...z,{title:"操作",key:"action"}],W=[...z,{title:"拒绝原因",key:"rejectReason"}],X={selectedRowKeys:m,onChange:a=>{m.value=a},getCheckboxProps:a=>({disabled:a.accountAuditStatus!=="pending"})},L=v([]),h=K({current:1,pageSize:10,total:0}),M=()=>{h.current=1,S()},Y=()=>{u.keyword="",u.channelId=void 0,u.accountAuditStatus=void 0,u.groupId=void 0,u.memberId=void 0,M()},Z=()=>{H.push("/account/old")},ee=a=>{Object.assign(h,{current:a.current,pageSize:a.pageSize}),S()},te=async a=>{m.value=[a.id],D()},D=async()=>{if(!m.value.length){_.warning("请选择要通过的账号");return}const a=await q("account.batchResolve",{ids:m.value});if(a.code===0){const e=a.data.failed.map(B=>B.reason).join(",");e?ke.error({title:"操作失败，失败原因",content:e}):(_.success("操作成功"),m.value=[],S())}else _.error(a.message)},ae=async()=>{if(!m.value.length){_.warning("请选择要拒绝的账号");return}k.value="",w.value=!0},ne=a=>{m.value=[a.id],k.value="",w.value=!0},le=async()=>{if(!k.value){_.error("请输入拒绝原因");return}U.value=!0;try{const a=await q("account.batchReject",{ids:m.value,rejectReason:k.value});a.code===0?(_.success("操作成功"),m.value=[],w.value=!1,S()):_.error(a.message)}catch(a){console.log(a)}finally{U.value=!1}},S=async()=>{O.value=!0;try{const a=await j("account.list",{page:h.current,pageSize:h.pageSize,...u});a.code===0?(L.value=a.data.list,h.total=a.data.total):_.error(a.message)}finally{O.value=!1}},oe=async()=>{const a=await j("channel.list");a.code===0&&(F.value=a.data.list)},T=async(a="")=>{try{const e=await j("group.list",{page:1,pageSize:50,groupName:a});e.code===0&&(V.value=e.data.list||[])}catch{_.error("获取群组列表失败")}},$=async(a="")=>{const e=await j("member.list",{page:1,pageSize:50,memberNickname:a});e.code===0&&(E.value=e.data.list||[])};return _e(()=>{S(),T(),oe(),$()}),(a,e)=>{const B=r("a-input"),b=r("a-form-item"),x=r("a-select-option"),A=r("a-select"),C=r("a-button"),I=r("a-space"),se=r("a-form"),ue=r("a-avatar"),ie=r("a-tag"),G=r("a-popconfirm"),ce=r("a-table"),de=r("a-textarea"),re=r("a-modal");return s(),d("div",he,[i("div",be,[i("div",we,[i("div",Se,[l(se,{layout:"inline",model:u},{default:n(()=>[l(b,{label:"账号"},{default:n(()=>[l(B,{value:u.keyword,"onUpdate:value":e[0]||(e[0]=t=>u.keyword=t),placeholder:"请输入账号名称 / uid","allow-clear":""},null,8,["value"])]),_:1}),l(b,{label:"平台渠道"},{default:n(()=>[l(A,{value:u.channelId,"onUpdate:value":e[1]||(e[1]=t=>u.channelId=t),placeholder:"请选择平台渠道",style:{width:"120px"},"allow-clear":""},{default:n(()=>[(s(!0),d(g,null,R(F.value,t=>(s(),y(x,{key:t.id,value:t.id},{default:n(()=>[p(c(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),l(b,{label:"审核状态"},{default:n(()=>[l(A,{value:u.accountAuditStatus,"onUpdate:value":e[2]||(e[2]=t=>u.accountAuditStatus=t),placeholder:"请选择审核状态",style:{width:"120px"},"allow-clear":""},{default:n(()=>[(s(!0),d(g,null,R(J.value,t=>(s(),y(x,{key:t.value,value:t.value},{default:n(()=>[p(c(t.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),l(b,{label:"所属群组"},{default:n(()=>[l(A,{value:u.groupId,"onUpdate:value":e[3]||(e[3]=t=>u.groupId=t),placeholder:"请选择群组",style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:T},{default:n(()=>[(s(!0),d(g,null,R(V.value,t=>(s(),y(x,{key:t.id,value:t.id},{default:n(()=>[p(c(t.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),l(b,{label:"会员"},{default:n(()=>[l(A,{value:u.memberId,"onUpdate:value":e[4]||(e[4]=t=>u.memberId=t),placeholder:"请选择会员",style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:$},{default:n(()=>[(s(!0),d(g,null,R(E.value,t=>(s(),y(x,{key:t.id,value:t.id},{default:n(()=>[p(c(t.nickname),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),l(b,null,{default:n(()=>[l(I,null,{default:n(()=>[l(C,{type:"primary",onClick:M},{default:n(()=>e[7]||(e[7]=[p("查询")])),_:1}),l(C,{onClick:Y},{default:n(()=>e[8]||(e[8]=[p("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),i("div",Ce,[l(I,null,{default:n(()=>[l(C,{type:"primary",onClick:D},{default:n(()=>e[9]||(e[9]=[p("批量通过")])),_:1}),l(C,{danger:"",onClick:ae},{default:n(()=>e[10]||(e[10]=[p("批量拒绝")])),_:1})]),_:1})])]),i("div",xe,[l(C,{onClick:Z},{default:n(()=>e[11]||(e[11]=[p("FB老账号管理")])),_:1})]),l(ce,{columns:u.accountAuditStatus==="rejected"?W:u.accountAuditStatus==="pending"?Q:z,"data-source":L.value,loading:O.value,pagination:h,"row-selection":X,rowKey:"id",onChange:ee},{bodyCell:n(({column:t,record:o})=>[t.key==="account"?(s(),y(I,{key:0},{default:n(()=>[l(ue,{src:o.channelIcon,size:"small"},null,8,["src"]),i("span",null,c(o.account),1)]),_:2},1024)):f("",!0),t.key==="accountInfo"?(s(),d("div",Ae,[i("div",null,[i("div",Ie,[e[12]||(e[12]=i("span",{class:"label"},"主页：",-1)),l(P,{content:o.homeUrl},{default:n(()=>[i("a",{href:o.homeUrl,target:"_blank",class:"link-text"},c(o.homeUrl),9,je)]),_:2},1032,["content"])])]),i("div",null,[e[13]||(e[13]=i("span",{class:"label"},"uid：",-1)),l(P,{content:o.uid},null,8,["content"])]),i("div",Re,[o.channelCustomFields.includes("fansCount")?(s(),d("div",Ne,"粉丝数："+c(o.fansCount),1)):f("",!0),o.channelCustomFields.includes("friendsCount")?(s(),d("div",Oe,"好友数："+c(o.friendsCount),1)):f("",!0),o.channelCustomFields.includes("postsCount")?(s(),d("div",Ue,"发帖数："+c(o.postsCount),1)):f("",!0)])])):f("",!0),t.key==="member"?(s(),d("div",ze,[i("div",null,c(o.memberNickname),1),i("div",Be,[i("span",null,c(o.groupName),1),o.isGroupOwner?(s(),y(ie,{key:0,color:"blue",style:{"margin-left":"10px"}},{default:n(()=>e[14]||(e[14]=[p("群主")])),_:1})):f("",!0)])])):f("",!0),t.key==="accountAuditStatus"?(s(),d(g,{key:3},[p(c(ge(N).getEnumText("AccountAuditStatus",o.accountAuditStatus)),1)],64)):f("",!0),t.key==="waiterName"?(s(),d(g,{key:4},[p(c(o.waiterName||"--"),1)],64)):f("",!0),t.key==="action"?(s(),y(I,{key:5},{default:n(()=>[o.accountAuditStatus==="pending"?(s(),y(G,{key:0,title:"确定要通过该账号吗？",onConfirm:pe=>te(o)},{default:n(()=>e[15]||(e[15]=[i("a",null,"通过",-1)])),_:2},1032,["onConfirm"])):f("",!0),o.accountAuditStatus==="pending"?(s(),y(G,{key:1,title:"确定要拒绝该账号吗？",onConfirm:pe=>ne(o)},{default:n(()=>e[16]||(e[16]=[i("a",{class:"danger"},"拒绝",-1)])),_:2},1032,["onConfirm"])):f("",!0)]),_:2},1024)):f("",!0),t.key==="rejectReason"?(s(),d(g,{key:6},[p(c(o.rejectReason),1)],64)):f("",!0)]),_:1},8,["columns","data-source","loading","pagination"])]),l(re,{open:w.value,"onUpdate:open":e[6]||(e[6]=t=>w.value=t),title:"拒绝原因",onOk:le,confirmLoading:U.value},{default:n(()=>[l(de,{value:k.value,"onUpdate:value":e[5]||(e[5]=t=>k.value=t),placeholder:"请输入拒绝原因",rows:4},null,8,["value"])]),_:1},8,["open","confirmLoading"])])}}},Me=fe(Fe,[["__scopeId","data-v-e9741f70"]]);export{Me as default};

import{_ as ae,i as te,r as T,p as le,q as ne,a as oe,j as ue,b as p,c as a,d as b,w as n,e as u,k as R,f as se,o as r,m,n as B,F as x,l as C,h as i,t as D,g as O,P as de}from"./index-CUxxoPlX.js";import{P as re}from"./index-HCny0Who.js";import{c as ie,g as pe,d as me}from"./enums-BRJzZuqT.js";import{g as fe}from"./request-BwrBeGQu.js";const ve={class:"task-form content-container"},ce={class:"form-container"},_e={class:"group-select"},ge={key:1,class:"group-tip"},be={class:"custom-fields"},ke={__name:"detail",setup(ye){const F=ne(),N=se(),{locale:Q}=te(),L=T(),d=le(()=>F.name==="TaskEdit"),t=oe({taskName:"",channelId:void 0,category:void 0,type:void 0,reward:void 0,brand:"",groupIds:[],groupMode:0,customFields:[{title:"",type:"input"}],startTime:null,endTime:null,quota:void 0,unlimitedQuota:!0,fansRequired:void 0,contentRequirement:"",taskInfo:"",notice:`1.请尽快完成发布，填写发布链接。
2.任务结束后无法填写，不能结算。
3.发布内容不符合要求，将无法审核通过。
4.填写链接无法访问或其他无关链接，视为放弃结算。`}),V={taskName:[{required:!0,message:"请输入任务名称"}],channelId:[{required:!0,message:"请选择平台渠道"}],category:[{required:!0,message:"请输入达人领域"}],type:[{required:!0,message:"请选择任务类型"}],reward:[{required:!0,message:"请输入任务奖励"}],fansRequired:[{required:!0,message:"请输入粉丝要求"}],groupIds:[{validator:(s,e)=>t.groupMode===1&&(!e||e.length===0)?Promise.reject("请选择指定群组"):Promise.resolve()}]},M=T([]),k=T(!1),j=[{id:1,name:"群组1"},{id:2,name:"群组2"},{id:3,name:"群组3"}],E=()=>{t.customFields.length<10&&t.customFields.push({title:"",type:"input"})},G=s=>{t.customFields.splice(s,1)},S=s=>pe(me,s,Q.value),z=s=>{s.target.value===0&&(t.groupIds=[])},H=()=>{L.value.validate().then(async()=>{try{submitLoading.value=!0;const s={...t,groupIds:t.groupMode===0?[]:t.groupIds};R.success("提交成功"),N.back()}catch{R.error("提交失败")}finally{submitLoading.value=!1}})},$=()=>{N.back()},A=async s=>{},J=async()=>{const s=await fe("channel.list");s.success&&(M.value=s.data.list)},K=async()=>{try{k.value=!0}catch{R.error("获取群组列表失败")}finally{k.value=!1}};return ue(()=>{J(),K(),d.value&&A(F.params.id)}),(s,e)=>{const f=u("a-input"),o=u("a-form-item"),v=u("a-select-option"),c=u("a-select"),y=u("a-input-number"),P=u("a-radio"),W=u("a-radio-group"),X=u("a-form-item-rest"),_=u("a-button"),q=u("a-space"),h=u("a-date-picker"),w=u("a-col"),Y=u("a-row"),Z=u("a-checkbox"),U=u("a-textarea"),ee=u("a-form");return r(),p("div",ve,[a(re,{title:d.value?"编辑任务":"新建任务",back:!0,class:"page-header"},null,8,["title"]),b("div",ce,[a(ee,{ref_key:"formRef",ref:L,model:t,rules:V,"label-col":{span:3},"wrapper-col":{span:20},layout:"horizontal"},{default:n(()=>[a(o,{label:"任务名称",name:"taskName"},{default:n(()=>[a(f,{value:t.taskName,"onUpdate:value":e[0]||(e[0]=l=>t.taskName=l),placeholder:"请输入任务名称"},null,8,["value"])]),_:1}),a(o,{label:"平台渠道",name:"channelId"},{default:n(()=>[a(c,{value:t.channelId,"onUpdate:value":e[1]||(e[1]=l=>t.channelId=l),placeholder:"请选择平台渠道"},{default:n(()=>[(r(!0),p(x,null,C(M.value,l=>(r(),m(v,{key:l.id,value:l.id},{default:n(()=>[i(D(l.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),a(o,{label:"达人领域",name:"category"},{default:n(()=>[a(f,{value:t.category,"onUpdate:value":e[2]||(e[2]=l=>t.category=l),placeholder:"请输入达人领域"},null,8,["value"])]),_:1}),a(o,{label:"任务类型",name:"type"},{default:n(()=>[a(c,{value:t.type,"onUpdate:value":e[3]||(e[3]=l=>t.type=l),placeholder:"请选择任务类型"},{default:n(()=>[(r(!0),p(x,null,C(Object.values(O(ie)),l=>(r(),m(v,{key:l,value:l},{default:n(()=>[i(D(S(l)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),a(o,{label:"任务奖励",name:"reward"},{default:n(()=>[a(y,{value:t.reward,"onUpdate:value":e[4]||(e[4]=l=>t.reward=l),min:0,precision:2,step:.1,placeholder:"请输入任务奖励"},null,8,["value"])]),_:1}),a(o,{label:"品牌",name:"brand"},{default:n(()=>[a(f,{value:t.brand,"onUpdate:value":e[5]||(e[5]=l=>t.brand=l),placeholder:"请输入品牌名称"},null,8,["value"])]),_:1}),a(o,{label:"指定群组",name:"groupIds"},{default:n(()=>[b("div",_e,[a(W,{value:t.groupMode,"onUpdate:value":e[6]||(e[6]=l=>t.groupMode=l),onChange:z},{default:n(()=>[a(P,{value:0},{default:n(()=>e[16]||(e[16]=[i("不指定")])),_:1}),a(P,{value:1},{default:n(()=>e[17]||(e[17]=[i("指定群组")])),_:1})]),_:1},8,["value"]),a(X,null,{default:n(()=>[t.groupMode===1?(r(),m(c,{key:0,value:t.groupIds,"onUpdate:value":e[7]||(e[7]=l=>t.groupIds=l),mode:"multiple",placeholder:"请选择群组",style:{width:"100%","margin-top":"8px"},options:j,loading:k.value},null,8,["value","loading"])):(r(),p("div",ge," 所有群组的会员都可以接取该任务 "))]),_:1})])]),_:1}),a(o,{label:"自定义字段"},{default:n(()=>[b("div",be,[(r(!0),p(x,null,C(t.customFields,(l,I)=>(r(),p("div",{key:I,class:"field-item"},[a(q,{align:"baseline"},{default:n(()=>[a(o,{name:["customFields",I,"title"],rules:[{required:!0,message:"请输入字段标题"}]},{default:n(()=>[a(f,{value:l.title,"onUpdate:value":g=>l.title=g,placeholder:"请输入字段标题"},null,8,["value","onUpdate:value"])]),_:2},1032,["name"]),a(c,{value:l.type,"onUpdate:value":g=>l.type=g,style:{width:"120px"}},{default:n(()=>[a(v,{value:"input"},{default:n(()=>e[18]||(e[18]=[i("输入框")])),_:1}),a(v,{value:"image"},{default:n(()=>e[19]||(e[19]=[i("上传图片")])),_:1})]),_:2},1032,["value","onUpdate:value"]),a(_,{type:"link",danger:"",onClick:g=>G(I)},{default:n(()=>e[20]||(e[20]=[i(" 删除 ")])),_:2},1032,["onClick"])]),_:2},1024)]))),128)),t.customFields.length<10?(r(),m(_,{key:0,type:"dashed",block:"",onClick:E},{default:n(()=>[a(O(de)),e[21]||(e[21]=i("添加字段 "))]),_:1})):B("",!0)])]),_:1}),a(o,{label:"任务时间",required:""},{default:n(()=>[a(Y,{gutter:8},{default:n(()=>[a(w,{span:11},{default:n(()=>[a(o,{name:"startTime",rules:[{required:!0,message:"请选择开始时间"}],disabled:d.value},{default:n(()=>[a(h,{value:t.startTime,"onUpdate:value":e[8]||(e[8]=l=>t.startTime=l),"show-time":"",style:{width:"100%"},placeholder:"开始时间"},null,8,["value"])]),_:1},8,["disabled"])]),_:1}),a(w,{span:2,class:"text-center"},{default:n(()=>e[22]||(e[22]=[b("span",null,"至",-1)])),_:1}),a(w,{span:11},{default:n(()=>[a(o,{name:"endTime",rules:[{required:!0,message:"请选择结束时间"}],disabled:d.value},{default:n(()=>[a(h,{value:t.endTime,"onUpdate:value":e[9]||(e[9]=l=>t.endTime=l),"show-time":"",style:{width:"100%"},placeholder:"结束时间"},null,8,["value"])]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}),a(o,{label:"任务名额"},{default:n(()=>[a(q,{align:"baseline"},{default:n(()=>[a(o,{name:"quota"},{default:n(()=>[a(y,{value:t.quota,"onUpdate:value":e[10]||(e[10]=l=>t.quota=l),min:0,precision:0,disabled:t.unlimitedQuota||d.value,placeholder:"请输入任务名额"},null,8,["value","disabled"])]),_:1}),a(Z,{checked:t.unlimitedQuota,"onUpdate:checked":e[11]||(e[11]=l=>t.unlimitedQuota=l),disabled:d.value},{default:n(()=>e[23]||(e[23]=[i(" 不限制 ")])),_:1},8,["checked","disabled"])]),_:1})]),_:1}),a(o,{label:"粉丝要求",name:"fansRequired"},{default:n(()=>[a(y,{value:t.fansRequired,"onUpdate:value":e[12]||(e[12]=l=>t.fansRequired=l),min:0,precision:0,step:1e3,placeholder:"请输入最低粉丝数要求","addon-after":"粉丝",disabled:d.value},null,8,["value","disabled"])]),_:1}),a(o,{label:"作品要求",name:"contentRequirement"},{default:n(()=>[a(U,{value:t.contentRequirement,"onUpdate:value":e[13]||(e[13]=l=>t.contentRequirement=l),rows:4,placeholder:"请输入作品要求",disabled:d.value},null,8,["value","disabled"])]),_:1}),a(o,{label:"任务信息",name:"taskInfo"},{default:n(()=>[a(U,{value:t.taskInfo,"onUpdate:value":e[14]||(e[14]=l=>t.taskInfo=l),rows:4,placeholder:"请输入任务信息",disabled:d.value},null,8,["value","disabled"])]),_:1}),a(o,{label:"温馨提示",name:"notice"},{default:n(()=>[a(U,{value:t.notice,"onUpdate:value":e[15]||(e[15]=l=>t.notice=l),rows:4,placeholder:"请输入温馨提示",disabled:d.value},null,8,["value","disabled"])]),_:1}),d.value?B("",!0):(r(),m(o,{key:0,"wrapper-col":{span:16,offset:4}},{default:n(()=>[a(q,null,{default:n(()=>[a(_,{type:"primary",onClick:H},{default:n(()=>e[24]||(e[24]=[i("提交")])),_:1}),a(_,{onClick:$},{default:n(()=>e[25]||(e[25]=[i("取消")])),_:1})]),_:1})]),_:1}))]),_:1},8,["model"])])])}}},Te=ae(ke,[["__scopeId","data-v-14dfd01e"]]);export{Te as default};

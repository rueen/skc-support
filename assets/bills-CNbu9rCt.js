import{_ as G,i as H,j as I,r as O,a as $,k as J,b as n,d as g,c as o,w as s,e as m,l as P,m as Q,f as X,o as t,F as p,n as B,p as b,h as k,t as i,q as r,g as f,K as Y,M as Z}from"./index-D-NyEYsv.js";const ee={class:"other-bill content-container"},te={class:"table-container"},ae={class:"table-header"},le={class:"left"},ne=["onClick"],se=["onClick"],oe={key:1},ie={key:1},ue={key:4},me={key:0},ce={key:1},re={__name:"bills",setup(de){const c=H(),S=X(),D=I(()=>c.loaded?c.getEnumOptions("BillType"):[]),F=I(()=>c.loaded?c.getEnumOptions("SettlementStatus"):[]),h=O(!1),u=$({memberNickname:"",billType:void 0,settlementStatus:void 0}),M=l=>{Z.error({title:"结算失败原因",content:l.failureReason})},R=[{title:"会员昵称",key:"memberNickname"},{title:"账单类型",dataIndex:"billType",key:"billType"},{title:"关联任务",key:"taskName"},{title:"金额",dataIndex:"amount",key:"amount",align:"right"},{title:"备注",key:"remark"},{title:"创建时间",dataIndex:"createTime",key:"createTime"},{title:"状态",key:"settlementStatus"}],T=O([]),d=$({current:1,pageSize:10,total:0}),w=()=>{d.current=1,v()},V=()=>{Object.assign(u,{memberNickname:"",billType:void 0,settlementStatus:void 0}),w()},j=l=>{Object.assign(d,l),v()},z=l=>{S.push(`/member/view/${l.memberId}`)},U=l=>{S.push(`/submitted-tasks/detail/${l.submittedId}`)},v=async()=>{h.value=!0;try{const l=await P("finance.bills",{page:d.current,pageSize:d.pageSize,...u});l.code===0?(T.value=l.data.list,d.total=l.data.total):Q.error(l.message)}finally{h.value=!1}};return J(()=>{v()}),(l,_)=>{const q=m("a-input"),y=m("a-form-item"),x=m("a-select-option"),C=m("a-select"),N=m("a-button"),K=m("a-space"),L=m("a-form"),W=m("a-typography-text"),A=m("a-table");return t(),n("div",ee,[g("div",te,[g("div",ae,[g("div",le,[o(L,{layout:"inline",model:u},{default:s(()=>[o(y,{label:"会员昵称"},{default:s(()=>[o(q,{value:u.memberNickname,"onUpdate:value":_[0]||(_[0]=e=>u.memberNickname=e),placeholder:"请输入会员昵称","allow-clear":""},null,8,["value"])]),_:1}),o(y,{label:"账单类型"},{default:s(()=>[o(C,{value:u.billType,"onUpdate:value":_[1]||(_[1]=e=>u.billType=e),placeholder:"请选择账单类型",style:{width:"120px"},"allow-clear":""},{default:s(()=>[(t(!0),n(p,null,B(D.value,e=>(t(),b(x,{key:e.value,value:e.value},{default:s(()=>[k(i(e.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(y,{label:"结算状态"},{default:s(()=>[o(C,{value:u.settlementStatus,"onUpdate:value":_[2]||(_[2]=e=>u.settlementStatus=e),placeholder:"请选择结算状态",style:{width:"120px"},"allow-clear":""},{default:s(()=>[(t(!0),n(p,null,B(F.value,e=>(t(),b(x,{key:e.value,value:e.value},{default:s(()=>[k(i(e.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(y,null,{default:s(()=>[o(K,null,{default:s(()=>[o(N,{type:"primary",onClick:w},{default:s(()=>[k(i(l.$t("common.search")),1)]),_:1}),o(N,{onClick:V},{default:s(()=>[k(i(l.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),o(A,{columns:R,"data-source":T.value,loading:h.value,pagination:d,onChange:j},{bodyCell:s(({column:e,record:a})=>[e.key==="memberNickname"?(t(),n("a",{key:0,onClick:E=>z(a)},i(a.memberNickname),9,ne)):r("",!0),e.key==="taskName"?(t(),n(p,{key:1},[a.taskName?(t(),n("a",{key:0,onClick:E=>U(a)},i(a.taskName),9,se)):(t(),n("span",oe,"--"))],64)):r("",!0),e.key==="billType"?(t(),n(p,{key:2},[k(i(f(c).getEnumText("BillType",a.billType)),1)],64)):r("",!0),e.key==="amount"?(t(),n(p,{key:3},[a.billType==="reward_deduction"?(t(),b(W,{key:0,type:"danger"},{default:s(()=>[k(" - "+i(a.amount),1)]),_:2},1024)):(t(),n("span",ie,i(a.amount),1))],64)):r("",!0),e.key==="remark"?(t(),n("span",ue,i(a.remark||"--"),1)):r("",!0),e.key==="settlementStatus"?(t(),n(p,{key:5},[a.billType==="withdrawal"?(t(),n("span",me,i(f(c).getEnumText("WithdrawalStatus",a.withdrawalStatus)),1)):(t(),n("span",ce,i(f(c).getEnumText("SettlementStatus",a.settlementStatus)),1)),a.settlementStatus==="failed"||a.withdrawalStatus==="failed"?(t(),b(f(Y),{key:2,class:"status-icon",onClick:E=>M(a)},null,8,["onClick"])):r("",!0)],64)):r("",!0)]),_:1},8,["data-source","loading","pagination"])])])}}},pe=G(re,[["__scopeId","data-v-16e7c815"]]);export{pe as default};

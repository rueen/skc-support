import{_ as _e,a as ye,b as ge,j as H,r as h,c as J,k as ke,d as p,e as i,f as n,w as a,g as r,l as I,m as _,h as be,o as c,F as y,n as N,p as v,i as m,t as s,s as d,q as we,A as Q,M as W}from"./index-CMj8EE3q.js";import{_ as X}from"./CopyContent-C2-FLecR.js";import{G as Ce}from"./GroupOwner-j1flnWkA.js";const Se={class:"account content-container"},$e={class:"table-container"},je={class:"table-header"},Re={class:"left"},Ae={class:"right"},Ie={style:{"text-align":"left","margin-bottom":"16px"}},Ne={key:1,class:"account-info"},Oe={class:"link-text-container"},Ue={class:"label"},ze=["href"],Pe={class:"stats"},Be={key:0,class:"stat-item"},Fe={key:1,class:"stat-item"},Me={key:2,class:"stat-item"},Ve={key:2},De={class:"danger"},Ee={__name:"list",setup(Ge){const F=be(),O=ye(),{t:g}=ge(),Y=H(()=>O.loaded?O.getEnumOptions("AccountAuditStatus"):[]),U=h(!1),f=h([]),C=h(!1),z=h(!1),k=h(""),u=J({keyword:"",channelId:void 0,accountAuditStatus:"pending",groupId:void 0,memberId:void 0}),M=h([]),V=h([]),D=h([]),Z=H(()=>[{title:g("account.list.account"),key:"account"},{title:g("account.list.accountInfo"),key:"accountInfo"},{title:g("account.list.member"),key:"member"},{title:g("account.list.auditStatus"),dataIndex:"accountAuditStatus",key:"accountAuditStatus"},{title:g("account.list.waiterName"),key:"waiterName"},{title:g("account.list.action"),key:"action"}]),x={selectedRowKeys:f,onChange:e=>{f.value=e},getCheckboxProps:e=>({disabled:e.accountAuditStatus!=="pending"})},E=h([]),b=J({current:1,pageSize:10,total:0}),G=()=>{b.current=1,S()},ee=()=>{u.keyword="",u.channelId=void 0,u.accountAuditStatus=void 0,u.groupId=void 0,u.memberId=void 0,G()},te=e=>{F.push(`/member/view/${e.memberId}`)},ae=e=>{W.error({content:e.rejectReason})},ne=()=>{F.push("/account/old")},oe=e=>{Object.assign(b,{current:e.current,pageSize:e.pageSize}),S()},le=async e=>{f.value=[e.id],L()},L=async()=>{if(!f.value.length){_.warning("请选择要通过的账号");return}const e=await Q("account.batchResolve",{ids:f.value});if(e.code===0){const o=e.data.failed.map(P=>P.reason).join(",");o?W.error({title:"操作失败，失败原因",content:o}):(_.success("操作成功"),f.value=[],S())}else _.error(e.message)},se=async()=>{if(!f.value.length){_.warning("请选择要拒绝的账号");return}k.value="",C.value=!0},ce=e=>{f.value=[e.id],k.value="",C.value=!0},ue=async()=>{if(!k.value){_.error("请输入拒绝原因");return}z.value=!0;try{const e=await Q("account.batchReject",{ids:f.value,rejectReason:k.value});e.code===0?(_.success("操作成功"),f.value=[],C.value=!1,S()):_.error(e.message)}catch(e){console.log(e)}finally{z.value=!1}},S=async()=>{U.value=!0;try{const e=await I("account.list",{page:b.current,pageSize:b.pageSize,...u});e.code===0?(E.value=e.data.list,b.total=e.data.total):_.error(e.message)}finally{U.value=!1}},ie=async()=>{const e=await I("channel.list");e.code===0&&(M.value=e.data.list)},T=async(e="")=>{try{const o=await I("group.list",{page:1,pageSize:50,groupName:e});o.code===0&&(V.value=o.data.list||[])}catch{_.error("获取群组列表失败")}},K=async(e="")=>{const o=await I("member.list",{page:1,pageSize:50,memberNickname:e});o.code===0&&(D.value=o.data.list||[])};return ke(()=>{S(),T(),ie(),K()}),(e,o)=>{const P=r("a-input"),w=r("a-form-item"),R=r("a-select-option"),A=r("a-select"),$=r("a-button"),j=r("a-space"),re=r("a-form"),de=r("a-avatar"),pe=r("a-typography-link"),me=r("info-circle-outlined"),q=r("a-popconfirm"),fe=r("a-table"),ve=r("a-textarea"),he=r("a-modal");return c(),p("div",Se,[i("div",$e,[i("div",je,[i("div",Re,[n(re,{layout:"inline",model:u},{default:a(()=>[n(w,{label:e.$t("account.search.account")},{default:a(()=>[n(P,{value:u.keyword,"onUpdate:value":o[0]||(o[0]=t=>u.keyword=t),placeholder:e.$t("account.search.accountPlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),n(w,{label:e.$t("account.search.channel")},{default:a(()=>[n(A,{value:u.channelId,"onUpdate:value":o[1]||(o[1]=t=>u.channelId=t),placeholder:e.$t("account.search.channelPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:a(()=>[(c(!0),p(y,null,N(M.value,t=>(c(),v(R,{key:t.id,value:t.id},{default:a(()=>[m(s(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),n(w,{label:e.$t("account.search.auditStatus")},{default:a(()=>[n(A,{value:u.accountAuditStatus,"onUpdate:value":o[2]||(o[2]=t=>u.accountAuditStatus=t),placeholder:e.$t("account.search.auditStatusPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:a(()=>[(c(!0),p(y,null,N(Y.value,t=>(c(),v(R,{key:t.value,value:t.value},{default:a(()=>[m(s(t.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),n(w,{label:e.$t("account.search.group")},{default:a(()=>[n(A,{value:u.groupId,"onUpdate:value":o[3]||(o[3]=t=>u.groupId=t),placeholder:e.$t("account.search.groupPlaceholder"),style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:T},{default:a(()=>[(c(!0),p(y,null,N(V.value,t=>(c(),v(R,{key:t.id,value:t.id},{default:a(()=>[m(s(t.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),n(w,{label:e.$t("account.search.member")},{default:a(()=>[n(A,{value:u.memberId,"onUpdate:value":o[4]||(o[4]=t=>u.memberId=t),placeholder:e.$t("account.search.memberPlaceholder"),style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:K},{default:a(()=>[(c(!0),p(y,null,N(D.value,t=>(c(),v(R,{key:t.id,value:t.id},{default:a(()=>[m(s(t.nickname),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),n(w,null,{default:a(()=>[n(j,null,{default:a(()=>[n($,{type:"primary",onClick:G},{default:a(()=>[m(s(e.$t("common.search")),1)]),_:1}),n($,{onClick:ee},{default:a(()=>[m(s(e.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),i("div",Ae,[n(j,null,{default:a(()=>[n($,{type:"primary",onClick:L},{default:a(()=>[m(s(e.$t("common.batchResolve")),1)]),_:1}),n($,{danger:"",onClick:se},{default:a(()=>[m(s(e.$t("common.batchReject")),1)]),_:1})]),_:1})])]),i("div",Ie,[n($,{onClick:ne},{default:a(()=>[m(s(e.$t("account.list.oldAccount")),1)]),_:1})]),n(fe,{columns:Z.value,"data-source":E.value,loading:U.value,pagination:b,"row-selection":x,rowKey:"id",onChange:oe},{bodyCell:a(({column:t,record:l})=>[t.key==="account"?(c(),v(j,{key:0},{default:a(()=>[n(de,{src:l.channelIcon,size:"small"},null,8,["src"]),i("span",null,s(l.account),1)]),_:2},1024)):d("",!0),t.key==="accountInfo"?(c(),p("div",Ne,[i("div",null,[i("div",Oe,[i("span",Ue,s(e.$t("account.list.homepage"))+"：",1),n(X,{content:l.homeUrl},{default:a(()=>[i("a",{href:l.homeUrl,target:"_blank",class:"link-text"},s(l.homeUrl),9,ze)]),_:2},1032,["content"])])]),i("div",null,[o[7]||(o[7]=i("span",{class:"label"},"uid：",-1)),n(X,{content:l.uid},null,8,["content"])]),i("div",Pe,[l.channelCustomFields.includes("fansCount")?(c(),p("div",Be,s(e.$t("account.list.fansCount"))+"："+s(l.fansCount),1)):d("",!0),l.channelCustomFields.includes("friendsCount")?(c(),p("div",Fe,s(e.$t("account.list.friendsCount"))+"："+s(l.friendsCount),1)):d("",!0),l.channelCustomFields.includes("postsCount")?(c(),p("div",Me,s(e.$t("account.list.postsCount"))+"："+s(l.postsCount),1)):d("",!0)])])):d("",!0),t.key==="member"?(c(),p("div",Ve,[n(pe,{onClick:B=>te(l)},{default:a(()=>[m(s(l.memberNickname),1)]),_:2},1032,["onClick"]),n(j,{class:"group-name"},{default:a(()=>[i("span",null,s(l.groupName),1),l.isGroupOwner?(c(),v(Ce,{key:0})):d("",!0)]),_:2},1024)])):d("",!0),t.key==="accountAuditStatus"?(c(),p(y,{key:3},[m(s(we(O).getEnumText("AccountAuditStatus",l.accountAuditStatus))+" ",1),l.accountAuditStatus==="rejected"?(c(),v(me,{key:0,class:"danger",onClick:B=>ae(l)},null,8,["onClick"])):d("",!0)],64)):d("",!0),t.key==="waiterName"?(c(),p(y,{key:4},[m(s(l.waiterName||"--"),1)],64)):d("",!0),t.key==="action"?(c(),v(j,{key:5},{default:a(()=>[l.accountAuditStatus==="pending"?(c(),v(q,{key:0,title:e.$t("account.list.resolveConfirm"),onConfirm:B=>le(l)},{default:a(()=>[i("a",null,s(e.$t("account.list.resolve")),1)]),_:2},1032,["title","onConfirm"])):d("",!0),l.accountAuditStatus==="pending"?(c(),v(q,{key:1,title:e.$t("account.list.rejectConfirm"),onConfirm:B=>ce(l)},{default:a(()=>[i("a",De,s(e.$t("account.list.reject")),1)]),_:2},1032,["title","onConfirm"])):d("",!0)]),_:2},1024)):d("",!0),t.key==="rejectReason"?(c(),p(y,{key:6},[m(s(l.rejectReason),1)],64)):d("",!0)]),_:1},8,["columns","data-source","loading","pagination"])]),n(he,{open:C.value,"onUpdate:open":o[6]||(o[6]=t=>C.value=t),title:e.$t("account.list.rejectReason"),onOk:ue,confirmLoading:z.value},{default:a(()=>[n(ve,{value:k.value,"onUpdate:value":o[5]||(o[5]=t=>k.value=t),placeholder:e.$t("account.list.rejectReasonPlaceholder"),rows:4},null,8,["value","placeholder"])]),_:1},8,["open","title","confirmLoading"])])}}},qe=_e(Ee,[["__scopeId","data-v-6a161a23"]]);export{qe as default};

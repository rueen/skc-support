import{P as X}from"./PageHeader-CVkuYvO3.js";import{_ as Z,b as x,r as g,c as R,x as aa,j as ta,k as ea,d as b,f as t,e as S,w as e,g as l,l as na,m as q,o as h,i as d,t as i,s as _,p as $,F as Y,M as sa,A as oa}from"./index-BWKDvxYJ.js";const ra={class:"payment-transactions content-container"},la={class:"table-container"},ia={class:"table-header"},da={__name:"payment-transactions",setup(ca){const{t:o}=x(),H=aa(),k=g(!1),s=R({transactionStatus:void 0,memberId:"",orderId:"",withdrawalId:H.query.withdrawalId,timeRange:[]}),v=g(!1),N=g({}),C=g(""),F=ta(()=>[{title:o("withdrawal.transactions.orderId"),dataIndex:"orderId",key:"orderId"},{title:o("withdrawal.transactions.withdrawalId"),dataIndex:"withdrawalId",key:"withdrawalId"},{title:o("withdrawal.transactions.amount"),dataIndex:"amount",key:"amount",align:"right"},{title:o("withdrawal.transactions.account"),dataIndex:"account",key:"account"},{title:o("withdrawal.transactions.requestParams"),key:"requestParams",align:"center"},{title:o("withdrawal.transactions.responseData"),key:"responseData",align:"center"},{title:o("withdrawal.transactions.transactionStatus"),key:"transactionStatus",align:"center"},{title:o("withdrawal.transactions.requestTime"),dataIndex:"requestTime",key:"requestTime"},{title:o("withdrawal.transactions.responseTime"),dataIndex:"responseTime",key:"responseTime"},{title:o("withdrawal.transactions.action"),key:"action",width:100,align:"center"}]),D=g([]),c=R({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0}),U=a=>({pending:o("withdrawal.transactions.pending"),success:o("withdrawal.transactions.success"),failed:o("withdrawal.transactions.failed")})[a]||a,V=a=>({pending:"blue",success:"green",failed:"red"})[a]||"default",j=a=>!a&&a!==0?"--":`¥ ${Number(a).toFixed(2)}`,M=()=>{c.current=1,y()},B=()=>{Object.assign(s,{transactionStatus:void 0,memberId:"",orderId:"",withdrawalId:"",timeRange:[]}),M()},J=a=>{c.current=a.current,c.pageSize=a.pageSize,y()},T=a=>{N.value=a,C.value=JSON.stringify(a,null,2),v.value=!0},A=a=>{sa.info({title:o("withdrawal.transactions.errorInfo"),content:a.errorMessage})},E=async a=>{try{const n=await oa("withdrawals.retry",{},{urlParams:{orderId:a.orderId}});y()}catch(n){console.error("重试失败:",n)}},y=async()=>{var a,n;k.value=!0;try{const u={page:c.current,pageSize:c.pageSize,transactionStatus:s.transactionStatus,memberId:s.memberId,orderId:s.orderId,withdrawalId:s.withdrawalId,startDate:(a=s.timeRange)==null?void 0:a[0],endDate:(n=s.timeRange)==null?void 0:n[1]},p=await na("withdrawals.paymentTransactions",u);p.code===0?(D.value=p.data.list||[],c.total=p.data.total||0):q.error(p.message)}catch(u){console.error("加载数据失败:",u),q.error(o("withdrawal.transactions.loadDataFailed"))}finally{k.value=!1}};return ea(()=>{y()}),(a,n)=>{const u=l("a-select-option"),p=l("a-select"),f=l("a-form-item"),z=l("a-input"),O=l("a-range-picker"),m=l("a-button"),P=l("a-space"),K=l("a-form"),Q=l("a-tag"),G=l("a-table"),L=l("a-typography"),W=l("a-modal");return h(),b("div",ra,[t(X,{title:a.$t("withdrawal.transactions.pageTitle"),back:!0,style:{"margin-bottom":"32px",padding:"0"}},null,8,["title"]),S("div",la,[S("div",ia,[t(K,{layout:"inline",model:s},{default:e(()=>[t(f,{label:a.$t("withdrawal.transactions.transactionStatus")},{default:e(()=>[t(p,{value:s.transactionStatus,"onUpdate:value":n[0]||(n[0]=r=>s.transactionStatus=r),placeholder:a.$t("withdrawal.transactions.transactionStatusPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:e(()=>[t(u,{value:"pending"},{default:e(()=>[d(i(a.$t("withdrawal.transactions.pending")),1)]),_:1}),t(u,{value:"success"},{default:e(()=>[d(i(a.$t("withdrawal.transactions.success")),1)]),_:1}),t(u,{value:"failed"},{default:e(()=>[d(i(a.$t("withdrawal.transactions.failed")),1)]),_:1})]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),t(f,{label:a.$t("withdrawal.transactions.orderId")},{default:e(()=>[t(z,{value:s.orderId,"onUpdate:value":n[1]||(n[1]=r=>s.orderId=r),placeholder:a.$t("withdrawal.transactions.orderIdPlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),t(f,{label:a.$t("withdrawal.transactions.withdrawalId")},{default:e(()=>[t(z,{value:s.withdrawalId,"onUpdate:value":n[2]||(n[2]=r=>s.withdrawalId=r),placeholder:a.$t("withdrawal.transactions.withdrawalIdPlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),t(f,{label:a.$t("withdrawal.transactions.transactionTime")},{default:e(()=>[t(O,{value:s.timeRange,"onUpdate:value":n[3]||(n[3]=r=>s.timeRange=r),"show-time":{format:"HH:mm"},format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["value"])]),_:1},8,["label"]),t(f,null,{default:e(()=>[t(P,null,{default:e(()=>[t(m,{type:"primary",onClick:M},{default:e(()=>[d(i(a.$t("common.search")),1)]),_:1}),t(m,{onClick:B},{default:e(()=>[d(i(a.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),t(G,{columns:F.value,"data-source":D.value,loading:k.value,pagination:c,onChange:J,rowKey:"id"},{bodyCell:e(({column:r,record:w})=>[r.key==="transactionStatus"?(h(),b(Y,{key:0},[t(Q,{color:V(w.transactionStatus)},{default:e(()=>[d(i(U(w.transactionStatus)),1)]),_:2},1032,["color"]),t(m,{type:"link",size:"small",onClick:I=>A(w)},{default:e(()=>[d(i(a.$t("withdrawal.transactions.view")),1)]),_:2},1032,["onClick"])],64)):_("",!0),r.key==="amount"?(h(),b(Y,{key:1},[d(i(j(w.amount)),1)],64)):_("",!0),r.key==="requestParams"?(h(),$(m,{key:2,type:"link",size:"small",onClick:I=>T(w.requestParams)},{default:e(()=>[d(i(a.$t("withdrawal.transactions.view")),1)]),_:2},1032,["onClick"])):_("",!0),r.key==="responseData"?(h(),$(m,{key:3,type:"link",size:"small",onClick:I=>T(w.responseData)},{default:e(()=>[d(i(a.$t("withdrawal.transactions.view")),1)]),_:2},1032,["onClick"])):_("",!0),r.key==="action"?(h(),$(P,{key:4},{default:e(()=>[t(m,{type:"link",size:"small",onClick:I=>E(w)},{default:e(()=>[d(i(a.$t("withdrawal.transactions.retry")),1)]),_:2},1032,["onClick"])]),_:2},1024)):_("",!0)]),_:1},8,["columns","data-source","loading","pagination"])]),t(W,{open:v.value,"onUpdate:open":n[4]||(n[4]=r=>v.value=r),title:a.$t("withdrawal.transactions.dataDetails"),width:"800px",footer:null},{default:e(()=>[t(L,null,{default:e(()=>[S("pre",null,i(C.value),1)]),_:1})]),_:1},8,["open","title"])])}}},pa=Z(da,[["__scopeId","data-v-74ceed7d"]]);export{pa as default};

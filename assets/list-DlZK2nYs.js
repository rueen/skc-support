import{_ as fe,i as ve,a as he,j as I,r as v,b as H,k as _e,c as r,d as i,e as o,w as a,f as p,l as N,m as h,g as ye,o as u,F as g,n as O,p as _,h as m,t as l,s as d,q as ge,A as J,M as ke}from"./index-CmSkOvrl.js";import{_ as Q}from"./CopyContent-Dik8qGE8.js";import{G as be}from"./GroupOwner-ClflEnz0.js";const we={class:"account content-container"},Ce={class:"table-container"},Se={class:"table-header"},$e={class:"left"},je={class:"right"},Ae={style:{"text-align":"left","margin-bottom":"16px"}},Re={key:1,class:"account-info"},Ie={class:"link-text-container"},Ne={class:"label"},Oe=["href"],Ue={class:"stats"},ze={key:0,class:"stat-item"},Pe={key:1,class:"stat-item"},Be={key:2,class:"stat-item"},Fe={key:2},Ve={class:"danger"},Ee={__name:"list",setup(Ge){const W=ye(),U=ve(),{t:y}=he(),X=I(()=>U.loaded?U.getEnumOptions("AccountAuditStatus"):[]),z=v(!1),f=v([]),C=v(!1),P=v(!1),k=v(""),c=H({keyword:"",channelId:void 0,accountAuditStatus:"pending",groupId:void 0,memberId:void 0}),V=v([]),E=v([]),G=v([]),B=I(()=>[{title:y("account.list.account"),key:"account"},{title:y("account.list.accountInfo"),key:"accountInfo"},{title:y("account.list.member"),key:"member"},{title:y("account.list.auditStatus"),dataIndex:"accountAuditStatus",key:"accountAuditStatus"},{title:y("account.list.waiterName"),key:"waiterName"}]),Y=I(()=>[...B.value,{title:y("account.list.action"),key:"action"}]),Z=I(()=>[...B.value,{title:y("account.list.rejectReason"),key:"rejectReason"}]),x={selectedRowKeys:f,onChange:e=>{f.value=e},getCheckboxProps:e=>({disabled:e.accountAuditStatus!=="pending"})},L=v([]),b=H({current:1,pageSize:10,total:0}),M=()=>{b.current=1,S()},ee=()=>{c.keyword="",c.channelId=void 0,c.accountAuditStatus=void 0,c.groupId=void 0,c.memberId=void 0,M()},te=()=>{W.push("/account/old")},ae=e=>{Object.assign(b,{current:e.current,pageSize:e.pageSize}),S()},ne=async e=>{f.value=[e.id],D()},D=async()=>{if(!f.value.length){h.warning("请选择要通过的账号");return}const e=await J("account.batchResolve",{ids:f.value});if(e.code===0){const n=e.data.failed.map(F=>F.reason).join(",");n?ke.error({title:"操作失败，失败原因",content:n}):(h.success("操作成功"),f.value=[],S())}else h.error(e.message)},oe=async()=>{if(!f.value.length){h.warning("请选择要拒绝的账号");return}k.value="",C.value=!0},le=e=>{f.value=[e.id],k.value="",C.value=!0},se=async()=>{if(!k.value){h.error("请输入拒绝原因");return}P.value=!0;try{const e=await J("account.batchReject",{ids:f.value,rejectReason:k.value});e.code===0?(h.success("操作成功"),f.value=[],C.value=!1,S()):h.error(e.message)}catch(e){console.log(e)}finally{P.value=!1}},S=async()=>{z.value=!0;try{const e=await N("account.list",{page:b.current,pageSize:b.pageSize,...c});e.code===0?(L.value=e.data.list,b.total=e.data.total):h.error(e.message)}finally{z.value=!1}},ue=async()=>{const e=await N("channel.list");e.code===0&&(V.value=e.data.list)},T=async(e="")=>{try{const n=await N("group.list",{page:1,pageSize:50,groupName:e});n.code===0&&(E.value=n.data.list||[])}catch{h.error("获取群组列表失败")}},K=async(e="")=>{const n=await N("member.list",{page:1,pageSize:50,memberNickname:e});n.code===0&&(G.value=n.data.list||[])};return _e(()=>{S(),T(),ue(),K()}),(e,n)=>{const F=p("a-input"),w=p("a-form-item"),A=p("a-select-option"),R=p("a-select"),$=p("a-button"),j=p("a-space"),ce=p("a-form"),ie=p("a-avatar"),q=p("a-popconfirm"),re=p("a-table"),de=p("a-textarea"),pe=p("a-modal");return u(),r("div",we,[i("div",Ce,[i("div",Se,[i("div",$e,[o(ce,{layout:"inline",model:c},{default:a(()=>[o(w,{label:e.$t("account.search.account")},{default:a(()=>[o(F,{value:c.keyword,"onUpdate:value":n[0]||(n[0]=t=>c.keyword=t),placeholder:e.$t("account.search.accountPlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),o(w,{label:e.$t("account.search.channel")},{default:a(()=>[o(R,{value:c.channelId,"onUpdate:value":n[1]||(n[1]=t=>c.channelId=t),placeholder:e.$t("account.search.channelPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:a(()=>[(u(!0),r(g,null,O(V.value,t=>(u(),_(A,{key:t.id,value:t.id},{default:a(()=>[m(l(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),o(w,{label:e.$t("account.search.auditStatus")},{default:a(()=>[o(R,{value:c.accountAuditStatus,"onUpdate:value":n[2]||(n[2]=t=>c.accountAuditStatus=t),placeholder:e.$t("account.search.auditStatusPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:a(()=>[(u(!0),r(g,null,O(X.value,t=>(u(),_(A,{key:t.value,value:t.value},{default:a(()=>[m(l(t.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),o(w,{label:e.$t("account.search.group")},{default:a(()=>[o(R,{value:c.groupId,"onUpdate:value":n[3]||(n[3]=t=>c.groupId=t),placeholder:e.$t("account.search.groupPlaceholder"),style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:T},{default:a(()=>[(u(!0),r(g,null,O(E.value,t=>(u(),_(A,{key:t.id,value:t.id},{default:a(()=>[m(l(t.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),o(w,{label:e.$t("account.search.member")},{default:a(()=>[o(R,{value:c.memberId,"onUpdate:value":n[4]||(n[4]=t=>c.memberId=t),placeholder:e.$t("account.search.memberPlaceholder"),style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:K},{default:a(()=>[(u(!0),r(g,null,O(G.value,t=>(u(),_(A,{key:t.id,value:t.id},{default:a(()=>[m(l(t.nickname),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),o(w,null,{default:a(()=>[o(j,null,{default:a(()=>[o($,{type:"primary",onClick:M},{default:a(()=>[m(l(e.$t("common.search")),1)]),_:1}),o($,{onClick:ee},{default:a(()=>[m(l(e.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),i("div",je,[o(j,null,{default:a(()=>[o($,{type:"primary",onClick:D},{default:a(()=>[m(l(e.$t("common.batchResolve")),1)]),_:1}),o($,{danger:"",onClick:oe},{default:a(()=>[m(l(e.$t("common.batchReject")),1)]),_:1})]),_:1})])]),i("div",Ae,[o($,{onClick:te},{default:a(()=>[m(l(e.$t("account.list.oldAccount")),1)]),_:1})]),o(re,{columns:c.accountAuditStatus==="rejected"?Z.value:c.accountAuditStatus==="pending"?Y.value:B.value,"data-source":L.value,loading:z.value,pagination:b,"row-selection":x,rowKey:"id",onChange:ae},{bodyCell:a(({column:t,record:s})=>[t.key==="account"?(u(),_(j,{key:0},{default:a(()=>[o(ie,{src:s.channelIcon,size:"small"},null,8,["src"]),i("span",null,l(s.account),1)]),_:2},1024)):d("",!0),t.key==="accountInfo"?(u(),r("div",Re,[i("div",null,[i("div",Ie,[i("span",Ne,l(e.$t("account.list.homepage"))+"：",1),o(Q,{content:s.homeUrl},{default:a(()=>[i("a",{href:s.homeUrl,target:"_blank",class:"link-text"},l(s.homeUrl),9,Oe)]),_:2},1032,["content"])])]),i("div",null,[n[7]||(n[7]=i("span",{class:"label"},"uid：",-1)),o(Q,{content:s.uid},null,8,["content"])]),i("div",Ue,[s.channelCustomFields.includes("fansCount")?(u(),r("div",ze,l(e.$t("account.list.fansCount"))+"："+l(s.fansCount),1)):d("",!0),s.channelCustomFields.includes("friendsCount")?(u(),r("div",Pe,l(e.$t("account.list.friendsCount"))+"："+l(s.friendsCount),1)):d("",!0),s.channelCustomFields.includes("postsCount")?(u(),r("div",Be,l(e.$t("account.list.postsCount"))+"："+l(s.postsCount),1)):d("",!0)])])):d("",!0),t.key==="member"?(u(),r("div",Fe,[i("div",null,l(s.memberNickname),1),o(j,{class:"group-name"},{default:a(()=>[i("span",null,l(s.groupName),1),s.isGroupOwner?(u(),_(be,{key:0})):d("",!0)]),_:2},1024)])):d("",!0),t.key==="accountAuditStatus"?(u(),r(g,{key:3},[m(l(ge(U).getEnumText("AccountAuditStatus",s.accountAuditStatus)),1)],64)):d("",!0),t.key==="waiterName"?(u(),r(g,{key:4},[m(l(s.waiterName||"--"),1)],64)):d("",!0),t.key==="action"?(u(),_(j,{key:5},{default:a(()=>[s.accountAuditStatus==="pending"?(u(),_(q,{key:0,title:e.$t("account.list.resolveConfirm"),onConfirm:me=>ne(s)},{default:a(()=>[i("a",null,l(e.$t("account.list.resolve")),1)]),_:2},1032,["title","onConfirm"])):d("",!0),s.accountAuditStatus==="pending"?(u(),_(q,{key:1,title:e.$t("account.list.rejectConfirm"),onConfirm:me=>le(s)},{default:a(()=>[i("a",Ve,l(e.$t("account.list.reject")),1)]),_:2},1032,["title","onConfirm"])):d("",!0)]),_:2},1024)):d("",!0),t.key==="rejectReason"?(u(),r(g,{key:6},[m(l(s.rejectReason),1)],64)):d("",!0)]),_:1},8,["columns","data-source","loading","pagination"])]),o(pe,{open:C.value,"onUpdate:open":n[6]||(n[6]=t=>C.value=t),title:e.$t("account.list.rejectReason"),onOk:se,confirmLoading:P.value},{default:a(()=>[o(de,{value:k.value,"onUpdate:value":n[5]||(n[5]=t=>k.value=t),placeholder:e.$t("account.list.rejectReasonPlaceholder"),rows:4},null,8,["value","placeholder"])]),_:1},8,["open","title","confirmLoading"])])}}},Te=fe(Ee,[["__scopeId","data-v-a0393b71"]]);export{Te as default};

import{_ as be,a as we,b as Ce,j as Q,r as g,c as W,k as $e,d as h,e as i,f as o,w as a,g as d,l as N,m,h as Se,o as u,F as S,n as T,p as _,i as p,t as l,s as f,q as Ae,M as B,A as X,v as Ie}from"./index-CnAgtw8Q.js";import{_ as Y}from"./CopyContent-yytmumLX.js";import{G as Re}from"./GroupOwner-C_8rtegh.js";import{d as je}from"./download-B7xG4M-g.js";const Oe={class:"account content-container"},Ne={class:"table-container"},Te={class:"table-header"},Pe={style:{width:"100%",display:"flex","justify-content":"space-between"}},Ue={class:"right"},De={key:0,class:"account-info"},Ee={class:"link-text-container"},ze={class:"label"},Fe=["href"],Be={class:"stats"},Me={key:0,class:"stat-item"},Le={key:1,class:"stat-item"},Ve={key:2,class:"stat-item"},Ge={key:1},Ke={class:"danger"},qe=["onClick"],He={class:"danger"},Je={__name:"list",setup(Qe){const P=Se(),U=we(),{t:r}=Ce(),Z=Q(()=>U.loaded?U.getEnumOptions("AccountAuditStatus"):[]),D=g(!1),v=g([]),A=g(!1),E=g(!1),b=g(""),c=W({keyword:"",channelId:void 0,accountAuditStatus:"pending",groupId:void 0,memberId:void 0}),M=g([]),L=g([]),V=g([]),x=Q(()=>[{title:r("account.list.accountInfo"),key:"accountInfo",width:500},{title:r("account.list.memberInfo"),key:"member"},{title:r("account.list.submitTime"),dataIndex:"submitTime",key:"submitTime"},{title:r("account.list.auditStatus"),dataIndex:"accountAuditStatus",key:"accountAuditStatus"},{title:r("account.list.waiterName"),key:"waiterName"},{title:r("account.list.action"),key:"action"}]),ee={selectedRowKeys:v,onChange:e=>{v.value=e},getCheckboxProps:e=>({disabled:e.accountAuditStatus!=="pending"})},z=g([]),w=W({current:1,pageSize:10,total:0}),G=()=>{w.current=1,C()},te=()=>{c.keyword="",c.channelId=void 0,c.accountAuditStatus=void 0,c.groupId=void 0,c.memberId=void 0,G()},ae=e=>{P.push(`/member/view/${e.memberId}`)},ne=e=>{P.push({name:"AccountEdit",params:{id:e.id}})},oe=e=>{B.error({content:e.rejectReason})},le=()=>{P.push("/account/old")},se=e=>{Object.assign(w,{current:e.current,pageSize:e.pageSize}),C()},ce=async e=>{v.value=[e.id],K()},K=async()=>{if(!v.value.length){m.warning(r("account.list.message.selectAccount"));return}const e=await X("account.batchResolve",{ids:v.value});if(e.code===0){const n=e.data.failed.map(k=>k.reason).join(",");n?B.error({title:r("account.list.batchRejectFailedTitle"),content:n}):(m.success(r("account.list.message.success")),v.value=[],C())}else m.error(e.message)},ue=async()=>{if(!v.value.length){m.warning(r("account.list.message.selectAccount"));return}b.value="",A.value=!0},ie=e=>{v.value=[e.id],b.value="",A.value=!0},re=async()=>{if(!b.value){m.error(r("account.list.message.rejectReason"));return}E.value=!0;try{const e=await X("account.batchReject",{ids:v.value,rejectReason:b.value});e.code===0?(m.success(r("account.list.message.success")),v.value=[],A.value=!1,C()):m.error(e.message)}catch(e){console.log(e)}finally{E.value=!1}},C=async()=>{D.value=!0;try{const e=await N("account.list",{page:w.current,pageSize:w.pageSize,...c});e.code===0?(z.value=e.data.list,w.total=e.data.total):m.error(e.message)}finally{D.value=!1}},de=async()=>{const e=await N("channel.list");e.code===0&&(M.value=e.data.list)},q=async(e="")=>{try{const n=await N("group.list",{page:1,pageSize:50,groupName:e});n.code===0&&(L.value=n.data.list||[])}catch{m.error("获取群组列表失败")}},H=async(e="")=>{const n=await N("member.list",{page:1,pageSize:50,memberNickname:e});n.code===0&&(V.value=n.data.list||[])},me=async e=>{const n=await Ie("account.delete",{},{urlParams:{id:e.id}});n.code===0?(m.success(n.message),C()):m.error(n.message)},pe=()=>{B.confirm({title:r("common.export"),content:r("common.confirmExportContent"),onOk:async()=>{var e,n;try{const k=m.loading(r("common.exporting"),0),y={taskName:c.taskName,channelId:c.channelId,taskPreAuditStatus:c.taskPreAuditStatus,groupId:c.groupId,submitStartTime:(e=c.submitTimeRange)==null?void 0:e[0],submitEndTime:(n=c.submitTimeRange)==null?void 0:n[1],completedTaskCount:c.completedTaskCount};await je("account.export",y,`账号列表_${new Date().toLocaleDateString()}.xlsx`),k(),m.success(r("common.exportSuccess"))}catch(k){console.error("导出失败:",k),m.error(r("common.exportFailed"))}}})};return $e(()=>{C(),q(),de(),H()}),(e,n)=>{const k=d("a-input"),y=d("a-form-item"),j=d("a-select-option"),O=d("a-select"),$=d("a-button"),I=d("a-space"),fe=d("a-form"),he=d("DownloadOutlined"),ve=d("a-avatar"),J=d("a-typography-link"),_e=d("info-circle-outlined"),F=d("a-popconfirm"),ge=d("a-table"),ye=d("a-textarea"),ke=d("a-modal");return u(),h("div",Oe,[i("div",Ne,[i("div",Te,[o(fe,{layout:"inline",model:c},{default:a(()=>[o(y,{label:e.$t("account.search.account")},{default:a(()=>[o(k,{value:c.keyword,"onUpdate:value":n[0]||(n[0]=t=>c.keyword=t),placeholder:e.$t("account.search.accountPlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),o(y,{label:e.$t("account.search.channel")},{default:a(()=>[o(O,{value:c.channelId,"onUpdate:value":n[1]||(n[1]=t=>c.channelId=t),placeholder:e.$t("account.search.channelPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:a(()=>[(u(!0),h(S,null,T(M.value,t=>(u(),_(j,{key:t.id,value:t.id},{default:a(()=>[p(l(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),o(y,{label:e.$t("account.search.auditStatus")},{default:a(()=>[o(O,{value:c.accountAuditStatus,"onUpdate:value":n[2]||(n[2]=t=>c.accountAuditStatus=t),placeholder:e.$t("account.search.auditStatusPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:a(()=>[(u(!0),h(S,null,T(Z.value,t=>(u(),_(j,{key:t.value,value:t.value},{default:a(()=>[p(l(t.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),o(y,{label:e.$t("account.search.group")},{default:a(()=>[o(O,{value:c.groupId,"onUpdate:value":n[3]||(n[3]=t=>c.groupId=t),placeholder:e.$t("account.search.groupPlaceholder"),style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:q},{default:a(()=>[(u(!0),h(S,null,T(L.value,t=>(u(),_(j,{key:t.id,value:t.id},{default:a(()=>[p(l(t.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),o(y,{label:e.$t("account.search.member")},{default:a(()=>[o(O,{value:c.memberId,"onUpdate:value":n[4]||(n[4]=t=>c.memberId=t),placeholder:e.$t("account.search.memberPlaceholder"),style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:H},{default:a(()=>[(u(!0),h(S,null,T(V.value,t=>(u(),_(j,{key:t.id,value:t.id},{default:a(()=>[p(l(t.nickname),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),o(y,null,{default:a(()=>[o(I,null,{default:a(()=>[o($,{type:"primary",onClick:G},{default:a(()=>[p(l(e.$t("common.search")),1)]),_:1}),o($,{onClick:te},{default:a(()=>[p(l(e.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),i("div",Pe,[o($,{onClick:le},{default:a(()=>[p(l(e.$t("account.list.oldAccount")),1)]),_:1}),i("div",Ue,[o(I,null,{default:a(()=>[z.value.length?(u(),_($,{key:0,onClick:pe},{icon:a(()=>[o(he)]),default:a(()=>[p(" "+l(e.$t("common.export")),1)]),_:1})):f("",!0),o($,{type:"primary",onClick:K},{default:a(()=>[p(l(e.$t("common.batchResolve")),1)]),_:1}),o($,{danger:"",onClick:ue},{default:a(()=>[p(l(e.$t("common.batchReject")),1)]),_:1})]),_:1})])])]),o(ge,{columns:x.value,"data-source":z.value,loading:D.value,pagination:w,"row-selection":ee,rowKey:"id",onChange:se},{bodyCell:a(({column:t,record:s})=>[t.key==="accountInfo"?(u(),h("div",De,[o(I,null,{default:a(()=>[o(ve,{src:s.channelIcon,size:"small"},null,8,["src"]),i("span",null,l(s.account),1)]),_:2},1024),i("div",null,[i("div",Ee,[i("span",ze,l(e.$t("account.list.homepage"))+"：",1),o(Y,{content:s.homeUrl},{default:a(()=>[o(J,null,{default:a(()=>[i("a",{href:s.homeUrl,target:"_blank"},l(s.homeUrl),9,Fe)]),_:2},1024)]),_:2},1032,["content"])])]),i("div",null,[n[7]||(n[7]=i("span",{class:"label"},"uid：",-1)),o(Y,{content:s.uid},null,8,["content"])]),i("div",Be,[s.channelCustomFields.includes("fansCount")?(u(),h("div",Me,l(e.$t("account.list.fansCount"))+"："+l(s.fansCount),1)):f("",!0),s.channelCustomFields.includes("friendsCount")?(u(),h("div",Le,l(e.$t("account.list.friendsCount"))+"："+l(s.friendsCount),1)):f("",!0),s.channelCustomFields.includes("postsCount")?(u(),h("div",Ve,l(e.$t("account.list.postsCount"))+"："+l(s.postsCount),1)):f("",!0)])])):f("",!0),t.key==="member"?(u(),h("div",Ge,[i("div",null,[o(J,{onClick:R=>ae(s)},{default:a(()=>[p(l(s.memberNickname),1)]),_:2},1032,["onClick"])]),o(I,{class:"group-name"},{default:a(()=>[i("span",null,l(s.groupName),1),s.isGroupOwner?(u(),_(Re,{key:0})):f("",!0)]),_:2},1024)])):f("",!0),t.key==="accountAuditStatus"?(u(),h(S,{key:2},[p(l(Ae(U).getEnumText("AccountAuditStatus",s.accountAuditStatus))+" ",1),s.accountAuditStatus==="rejected"?(u(),_(_e,{key:0,class:"danger",onClick:R=>oe(s)},null,8,["onClick"])):f("",!0)],64)):f("",!0),t.key==="waiterName"?(u(),h(S,{key:3},[p(l(s.waiterName||"--"),1)],64)):f("",!0),t.key==="action"?(u(),_(I,{key:4},{default:a(()=>[s.accountAuditStatus==="pending"?(u(),_(F,{key:0,title:e.$t("account.list.resolveConfirm"),onConfirm:R=>ce(s)},{default:a(()=>[i("a",null,l(e.$t("account.list.resolve")),1)]),_:2},1032,["title","onConfirm"])):f("",!0),s.accountAuditStatus==="pending"?(u(),_(F,{key:1,title:e.$t("account.list.rejectConfirm"),onConfirm:R=>ie(s)},{default:a(()=>[i("a",Ke,l(e.$t("account.list.reject")),1)]),_:2},1032,["title","onConfirm"])):f("",!0),i("a",{onClick:R=>ne(s)},l(e.$t("common.edit")),9,qe),o(F,{title:e.$t("common.deleteConfirm"),onConfirm:R=>me(s)},{default:a(()=>[i("a",He,l(e.$t("common.delete")),1)]),_:2},1032,["title","onConfirm"])]),_:2},1024)):f("",!0)]),_:1},8,["columns","data-source","loading","pagination"])]),o(ke,{open:A.value,"onUpdate:open":n[6]||(n[6]=t=>A.value=t),title:e.$t("account.list.rejectReason"),onOk:re,confirmLoading:E.value},{default:a(()=>[o(ye,{value:b.value,"onUpdate:value":n[5]||(n[5]=t=>b.value=t),placeholder:e.$t("account.list.rejectReasonPlaceholder"),rows:4},null,8,["value","placeholder"])]),_:1},8,["open","title","confirmLoading"])])}}},xe=be(Je,[["__scopeId","data-v-336a724a"]]);export{xe as default};

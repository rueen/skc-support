import{_ as ie,i as de,r as p,a as h,j as ce,A as me,k as _e,v as pe,b as f,c as e,d as o,w as t,e as d,F as D,n as M,l as v,o as m,g as S,U as fe,t as u,h as i,q as k,p as R,z as q,m as y}from"./index-CvG11GSV.js";import{P as ve}from"./PageHeader-Dk08bGaZ.js";import{_ as N}from"./CopyContent-Bk3a83QI.js";const be={class:"member-view content-container"},ge={class:"detail-container"},we={class:"section"},ke={key:0},ye={key:0},Ce={class:"section"},xe={class:"account-list"},he={class:"link-text-container",style:{"max-width":"300px"}},Ie=["href"],Se={class:"section",style:{"padding-bottom":"24px"}},Re={class:"section",style:{"padding-bottom":"24px"}},Te={class:"section"},Ae={__name:"view",setup(Ue){const T=de(),G=pe(),c=p(""),s=h({}),E=p([]),H=ce(()=>`${me.h5Url}?inviteCode=${s.inviteCode}`),A=h({}),U=h({}),P=h({}),L=p(),b=p(!1),C=p("grant"),_=h({amount:"",remark:""}),x=p(!1),W=p({amount:[{required:!0,message:"请输入奖励金额"}],remark:[{required:!0,message:"请输入备注"}]}),J=async()=>{const a=await v("member.detail",{},{urlParams:{id:c.value}});a.code===0&&Object.assign(s,a.data||{})},F=async()=>{const a=await v("member.balance",{},{urlParams:{memberId:c.value}});a.code===0&&(s.balance=a.data.balance)},K=async()=>{const a=await v("member.withdrawalsAccount",{},{urlParams:{memberId:c.value}});a.code===0&&(s.withdrawalsAccount=a.data[0]||{})},Q=async()=>{const a=await v("account.list",{memberId:c.value});a.code===0&&(E.value=a.data.list||[])},X=async()=>{const a=await v("member.taskStats",{},{urlParams:{memberId:c.value}});a.code===0&&Object.assign(A,a.data||{})},Y=async()=>{const a=await v("member.inviteStats",{},{urlParams:{memberId:c.value}});a.code===0&&Object.assign(U,a.data||{})},Z=async()=>{const a=await v("member.groupsStats",{},{urlParams:{memberId:c.value}});a.code===0&&Object.assign(P,a.data||{})},ee=()=>{b.value=!0,C.value="grant"},te=()=>{b.value=!0,C.value="deduct"},ae=async()=>{x.value=!0;try{const a=await q("member.grantReward",{memberId:c.value,amount:_.amount,remark:_.remark});a.code===0?(y.success("奖励发放成功"),b.value=!1,F()):y.error(a.message)}catch{y.error("奖励发放失败")}finally{x.value=!1}},le=async()=>{x.value=!0;try{const a=await q("member.deductReward",{memberId:c.value,amount:_.amount,remark:_.remark},{urlParams:{memberId:c.value}});a.code===0?(y.success("奖励扣除成功"),b.value=!1,F()):y.error(a.message)}catch{y.error("奖励扣除失败")}finally{x.value=!1}},ne=async()=>{switch(await L.value.validate(),C.value){case"grant":ae();break;case"deduct":le();break}};return _e(()=>{c.value=G.params.id,J(),F(),Q(),X(),Y(),Z(),K()}),(a,l)=>{const j=d("a-avatar"),I=d("a-space"),r=d("a-descriptions-item"),z=d("a-tag"),B=d("a-button"),V=d("a-descriptions"),g=d("a-statistic"),w=d("a-col"),O=d("a-row"),se=d("a-input"),$=d("a-form-item"),oe=d("a-textarea"),re=d("a-form"),ue=d("a-modal");return m(),f("div",be,[e(ve,{title:"会员详情",back:!0}),o("div",ge,[o("div",we,[l[8]||(l[8]=o("div",{class:"section-title"},"会员信息",-1)),e(V,{column:2},{default:t(()=>[e(r,{label:"会员昵称"},{default:t(()=>[e(I,null,{default:t(()=>[e(j,{src:s.avatar,size:"small"},{icon:t(()=>[e(S(fe))]),_:1},8,["src"]),o("span",null,u(s.nickname),1)]),_:1})]),_:1}),e(r,{label:"会员账号"},{default:t(()=>[i(u(s.account),1)]),_:1}),e(r,{label:"性别"},{default:t(()=>[i(u(S(T).getEnumText("GenderType",s.gender)),1)]),_:1}),e(r,{label:"职业"},{default:t(()=>[i(u(S(T).getEnumText("OccupationType",s.occupation))+" ",1),s.occupation===null?(m(),f("span",ke," - ")):k("",!0)]),_:1}),e(r,{label:"电子邮箱"},{default:t(()=>[i(u(s.email||"-"),1)]),_:1}),e(r,{label:"手机号码"},{default:t(()=>[i(u(s.phone||"-"),1)]),_:1}),e(r,{label:"Telegram"},{default:t(()=>[i(u(s.telegram||"-"),1)]),_:1}),e(r,{label:"所属群组"},{default:t(()=>[(m(!0),f(D,null,M(s.groups,n=>(m(),f("div",{key:n.id},[i(u(n.groupName)+" ",1),n.isOwner?(m(),R(z,{key:0,color:"blue",style:{"margin-left":"8px"}},{default:t(()=>l[5]||(l[5]=[i("群主")])),_:1})):k("",!0)]))),128)),!s.groups||!s.groups.length?(m(),f("span",ye,"未加入群组")):k("",!0)]),_:1}),e(r,{label:"邀请人"},{default:t(()=>[i(u(s.inviterNickname||"-"),1)]),_:1}),e(r,{label:"邀请链接"},{default:t(()=>[e(N,{content:H.value},null,8,["content"])]),_:1}),e(r,{label:"提现账号"},{default:t(()=>[e(I,null,{default:t(()=>[o("span",null,u(s.withdrawalsAccount.paymentChannelName),1),o("span",null,u(s.withdrawalsAccount.account||"-"),1)]),_:1})]),_:1}),e(r,{label:"账户余额"},{default:t(()=>[e(I,null,{default:t(()=>[o("span",null,u(s.balance),1),e(B,{type:"link",size:"small",onClick:l[0]||(l[0]=n=>ee())},{default:t(()=>l[6]||(l[6]=[i(" 奖励发放 ")])),_:1}),e(B,{type:"link",size:"small",onClick:l[1]||(l[1]=n=>te())},{default:t(()=>l[7]||(l[7]=[i(" 奖励扣除 ")])),_:1})]),_:1})]),_:1})]),_:1})]),o("div",Ce,[l[9]||(l[9]=o("div",{class:"section-title"},"账号信息",-1)),o("div",xe,[(m(!0),f(D,null,M(E.value,n=>(m(),f("div",{key:n.channelId},[e(V,{column:1},{default:t(()=>[e(r,{label:"账号"},{default:t(()=>[e(I,null,{default:t(()=>[e(j,{src:n.channelIcon,size:"small"},null,8,["src"]),o("span",null,u(n.account),1),e(z,{color:"warning"},{default:t(()=>[i(u(S(T).getEnumText("AccountAuditStatus",n.accountAuditStatus)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(r,{label:"主页"},{default:t(()=>[e(N,{content:n.homeUrl},{default:t(()=>[o("div",he,[o("a",{href:n.homeUrl,target:"_blank",class:"link-text"},u(n.homeUrl),9,Ie)])]),_:2},1032,["content"])]),_:2},1024),e(r,{label:"uid"},{default:t(()=>[e(N,{content:n.uid},null,8,["content"])]),_:2},1024),n.channelCustomFields.includes("fansCount")?(m(),R(r,{key:0,label:"粉丝数"},{default:t(()=>[i(u(n.fansCount),1)]),_:2},1024)):k("",!0),n.channelCustomFields.includes("friendsCount")?(m(),R(r,{key:1,label:"好友数"},{default:t(()=>[i(u(n.friendsCount),1)]),_:2},1024)):k("",!0),n.channelCustomFields.includes("postsCount")?(m(),R(r,{key:2,label:"发帖数"},{default:t(()=>[i(u(n.postsCount),1)]),_:2},1024)):k("",!0)]),_:2},1024)]))),128))])]),o("div",Se,[l[10]||(l[10]=o("div",{class:"section-title"},"任务信息",-1)),e(O,{gutter:16},{default:t(()=>[e(w,{span:6},{default:t(()=>[e(g,{title:"完成任务次数",value:A.completedTaskCount},null,8,["value"])]),_:1}),e(w,{span:6},{default:t(()=>[e(g,{title:"任务奖励",value:A.totalTaskReward,precision:2,prefix:"¥"},null,8,["value"])]),_:1})]),_:1})]),o("div",Re,[l[11]||(l[11]=o("div",{class:"section-title"},"邀请信息",-1)),e(O,null,{default:t(()=>[e(w,{span:6},{default:t(()=>[e(g,{title:"累计邀请",value:U.inviteCount},null,8,["value"])]),_:1}),e(w,{span:6},{default:t(()=>[e(g,{title:"邀请奖励",value:U.totalReward,prefix:"¥"},null,8,["value"])]),_:1})]),_:1})]),o("div",Te,[l[12]||(l[12]=o("div",{class:"section-title"},"群组信息",-1)),e(O,null,{default:t(()=>[e(w,{span:6},{default:t(()=>[e(g,{title:"管理群数量",value:P.groupCount},null,8,["value"])]),_:1}),e(w,{span:6},{default:t(()=>[e(g,{title:"群收益",value:P.totalEarnings,prefix:"¥"},null,8,["value"])]),_:1})]),_:1})])]),e(ue,{open:b.value,"onUpdate:open":l[4]||(l[4]=n=>b.value=n),title:C.value==="grant"?"奖励发放":"奖励扣除",onOk:ne,confirmLoading:x.value},{default:t(()=>[e(re,{ref_key:"rewardFormRef",ref:L,model:_,rules:W.value,"label-col":{span:6},"wrapper-col":{span:16}},{default:t(()=>[e($,{label:C.value==="grant"?"奖励金额":"扣除金额",name:"amount"},{default:t(()=>[e(se,{value:_.amount,"onUpdate:value":l[2]||(l[2]=n=>_.amount=n)},null,8,["value"])]),_:1},8,["label"]),e($,{label:"备注",name:"remark"},{default:t(()=>[e(oe,{value:_.remark,"onUpdate:value":l[3]||(l[3]=n=>_.remark=n),rows:4},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["open","title","confirmLoading"])])}}},Ne=ie(Ae,[["__scopeId","data-v-0b4cbca8"]]);export{Ne as default};

import{_ as P,r,a as R,j as $,k as j,b as z,d as i,c as n,w as s,e as o,l as A,o as I,h as F,p as G,q as H,s as J,m as d,y as Q,z as S}from"./index-D7zbyf1Z.js";const W={class:"channel content-container"},X={class:"table-container"},Y={class:"table-header"},Z={class:"right"},ee=["onClick"],ae={__name:"payment-channels",setup(te){const v=r(!1),c=r(!1),_=r(!1),u=r("add"),k=r(),e=R({name:"",bank:"",merchantId:"",secretKey:""}),y=r(),g={name:[{required:!0,message:"请输入支付渠道名称"}],bank:[{required:!0,message:"请输入银行名称"}],merchantId:[{required:!0,message:"请输入商户ID"}]},C=[{title:"渠道名称",dataIndex:"name",key:"name"},{title:"银行名称",dataIndex:"bank",key:"bank",width:100},{title:"商户ID",dataIndex:"merchantId",key:"merchantId",width:100},{title:"更新时间",dataIndex:"updateTime",key:"updateTime"},{title:"操作",key:"action",width:200}],b=r([]),w=$(()=>({add:"添加支付渠道",edit:"编辑支付渠道"})[u.value]),x=()=>{u.value="add",e.name="",e.bank="",e.merchantId="",e.secretKey="",c.value=!0},D=t=>{u.value="edit",y.value=t.id,e.name=t.name,e.bank=t.bank,e.merchantId=t.merchantId,e.secretKey=null,c.value=!0},K=async t=>{try{const a=await J("paymentChannels.delete",{},{urlParams:{id:t.id}});a.code===0?(d.success("删除成功"),m()):d.error(a.message)}catch{d.error("删除失败")}},T=async()=>{if(!e.secretKey){d.error("请输入密钥");return}const t=await S("paymentChannels.add",e);t.code===0?(d.success("添加成功"),c.value=!1,m()):d.error(t.message)},U=async()=>{const t=await Q("paymentChannels.edit",{...e,id:y.value},{urlParams:{id:y.value}});t.code===0?(d.success("编辑成功"),c.value=!1,m()):d.error(t.message)},V=async()=>{try{switch(await k.value.validate(),_.value=!0,u.value){case"add":T();break;case"edit":U();break}}catch(t){console.error(t)}finally{_.value=!1}},m=async()=>{v.value=!0;try{const t=await A("paymentChannels.list");b.value=t.data}finally{v.value=!1}};return j(()=>{m()}),(t,a)=>{const q=o("a-button"),B=o("a-popconfirm"),N=o("a-space"),L=o("a-table"),p=o("a-input"),f=o("a-form-item"),E=o("a-form"),M=o("a-modal");return I(),z("div",W,[i("div",X,[i("div",Y,[a[6]||(a[6]=i("div",{class:"left"},null,-1)),i("div",Z,[n(q,{type:"primary",onClick:x},{default:s(()=>a[5]||(a[5]=[F(" 添加支付渠道 ")])),_:1})])]),n(L,{columns:C,"data-source":b.value,loading:v.value,pagination:!1},{bodyCell:s(({column:l,record:h})=>[l.key==="action"?(I(),G(N,{key:0},{default:s(()=>[i("a",{onClick:O=>D(h)},"编辑",8,ee),n(B,{title:"确定要删除该渠道吗？",onConfirm:O=>K(h)},{default:s(()=>a[7]||(a[7]=[i("a",{class:"danger"},"删除",-1)])),_:2},1032,["onConfirm"])]),_:2},1024)):H("",!0)]),_:1},8,["data-source","loading"])]),n(M,{open:c.value,"onUpdate:open":a[4]||(a[4]=l=>c.value=l),title:w.value,confirmLoading:_.value,onOk:V},{default:s(()=>[n(E,{ref_key:"formRef",ref:k,model:e,rules:g,"label-col":{span:6},"wrapper-col":{span:16}},{default:s(()=>[n(f,{label:"支付渠道名称",name:"name"},{default:s(()=>[n(p,{value:e.name,"onUpdate:value":a[0]||(a[0]=l=>e.name=l),placeholder:"请输入支付渠道名称"},null,8,["value"])]),_:1}),n(f,{label:"银行名称",name:"bank"},{default:s(()=>[n(p,{value:e.bank,"onUpdate:value":a[1]||(a[1]=l=>e.bank=l),placeholder:"请输入银行名称"},null,8,["value"])]),_:1}),n(f,{label:"商户ID",name:"merchantId"},{default:s(()=>[n(p,{value:e.merchantId,"onUpdate:value":a[2]||(a[2]=l=>e.merchantId=l),placeholder:"请输入商户ID"},null,8,["value"])]),_:1}),n(f,{label:"密钥",name:"secretKey"},{default:s(()=>[n(p,{value:e.secretKey,"onUpdate:value":a[3]||(a[3]=l=>e.secretKey=l),placeholder:"请输入密钥"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title","confirmLoading"])])}}},le=P(ae,[["__scopeId","data-v-0c74ad72"]]);export{le as default};

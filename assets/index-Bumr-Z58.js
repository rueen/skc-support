import{_ as P,r as i,a as x,m as $,n as j,b as F,d as c,c as o,w as n,e as s,p as G,j as r,o as h,h as H,s as J,v as K,x as Q,A as W,B as X}from"./index-DNEypZzq.js";const Y={class:"article content-container"},Z={class:"table-container"},ee={class:"table-header"},te={class:"right"},ae=["onClick"],oe={class:"editor-wrapper"},le={__name:"index",setup(ne){const f=i(!1),d=i(!1),u=i(!1),m=i("add"),y=i(),v=i(null),a=x({title:"",location:"",content:""}),C={title:[{required:!0,message:"请输入文章标题"}],location:[{required:!0,message:"请输入location"}],content:[{required:!0,message:"请输入文章内容"}]},B=[{title:"文章标题",dataIndex:"title",key:"title"},{title:"更新时间",dataIndex:"updateTime",key:"updateTime"},{title:"操作",key:"action",width:100}],b=i([]),p=x({current:1,pageSize:10,total:0}),T=$(()=>({add:"添加文章",edit:"编辑文章"})[m.value]),V=async e=>{try{const t=await Q("article.delete",{id:e.id},{urlParams:{id:e.id}});t.code===0?(r.success("删除成功"),_()):r.error(t.message)}catch(t){console.error(t)}},z=()=>{m.value="add",a.title="",a.location="",a.content="",d.value=!0},A=e=>{m.value="edit",a.title=e.title,a.location=e.location,a.content=e.content,d.value=!0,v.value=e.id},D=async()=>{u.value=!0;try{const e=await X("article.add",{...a});e.code===0?(r.success("添加成功"),d.value=!1,_()):r.error(e.message)}catch(e){console.error(e)}finally{u.value=!1}},I=async()=>{u.value=!0;try{const e=await W("article.edit",{id:v.value,...a},{urlParams:{id:v.value}});e.code===0?(r.success("保存成功"),d.value=!1,_()):r.error(e.message)}catch(e){console.error(e)}finally{u.value=!1}},N=async()=>{switch(await y.value.validate(),m.value){case"add":await D();break;case"edit":await I();break}},_=async()=>{f.value=!0;try{const e=await G("article.list",{page:p.current,pageSize:p.pageSize});e.code===0?(b.value=e.data.list,p.total=e.data.total):r.error(e.message)}finally{f.value=!1}};return j(()=>{_()}),(e,t)=>{const R=s("a-button"),U=s("a-popconfirm"),q=s("a-space"),L=s("a-table"),k=s("a-input"),g=s("a-form-item"),S=s("a-textarea"),E=s("a-form"),M=s("a-modal");return h(),F("div",Y,[c("div",Z,[c("div",ee,[t[5]||(t[5]=c("div",{class:"left"},null,-1)),c("div",te,[o(R,{type:"primary",onClick:z},{default:n(()=>t[4]||(t[4]=[H(" 添加文章 ")])),_:1})])]),o(L,{columns:B,"data-source":b.value,loading:f.value,pagination:p},{bodyCell:n(({column:l,record:w})=>[l.key==="action"?(h(),J(q,{key:0},{default:n(()=>[c("a",{onClick:O=>A(w)},"编辑",8,ae),o(U,{title:"确定要删除该文章吗？",onConfirm:O=>V(w)},{default:n(()=>t[6]||(t[6]=[c("a",{class:"danger"},"删除",-1)])),_:2},1032,["onConfirm"])]),_:2},1024)):K("",!0)]),_:1},8,["data-source","loading","pagination"])]),o(M,{open:d.value,"onUpdate:open":t[3]||(t[3]=l=>d.value=l),title:T.value,width:800,confirmLoading:u.value,onOk:N},{default:n(()=>[o(E,{ref_key:"formRef",ref:y,model:a,rules:C,"label-col":{span:4},"wrapper-col":{span:19}},{default:n(()=>[o(g,{label:"文章标题",name:"title"},{default:n(()=>[o(k,{value:a.title,"onUpdate:value":t[0]||(t[0]=l=>a.title=l),placeholder:"请输入文章标题"},null,8,["value"])]),_:1}),o(g,{label:"location",name:"location"},{default:n(()=>[o(k,{value:a.location,"onUpdate:value":t[1]||(t[1]=l=>a.location=l),placeholder:"英文字母、数字（不要以数字开头）、下划线"},null,8,["value"])]),_:1}),o(g,{label:"文章内容",name:"content"},{default:n(()=>[c("div",oe,[o(S,{value:a.content,"onUpdate:value":t[2]||(t[2]=l=>a.content=l),placeholder:"请输入文章内容","auto-size":{minRows:10,maxRows:20}},null,8,["value"])])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title","confirmLoading"])])}}},ie=P(le,[["__scopeId","data-v-afdb56c3"]]);export{ie as default};

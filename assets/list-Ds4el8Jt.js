import{_ as ie,l as re,m as de,r as m,a as $,n as pe,b as v,d as c,c as o,w as n,e as i,p as z,j as r,o as l,F as w,q as N,s as g,h as _,t as d,v as p,g as ve,B}from"./index-Cjbrjdx8.js";const _e={class:"account content-container"},fe={class:"table-container"},me={class:"table-header"},ge={class:"left"},ye={class:"right"},he={key:1,class:"account-info"},ke={class:"home-url"},Ce={class:"link-text-container"},Se=["href"],be={class:"stats"},we={key:0,class:"stat-item"},xe={key:1,class:"stat-item"},Ae={key:2,class:"stat-item"},Re={key:2},je={class:"group-name"},Ie={__name:"list",setup(Oe){const A=re(),G=de(()=>A.loaded?A.getEnumOptions("AccountAuditStatus"):[]),R=m(!1),f=m([]),C=m(!1),j=m(!1),y=m(""),u=$({account:"",channelId:void 0,accountAuditStatus:"pending",groupId:void 0}),F=m([]),V=m([]),I=[{title:"账号名称",key:"account"},{title:"账号详情",key:"accountInfo"},{title:"会员信息",key:"member"},{title:"审核状态",dataIndex:"accountAuditStatus",key:"accountAuditStatus"}],q=[...I,{title:"操作",key:"action"}],M=[...I,{title:"拒绝原因",key:"rejectReason"}],E=m([]),h=$({current:1,pageSize:10,total:0}),H=t=>{f.value=t},L=()=>{h.current=1,k()},J=()=>{u.account="",u.channelId=void 0,u.accountAuditStatus=void 0,u.groupId=void 0,L()},P=t=>{Object.assign(h,{current:t.current,pageSize:t.pageSize}),k()},Q=async t=>{try{const e=await B("account.batchResolve",{ids:[t.id]});e.code===0?(r.success("操作成功"),k()):r.error(e.message)}catch(e){console.log(e)}},W=async()=>{if(!f.value.length){r.warning("请选择要通过的账号");return}try{const t=await B("account.batchResolve",{ids:f.value});t.code===0?(r.success("操作成功"),f.value=[],k()):r.error(t.message)}catch(t){console.log(t)}},X=async()=>{if(!f.value.length){r.warning("请选择要拒绝的账号");return}y.value="",C.value=!0},Y=t=>{f.value=[t.id],y.value="",C.value=!0},Z=async()=>{if(!y.value){r.error("请输入拒绝原因");return}j.value=!0;try{const t=await B("account.batchReject",{ids:f.value,rejectReason:y.value});t.code===0?(r.success("操作成功"),f.value=[],C.value=!1,k()):r.error(t.message)}catch(t){console.log(t)}finally{j.value=!1}},k=async()=>{R.value=!0;try{const t=await z("account.list",{page:h.current,pageSize:h.pageSize,...u});t.code===0?(E.value=t.data.list,h.total=t.data.total):r.error(t.message)}finally{R.value=!1}},ee=async()=>{const t=await z("channel.list");t.code===0&&(F.value=t.data.list)},T=async(t="")=>{try{const e=await z("group.list",{page:1,pageSize:50,groupName:t});e.code===0&&(V.value=e.data.list||[])}catch{r.error("获取群组列表失败")}},te=t=>{navigator.clipboard.writeText(t).then(()=>{r.success("复制成功")}).catch(()=>{r.error("复制失败")})};return pe(()=>{k(),T(),ee()}),(t,e)=>{const ae=i("a-input"),S=i("a-form-item"),O=i("a-select-option"),U=i("a-select"),b=i("a-button"),x=i("a-space"),ne=i("a-form"),oe=i("a-avatar"),se=i("a-tag"),D=i("a-popconfirm"),le=i("a-table"),ue=i("a-textarea"),ce=i("a-modal");return l(),v("div",_e,[c("div",fe,[c("div",me,[c("div",ge,[o(ne,{layout:"inline",model:u},{default:n(()=>[o(S,{label:"账号"},{default:n(()=>[o(ae,{value:u.account,"onUpdate:value":e[0]||(e[0]=a=>u.account=a),placeholder:"请输入账号","allow-clear":""},null,8,["value"])]),_:1}),o(S,{label:"平台渠道"},{default:n(()=>[o(U,{value:u.channelId,"onUpdate:value":e[1]||(e[1]=a=>u.channelId=a),placeholder:"请选择平台渠道",style:{width:"120px"},"allow-clear":""},{default:n(()=>[(l(!0),v(w,null,N(F.value,a=>(l(),g(O,{key:a.id,value:a.id},{default:n(()=>[_(d(a.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(S,{label:"审核状态"},{default:n(()=>[o(U,{value:u.accountAuditStatus,"onUpdate:value":e[2]||(e[2]=a=>u.accountAuditStatus=a),placeholder:"请选择审核状态",style:{width:"120px"},"allow-clear":""},{default:n(()=>[(l(!0),v(w,null,N(G.value,a=>(l(),g(O,{key:a.value,value:a.value},{default:n(()=>[_(d(a.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(S,{label:"所属群组"},{default:n(()=>[o(U,{value:u.groupId,"onUpdate:value":e[3]||(e[3]=a=>u.groupId=a),placeholder:"请选择群组",style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:T},{default:n(()=>[(l(!0),v(w,null,N(V.value,a=>(l(),g(O,{key:a.id,value:a.id},{default:n(()=>[_(d(a.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(S,null,{default:n(()=>[o(x,null,{default:n(()=>[o(b,{type:"primary",onClick:L},{default:n(()=>e[6]||(e[6]=[_("查询")])),_:1}),o(b,{onClick:J},{default:n(()=>e[7]||(e[7]=[_("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),c("div",ye,[o(x,null,{default:n(()=>[o(b,{type:"primary",onClick:W},{default:n(()=>e[8]||(e[8]=[_("批量通过")])),_:1}),o(b,{danger:"",onClick:X},{default:n(()=>e[9]||(e[9]=[_("批量拒绝")])),_:1})]),_:1})])]),o(le,{columns:u.accountAuditStatus==="rejected"?M:u.accountAuditStatus==="pending"?q:I,"data-source":E.value,loading:R.value,pagination:h,rowKey:"id","row-selection":{selectedRowKeys:f.value,onChange:H},onChange:P},{bodyCell:n(({column:a,record:s})=>[a.key==="account"?(l(),g(x,{key:0},{default:n(()=>[o(oe,{src:s.channelIcon,size:"small"},null,8,["src"]),c("span",null,d(s.account),1)]),_:2},1024)):p("",!0),a.key==="accountInfo"?(l(),v("div",he,[c("div",ke,[c("div",Ce,[e[11]||(e[11]=c("span",{class:"label"},"主页：",-1)),c("a",{href:s.homeUrl,target:"_blank",class:"link-text"},d(s.homeUrl),9,Se),o(b,{type:"link",size:"small",onClick:K=>te(s.homeUrl)},{default:n(()=>e[10]||(e[10]=[_(" 复制 ")])),_:2},1032,["onClick"])])]),c("div",be,[s.channelCustomFields.includes("fansCount")?(l(),v("div",we,"粉丝数："+d(s.fansCount),1)):p("",!0),s.channelCustomFields.includes("friendsCount")?(l(),v("div",xe,"好友数："+d(s.friendsCount),1)):p("",!0),s.channelCustomFields.includes("postsCount")?(l(),v("div",Ae,"发帖数："+d(s.postsCount),1)):p("",!0)])])):p("",!0),a.key==="member"?(l(),v("div",Re,[c("div",null,d(s.memberNickname),1),c("div",je,[c("span",null,d(s.groupName),1),s.isGroupOwner?(l(),g(se,{key:0,color:"blue",style:{"margin-left":"10px"}},{default:n(()=>e[12]||(e[12]=[_("群主")])),_:1})):p("",!0)])])):p("",!0),a.key==="accountAuditStatus"?(l(),v(w,{key:3},[_(d(ve(A).getEnumText("AccountAuditStatus",s.accountAuditStatus)),1)],64)):p("",!0),a.key==="action"?(l(),g(x,{key:4},{default:n(()=>[s.accountAuditStatus==="pending"?(l(),g(D,{key:0,title:"确定要通过该账号吗？",onConfirm:K=>Q(s)},{default:n(()=>e[13]||(e[13]=[c("a",null,"通过",-1)])),_:2},1032,["onConfirm"])):p("",!0),s.accountAuditStatus==="pending"?(l(),g(D,{key:1,title:"确定要拒绝该账号吗？",onConfirm:K=>Y(s)},{default:n(()=>e[14]||(e[14]=[c("a",{class:"danger"},"拒绝",-1)])),_:2},1032,["onConfirm"])):p("",!0)]),_:2},1024)):p("",!0),a.key==="rejectReason"?(l(),v(w,{key:5},[_(d(s.rejectReason),1)],64)):p("",!0)]),_:1},8,["columns","data-source","loading","pagination","row-selection"])]),o(ce,{open:C.value,"onUpdate:open":e[5]||(e[5]=a=>C.value=a),title:"拒绝原因",onOk:Z,confirmLoading:j.value},{default:n(()=>[o(ue,{value:y.value,"onUpdate:value":e[4]||(e[4]=a=>y.value=a),placeholder:"请输入拒绝原因",rows:4},null,8,["value"])]),_:1},8,["open","confirmLoading"])])}}},ze=ie(Ie,[["__scopeId","data-v-1e3ac388"]]);export{ze as default};

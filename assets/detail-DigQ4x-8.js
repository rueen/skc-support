import{_ as X,i as Y,r as j,a as h,k as Z,v as ee,b as _,c as a,d as u,w as t,e as p,p as f,q as v,l as C,m,f as te,o as i,h as s,t as l,g as V,F as R,n as N,z as q}from"./index-D398LZoF.js";import{P as ae}from"./index-DXmBwOHl.js";const se={class:"task-audit-detail content-container"},le={class:"detail-container"},oe={class:"detail-section"},ne={key:0},re={key:1},de={class:"detail-section"},ie={key:0},ue={class:"detail-section"},ce={class:"detail-section"},me={class:"footer-btns"},_e={class:"left"},pe={class:"right"},fe={__name:"detail",setup(ke){const S=Y(),B=ee(),P=te(),T=j(!1),A=j(!1),g=j(""),k=j(null),r=h({submitContent:{}}),d=h({}),b=h({}),D=async()=>{const n=await q("taskSubmitted.batchResolve",{ids:[k.value]});n.code===0?(m.success("审核通过成功"),y()):m.error(n.message)},E=()=>{g.value="",T.value=!0},L=async()=>{if(!g.value){m.error("请输入拒绝原因");return}A.value=!0;const n=await q("taskSubmitted.batchReject",{ids:[k.value],reason:g.value});n.code===0?(m.success("审核拒绝成功"),T.value=!1,y()):m.error(n.message)},F=()=>{P.push(`/task-submitted/detail/${r.prevTaskId}`),k.value=r.prevTaskId,y()},M=()=>{P.push(`/task-submitted/detail/${r.nextTaskId}`),k.value=r.nextTaskId,y()},U=async n=>{try{const e=await C("task.detail",{},{urlParams:{id:n}});e.code===0?Object.assign(d,e.data):m.error(e.message)}catch{m.error("获取任务详情失败")}},$=async n=>{try{const e=await C("member.detail",{},{urlParams:{id:n}});e.code===0?Object.assign(b,e.data):m.error(e.message)}catch{m.error("获取会员详情失败")}},y=async()=>{try{const n=await C("taskSubmitted.detail",{},{urlParams:{id:k.value}});n.code===0&&(Object.assign(r,n.data),n.data.taskId!=null&&await U(n.data.taskId),n.data.memberId!=null&&await $(n.data.memberId))}catch{m.error("获取详情失败")}};return Z(()=>{k.value=B.params.id,y()}),(n,e)=>{const o=p("a-descriptions-item"),I=p("a-descriptions"),z=p("a-tag"),G=p("a-image"),x=p("a-button"),O=p("a-space"),H=p("a-textarea"),Q=p("a-modal");return i(),_("div",se,[a(ae,{title:"任务审核详情",back:!0}),u("div",le,[u("div",oe,[e[2]||(e[2]=u("div",{class:"section-title"},"任务信息",-1)),a(I,{column:2},{default:t(()=>[a(o,{label:"任务名称"},{default:t(()=>[s(l(d.taskName),1)]),_:1}),a(o,{label:"平台渠道"},{default:t(()=>[s(l(d.channelName),1)]),_:1}),a(o,{label:"达人领域"},{default:t(()=>[s(l(d.category),1)]),_:1}),a(o,{label:"任务类型"},{default:t(()=>[s(l(V(S).getEnumText("TaskType",d.taskType)),1)]),_:1}),a(o,{label:"任务奖励"},{default:t(()=>[s(l(d.reward)+" 元",1)]),_:1}),a(o,{label:"品牌"},{default:t(()=>[s(l(d.brand),1)]),_:1}),a(o,{label:"指定群组"},{default:t(()=>{var c;return[d.groupMode===0?(i(),_("span",ne,"不指定")):(i(),_("span",re,l((c=d.groupNames)==null?void 0:c.join("、")),1))]}),_:1}),a(o,{label:"任务时间"},{default:t(()=>[s(l(d.startTime)+" 至 "+l(d.endTime),1)]),_:1}),a(o,{label:"任务名额"},{default:t(()=>[s(l(d.unlimitedQuota?"不限制":d.quota),1)]),_:1}),a(o,{label:"粉丝要求"},{default:t(()=>[s(l(d.fansRequired)+" 粉丝",1)]),_:1}),a(o,{label:"作品要求"},{default:t(()=>[s(l(d.contentRequirement),1)]),_:1}),a(o,{label:"任务信息"},{default:t(()=>[s(l(d.taskInfo),1)]),_:1})]),_:1})]),u("div",de,[e[4]||(e[4]=u("div",{class:"section-title"},"会员信息",-1)),a(I,{column:2},{default:t(()=>[a(o,{label:"会员昵称"},{default:t(()=>[s(l(b.memberNickname),1)]),_:1}),a(o,{label:"账号"},{default:t(()=>[s(l(b.memberAccount),1)]),_:1}),a(o,{label:"所属群"},{default:t(()=>[(i(!0),_(R,null,N(b.groups,c=>(i(),_("div",null,[u("span",null,l(c.groupName),1),c.isGroupOwner?(i(),f(z,{key:0,color:"blue",style:{"margin-left":"10px"}},{default:t(()=>e[3]||(e[3]=[s("群主")])),_:1})):v("",!0)]))),256)),!b.groups||b.groups.length===0?(i(),_("span",ie,"--")):v("",!0)]),_:1})]),_:1})]),u("div",ue,[e[5]||(e[5]=u("div",{class:"section-title"},"提交信息",-1)),a(I,{column:2},{default:t(()=>{var c;return[(i(!0),_(R,null,N((c=r==null?void 0:r.submitContent)==null?void 0:c.customFields,(w,J)=>(i(),f(o,{key:J,label:w.title},{default:t(()=>[w.type==="image"?(i(!0),_(R,{key:0},N(w.value,(K,W)=>(i(),f(G,{src:K.url,width:60,key:W},null,8,["src"]))),128)):(i(),_(R,{key:1},[s(l(w.value),1)],64))]),_:2},1032,["label"]))),128))]}),_:1})]),u("div",ce,[e[6]||(e[6]=u("div",{class:"section-title"},"审核信息",-1)),a(I,{column:2},{default:t(()=>[a(o,{label:"提交时间"},{default:t(()=>[s(l(r.submitTime),1)]),_:1}),a(o,{label:"审核状态"},{default:t(()=>[s(l(V(S).getEnumText("TaskAuditStatus",r.taskAuditStatus)),1)]),_:1}),r.taskAuditStatus==="rejected"?(i(),f(o,{key:0,label:"拒绝原因"},{default:t(()=>[s(l(r.rejectReason),1)]),_:1})):v("",!0)]),_:1})]),u("div",me,[u("div",_e,[r.taskAuditStatus==="pending"?(i(),f(O,{key:0},{default:t(()=>[a(x,{type:"primary",onClick:D},{default:t(()=>e[7]||(e[7]=[s(" 审核通过 ")])),_:1}),a(x,{danger:"",onClick:E},{default:t(()=>e[8]||(e[8]=[s(" 审核拒绝 ")])),_:1})]),_:1})):v("",!0)]),u("div",pe,[a(O,null,{default:t(()=>[r.prevTaskId&&r.prevTaskId!==r.nextTaskId?(i(),f(x,{key:0,onClick:F},{default:t(()=>e[9]||(e[9]=[s("上一个")])),_:1})):v("",!0),r.nextTaskId?(i(),f(x,{key:1,onClick:M},{default:t(()=>e[10]||(e[10]=[s("下一个")])),_:1})):v("",!0)]),_:1})])])]),a(Q,{open:T.value,"onUpdate:open":e[1]||(e[1]=c=>T.value=c),title:"拒绝原因",onOk:L,confirmLoading:A.value},{default:t(()=>[a(H,{value:g.value,"onUpdate:value":e[0]||(e[0]=c=>g.value=c),placeholder:"请输入拒绝原因",rows:4},null,8,["value"])]),_:1},8,["open","confirmLoading"])])}}},ge=X(fe,[["__scopeId","data-v-7b572e2a"]]);export{ge as default};

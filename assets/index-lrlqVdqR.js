import{P}from"./PageHeader-CHJdny0t.js";import{_ as S,r as _,b as T,k as q,c as G,e as s,w as o,f as m,l as N,m as b,o as c,d as u,t as n,p as w,s as h,h as y,A as U}from"./index-CmSkOvrl.js";const V={class:"system-config-container"},E={class:"form-item-desc"},O={class:"form-item-desc"},j={class:"form-item-desc"},H={class:"form-item-desc"},I={__name:"index",setup(z){const C=_(null),f=_(!1),g=_(!1),r=_(!0),t=T({max_group_members:null,group_owner_commission_rate:null,invite_reward_amount:null}),k={max_group_members:[{required:!0,message:"请输入最大群成员数",trigger:"blur"},{type:"number",min:10,max:1e3,message:"群成员数必须在 10-1000 之间",trigger:"blur"}],group_owner_commission_rate:[{required:!0,message:"请输入群主收益率",trigger:"blur"},{type:"number",min:0,max:100,message:"收益率必须在 0-100 之间",trigger:"blur"}],invite_reward_amount:[{required:!0,message:"请输入邀请奖励金额",trigger:"blur"},{type:"number",min:0,max:1e3,message:"奖励金额必须在 0-1000 之间",trigger:"blur"}],withdrawal_threshold:[{required:!0,message:"请输入提现门槛",trigger:"blur"},{type:"number",min:0,max:99999,message:"提现门槛必须在 0-99999 之间",trigger:"blur"}]},p=async()=>{f.value=!0;try{const e=await N("system.getAllConfig");if(e&&e.data){const a={};e.data.forEach(l=>{a[l.config_key]=l}),Object.assign(t,{max_group_members:a.max_group_members.config_value,group_owner_commission_rate:a.group_owner_commission_rate.config_value,invite_reward_amount:a.invite_reward_amount.config_value,withdrawal_threshold:a.withdrawal_threshold.config_value})}}catch(e){b.error("获取系统配置失败："+(e.message||"未知错误"))}finally{f.value=!1}},$=async()=>{g.value=!0;const e=await U("system.saveAllConfig",{configs:t});g.value=!1,e&&e.code===0?(b.success("保存系统配置成功"),p(),r.value=!0):b.error(e.message||"保存失败")},x=()=>{C.value.validate().then(()=>{$()}).catch(e=>{console.error("表单验证失败",e)})},R=()=>{r.value=!1},A=()=>{p()};return q(()=>{p()}),(e,a)=>{const l=m("a-input-number"),d=m("a-form-item"),v=m("a-button"),D=m("a-space"),B=m("a-form"),M=m("a-spin");return c(),G("div",V,[s(P,{title:e.$t("systemConfig.pageTitle"),back:!0},null,8,["title"]),s(M,{spinning:f.value},{default:o(()=>[s(B,{model:t,rules:k,ref_key:"formRef",ref:C,"label-col":{span:6},"wrapper-col":{span:12}},{default:o(()=>[s(d,{label:e.$t("systemConfig.maxGroupMembers"),name:"maxGroupMembers"},{default:o(()=>[s(l,{value:t.max_group_members,"onUpdate:value":a[0]||(a[0]=i=>t.max_group_members=i),min:1,max:1e3,placeholder:"请输入最大群成员数",disabled:r.value},null,8,["value","disabled"]),u("div",E,[u("div",null,n(e.$t("systemConfig.maxGroupMembersDesc1")),1),u("div",null,n(e.$t("systemConfig.maxGroupMembersDesc2")),1)])]),_:1},8,["label"]),s(d,{label:e.$t("systemConfig.groupOwnerProfitRate"),name:"ownerProfitRate"},{default:o(()=>[s(l,{value:t.group_owner_commission_rate,"onUpdate:value":a[1]||(a[1]=i=>t.group_owner_commission_rate=i),min:0,max:100,step:.1,precision:1,addonAfter:"%",placeholder:"请输入群主收益率",disabled:r.value},null,8,["value","disabled"]),u("div",O,n(e.$t("systemConfig.groupOwnerProfitRateDesc")),1)]),_:1},8,["label"]),s(d,{label:e.$t("systemConfig.inviteRewardAmount"),name:"inviteRewardAmount"},{default:o(()=>[s(l,{value:t.invite_reward_amount,"onUpdate:value":a[2]||(a[2]=i=>t.invite_reward_amount=i),min:0,max:1e3,step:.1,precision:1,addonBefore:"¥",placeholder:"请输入邀请奖励金额",disabled:r.value},null,8,["value","disabled"]),u("div",j,n(e.$t("systemConfig.inviteRewardAmountDesc")),1)]),_:1},8,["label"]),s(d,{label:e.$t("systemConfig.withdrawalThreshold"),name:"withdrawalThreshold"},{default:o(()=>[s(l,{value:t.withdrawal_threshold,"onUpdate:value":a[3]||(a[3]=i=>t.withdrawal_threshold=i),min:0,max:99999,step:1,addonBefore:"¥",placeholder:"请输入提现门槛",disabled:r.value},null,8,["value","disabled"]),u("div",H,n(e.$t("systemConfig.withdrawalThresholdDesc")),1)]),_:1},8,["label"]),s(d,{"wrapper-col":{span:12,offset:6}},{default:o(()=>[s(D,null,{default:o(()=>[r.value?h("",!0):(c(),w(v,{key:0,type:"primary",onClick:x,loading:g.value},{default:o(()=>[y(n(e.$t("common.save")),1)]),_:1},8,["loading"])),r.value?(c(),w(v,{key:1,onClick:R},{default:o(()=>[y(n(e.$t("common.edit")),1)]),_:1})):h("",!0),r.value?h("",!0):(c(),w(v,{key:2,onClick:A},{default:o(()=>[y(n(e.$t("common.reset")),1)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},K=S(I,[["__scopeId","data-v-832e2b1a"]]);export{K as default};

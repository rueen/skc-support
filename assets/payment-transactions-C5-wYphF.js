import{P as W}from"./PageHeader-BHQQyqO7.js";import{c as X,r as g,e as q,z as Z,d as x,p as aa,f as b,h as t,g as v,w as e,i as l,q as ta,v as P,o as p,k as d,t as i,x as _,n as S,F as R,M as ea}from"./index-BNU4geFj.js";const na={class:"content-container"},oa={class:"table-container"},sa={class:"table-header"},ra={class:"left"},ca={__name:"payment-transactions",setup(la){const{t:s}=X(),Y=Z(),y=g(!1),n=q({transactionStatus:void 0,memberId:"",orderId:"",withdrawalId:Y.query.withdrawalId,timeRange:[]}),k=g(!1),H=g({}),$=g(""),N=x(()=>[{title:s("withdrawal.transactions.orderId"),dataIndex:"orderId",key:"orderId"},{title:s("withdrawal.transactions.withdrawalId"),dataIndex:"withdrawalId",key:"withdrawalId"},{title:s("withdrawal.transactions.amount"),dataIndex:"amount",key:"amount",align:"right"},{title:s("withdrawal.transactions.account"),dataIndex:"account",key:"account"},{title:s("withdrawal.transactions.requestParams"),key:"requestParams",align:"center"},{title:s("withdrawal.transactions.responseData"),key:"responseData",align:"center"},{title:s("withdrawal.transactions.transactionStatus"),key:"transactionStatus",align:"center"},{title:s("withdrawal.transactions.requestTime"),dataIndex:"requestTime",key:"requestTime"},{title:s("withdrawal.transactions.responseTime"),dataIndex:"responseTime",key:"responseTime"}]),D=g([]),c=q({current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0}),F=a=>({pending:s("withdrawal.transactions.pending"),success:s("withdrawal.transactions.success"),failed:s("withdrawal.transactions.failed")})[a]||a,U=a=>({pending:"blue",success:"green",failed:"red"})[a]||"default",V=a=>!a&&a!==0?"--":`¥ ${Number(a).toFixed(2)}`,C=()=>{c.current=1,I()},B=()=>{Object.assign(n,{transactionStatus:void 0,memberId:"",orderId:"",withdrawalId:"",timeRange:[]}),C()},J=a=>{c.current=a.current,c.pageSize=a.pageSize,I()},M=a=>{H.value=a,$.value=JSON.stringify(a,null,2),k.value=!0},j=a=>{ea.info({title:s("withdrawal.transactions.errorInfo"),content:a.errorMessage})},I=async()=>{var a,o;y.value=!0;try{const u={page:c.current,pageSize:c.pageSize,transactionStatus:n.transactionStatus,memberId:n.memberId,orderId:n.orderId,withdrawalId:n.withdrawalId,startDate:(a=n.timeRange)==null?void 0:a[0],endDate:(o=n.timeRange)==null?void 0:o[1]},m=await ta("withdrawals.paymentTransactions",u);m.code===0?(D.value=m.data.list||[],c.total=m.data.total||0):P.error(m.message)}catch(u){console.error("加载数据失败:",u),P.error(s("withdrawal.transactions.loadDataFailed"))}finally{y.value=!1}};return aa(()=>{I()}),(a,o)=>{const u=l("a-select-option"),m=l("a-select"),h=l("a-form-item"),T=l("a-input"),E=l("a-range-picker"),f=l("a-button"),O=l("a-space"),A=l("a-form"),K=l("a-tag"),Q=l("a-table"),G=l("a-typography"),L=l("a-modal");return p(),b("div",na,[t(W,{title:a.$t("withdrawal.transactions.pageTitle"),back:!0},null,8,["title"]),v("div",oa,[v("div",sa,[v("div",ra,[t(A,{layout:"inline",model:n},{default:e(()=>[t(h,{label:a.$t("withdrawal.transactions.transactionStatus")},{default:e(()=>[t(m,{value:n.transactionStatus,"onUpdate:value":o[0]||(o[0]=r=>n.transactionStatus=r),placeholder:a.$t("withdrawal.transactions.transactionStatusPlaceholder"),"allow-clear":""},{default:e(()=>[t(u,{value:"pending"},{default:e(()=>[d(i(a.$t("withdrawal.transactions.pending")),1)]),_:1}),t(u,{value:"success"},{default:e(()=>[d(i(a.$t("withdrawal.transactions.success")),1)]),_:1}),t(u,{value:"failed"},{default:e(()=>[d(i(a.$t("withdrawal.transactions.failed")),1)]),_:1})]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),t(h,{label:a.$t("withdrawal.transactions.orderId")},{default:e(()=>[t(T,{value:n.orderId,"onUpdate:value":o[1]||(o[1]=r=>n.orderId=r),placeholder:a.$t("withdrawal.transactions.orderIdPlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),t(h,{label:a.$t("withdrawal.transactions.withdrawalId")},{default:e(()=>[t(T,{value:n.withdrawalId,"onUpdate:value":o[2]||(o[2]=r=>n.withdrawalId=r),placeholder:a.$t("withdrawal.transactions.withdrawalIdPlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),t(h,{label:a.$t("withdrawal.transactions.transactionTime")},{default:e(()=>[t(E,{value:n.timeRange,"onUpdate:value":o[3]||(o[3]=r=>n.timeRange=r),"show-time":{format:"HH:mm"},format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["value"])]),_:1},8,["label"]),t(h,null,{default:e(()=>[t(O,null,{default:e(()=>[t(f,{type:"primary",onClick:C},{default:e(()=>[d(i(a.$t("common.search")),1)]),_:1}),t(f,{onClick:B},{default:e(()=>[d(i(a.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),t(Q,{columns:N.value,"data-source":D.value,loading:y.value,pagination:c,onChange:J,rowKey:"id"},{bodyCell:e(({column:r,record:w})=>[r.key==="transactionStatus"?(p(),b(R,{key:0},[t(K,{color:U(w.transactionStatus)},{default:e(()=>[d(i(F(w.transactionStatus)),1)]),_:2},1032,["color"]),w.errorMessage?(p(),S(f,{key:0,type:"link",size:"small",onClick:z=>j(w)},{default:e(()=>[d(i(a.$t("withdrawal.transactions.view")),1)]),_:2},1032,["onClick"])):_("",!0)],64)):_("",!0),r.key==="amount"?(p(),b(R,{key:1},[d(i(V(w.amount)),1)],64)):_("",!0),r.key==="requestParams"?(p(),S(f,{key:2,type:"link",size:"small",onClick:z=>M(w.requestParams)},{default:e(()=>[d(i(a.$t("withdrawal.transactions.view")),1)]),_:2},1032,["onClick"])):_("",!0),r.key==="responseData"?(p(),S(f,{key:3,type:"link",size:"small",onClick:z=>M(w.responseData)},{default:e(()=>[d(i(a.$t("withdrawal.transactions.view")),1)]),_:2},1032,["onClick"])):_("",!0)]),_:1},8,["columns","data-source","loading","pagination"])]),t(L,{open:k.value,"onUpdate:open":o[4]||(o[4]=r=>k.value=r),title:a.$t("withdrawal.transactions.dataDetails"),width:"800px",footer:null},{default:e(()=>[t(G,null,{default:e(()=>[v("pre",null,i($.value),1)]),_:1})]),_:1},8,["open","title"])])}}};export{ca as default};

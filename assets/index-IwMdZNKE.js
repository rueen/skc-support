import{b as K,r as c,c as T,j as P,k as Q,d as W,e as r,f as l,w as n,g as o,l as X,m as d,o as D,i as U,t as _,p as Y,s as Z,C as ee,v as te,z as ae,A as le}from"./index-ZPK4NXiE.js";const oe={class:"article content-container"},ne={class:"table-container"},ie={class:"table-header"},se={class:"right"},ce=["onClick"],re=["onClick"],pe={__name:"index",setup(de){const{t:s}=K(),g=c(!1),u=c(!1),p=c(!1),m=c("add"),k=c(),y=c(null),a=T({title:"",location:"",content:""}),V={title:[{required:!0,message:s("article.titleRequired")}],content:[{required:!0,message:s("article.contentRequired")}]},q=P(()=>[{title:s("article.title"),dataIndex:"title",key:"title"},{title:s("article.updateTime"),dataIndex:"updateTime",key:"updateTime"},{title:s("article.action"),key:"action",width:200}]),w=c([]),f=T({current:1,pageSize:10,total:0}),z=P(()=>({add:s("article.addTitle"),edit:s("article.editTitle")})[m.value]),A=async e=>{try{const t=await te("article.delete",{id:e.id},{urlParams:{id:e.id}});t.code===0?(d.success(t.message),v()):d.error(t.message)}catch(t){console.error(t)}},B=()=>{m.value="add",a.title="",a.location="",a.content="",u.value=!0},I=e=>{window.open(`${ee.h5Url}/article/${e.id}`,"_blank")},N=e=>{m.value="edit",a.title=e.title,a.location=e.location,a.content=e.content,u.value=!0,y.value=e.id},R=async()=>{p.value=!0;try{const e=await le("article.add",{...a});e.code===0?(d.success(e.message),u.value=!1,v()):d.error(e.message)}catch(e){console.error(e)}finally{p.value=!1}},S=async()=>{p.value=!0;try{const e=await ae("article.edit",{id:y.value,...a},{urlParams:{id:y.value}});e.code===0?(d.success(e.message),u.value=!1,v()):d.error(e.message)}catch(e){console.error(e)}finally{p.value=!1}},L=async()=>{switch(await k.value.validate(),m.value){case"add":await R();break;case"edit":await S();break}},v=async()=>{g.value=!0;try{const e=await X("article.list",{page:f.current,pageSize:f.pageSize});e.code===0?(w.value=e.data.list,f.total=e.data.total):d.error(e.message)}finally{g.value=!1}};return Q(()=>{v()}),(e,t)=>{const E=o("plus-outlined"),M=o("a-button"),O=o("a-typography-text"),j=o("a-popconfirm"),x=o("a-space"),F=o("a-table"),$=o("a-input"),h=o("a-form-item"),G=o("a-textarea"),H=o("a-form"),J=o("a-modal");return D(),W("div",oe,[r("div",ne,[r("div",ie,[t[4]||(t[4]=r("div",{class:"left"},null,-1)),r("div",se,[l(M,{type:"primary",onClick:B},{default:n(()=>[l(E),U(" "+_(e.$t("article.add")),1)]),_:1})])]),l(F,{columns:q.value,"data-source":w.value,loading:g.value,pagination:f},{bodyCell:n(({column:i,record:b})=>[i.key==="action"?(D(),Y(x,{key:0},{default:n(()=>[r("a",{onClick:C=>I(b)},_(e.$t("article.preview")),9,ce),r("a",{onClick:C=>N(b)},_(e.$t("article.edit")),9,re),l(j,{title:e.$t("article.deleteConfirm"),onConfirm:C=>A(b)},{default:n(()=>[r("a",null,[l(O,{type:"danger"},{default:n(()=>[U(_(e.$t("article.delete")),1)]),_:1})])]),_:2},1032,["title","onConfirm"])]),_:2},1024)):Z("",!0)]),_:1},8,["columns","data-source","loading","pagination"])]),l(J,{open:u.value,"onUpdate:open":t[3]||(t[3]=i=>u.value=i),title:z.value,width:800,confirmLoading:p.value,onOk:L},{default:n(()=>[l(H,{ref_key:"formRef",ref:k,model:a,rules:V,"label-col":{span:4},"wrapper-col":{span:19}},{default:n(()=>[l(h,{label:e.$t("article.title"),name:"title"},{default:n(()=>[l($,{value:a.title,"onUpdate:value":t[0]||(t[0]=i=>a.title=i),placeholder:e.$t("article.titlePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),l(h,{label:e.$t("article.location"),name:"location"},{default:n(()=>[l($,{value:a.location,"onUpdate:value":t[1]||(t[1]=i=>a.location=i),placeholder:e.$t("article.locationPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),l(h,{label:e.$t("article.content"),name:"content"},{default:n(()=>[l(G,{value:a.content,"onUpdate:value":t[2]||(t[2]=i=>a.content=i),rows:10,placeholder:e.$t("article.contentPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["open","title","confirmLoading"])])}}};export{pe as default};

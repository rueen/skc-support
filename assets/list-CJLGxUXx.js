import{_ as W,i as X,r as x,a as U,v as Y,k as Z,b as r,d as l,c as a,w as t,e as u,l as V,m as y,f as ee,o,F as g,n as N,p as S,h as d,t as _,g as A,P as te,q as f,s as ae}from"./index-BwTQ22HL.js";import{_ as ne}from"./CopyContent-Co9InXW6.js";const oe={class:"member-list content-container"},se={class:"table-container"},le={class:"table-header"},ie={class:"left"},re={class:"right"},ue={key:0,style:{display:"inline-block"}},ce={class:"link-text-container"},de=["href"],pe={key:0},me=["onClick"],_e=["onClick"],fe={__name:"list",setup(ge){const B=X(),h=ee(),D=Y(),b=x(!1),p=U({memberNickname:"",groupId:D.query.groupId}),I=x([]),m=U({current:1,pageSize:10,total:0}),z=x([]),E=[{title:"会员昵称",dataIndex:"nickname",key:"nickname"},{title:"账号",dataIndex:"account",key:"account"},{title:"渠道账号信息",key:"accountList"},{title:"邀请人",key:"inviterNickname"},{title:"所属群组",key:"groups"},{title:"更新时间",dataIndex:"updateTime",key:"updateTime",width:180},{title:"操作",key:"action",fixed:"right",width:150}],$=()=>{m.current=1,k()},L=()=>{Object.assign(p,{memberNickname:"",groupId:void 0}),$()},F=n=>{m.current=n.current,m.pageSize=n.pageSize,k()},P=()=>{h.push("/member/create")},R=n=>{h.push(`/member/edit/${n.id}`)},q=n=>{h.push(`/member/view/${n.id}`)},j=async n=>{const e=await ae("member.delete",{},{urlParams:{id:n.id}});e.code===0?(y.success("删除成功"),k()):y.error(e.message)},k=async()=>{b.value=!0;try{const n=await V("member.list",{page:m.current,pageSize:m.pageSize,...p});n.code===0?(I.value=n.data.list,m.total=n.data.total):y.error(n.message)}finally{b.value=!1}},O=async(n="")=>{try{const e=await V("group.list",{page:1,pageSize:50,groupName:n});e.code===0&&(z.value=e.data.list||[])}catch{y.error("获取群组列表失败")}};return Z(()=>{k(),O()}),(n,e)=>{const G=u("a-input"),w=u("a-form-item"),M=u("a-select-option"),H=u("a-select"),C=u("a-button"),v=u("a-space"),J=u("a-form"),T=u("a-tag"),K=u("a-popconfirm"),Q=u("a-table");return o(),r("div",oe,[l("div",se,[l("div",le,[l("div",ie,[a(J,{layout:"inline",model:p},{default:t(()=>[a(w,{label:"会员昵称"},{default:t(()=>[a(G,{value:p.memberNickname,"onUpdate:value":e[0]||(e[0]=s=>p.memberNickname=s),placeholder:"请输入会员昵称","allow-clear":""},null,8,["value"])]),_:1}),a(w,{label:"所属群组"},{default:t(()=>[a(H,{value:p.groupId,"onUpdate:value":e[1]||(e[1]=s=>p.groupId=s),placeholder:"请选择群组","allow-clear":"","show-search":"","filter-option":!1,onSearch:O,style:{width:"200px"}},{default:t(()=>[(o(!0),r(g,null,N(z.value,s=>(o(),S(M,{key:s.id,value:s.id},{default:t(()=>[d(_(s.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),a(w,null,{default:t(()=>[a(v,null,{default:t(()=>[a(C,{type:"primary",onClick:$},{default:t(()=>e[2]||(e[2]=[d("查询")])),_:1}),a(C,{onClick:L},{default:t(()=>e[3]||(e[3]=[d("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),l("div",re,[a(v,null,{default:t(()=>[a(C,{type:"primary",onClick:P},{icon:t(()=>[a(A(te))]),default:t(()=>[e[4]||(e[4]=d(" 新增会员 "))]),_:1})]),_:1})])]),a(Q,{columns:E,"data-source":I.value,loading:b.value,pagination:m,onChange:F},{bodyCell:t(({column:s,record:c})=>[s.key==="accountList"?(o(),r("div",ue,[(o(!0),r(g,null,N(c.accountList,i=>(o(),r("div",null,[l("div",null,[a(v,null,{default:t(()=>[d(" 账号："+_(i.account)+" ",1),a(T,{color:"warning"},{default:t(()=>[d(_(A(B).getEnumText("AccountAuditStatus",i.accountAuditStatus)),1)]),_:2},1024)]),_:2},1024)]),l("div",ce,[e[5]||(e[5]=l("span",{class:"label"},"主页：",-1)),a(ne,{content:i.homeUrl},{default:t(()=>[l("a",{href:i.homeUrl,target:"_blank",class:"link-text"},_(i.homeUrl),9,de)]),_:2},1032,["content"])])]))),256))])):f("",!0),s.key==="inviterNickname"?(o(),r(g,{key:1},[d(_(c.inviterNickname||"--"),1)],64)):f("",!0),s.key==="groups"?(o(),r(g,{key:2},[(o(!0),r(g,null,N(c.groups,i=>(o(),r("div",null,[l("span",null,_(i.groupName),1),i.isOwner?(o(),S(T,{key:0,color:"blue",style:{"margin-left":"10px"}},{default:t(()=>e[6]||(e[6]=[d("群主")])),_:1})):f("",!0)]))),256)),!c.groups||c.groups.length===0?(o(),r("span",pe,"--")):f("",!0)],64)):f("",!0),s.key==="action"?(o(),S(v,{key:3},{default:t(()=>[l("a",{onClick:i=>R(c)},"编辑",8,me),l("a",{onClick:i=>q(c)},"查看",8,_e),a(K,{title:"确定要删除吗？",onConfirm:i=>j(c)},{default:t(()=>e[7]||(e[7]=[l("a",{class:"danger"},"删除",-1)])),_:2},1032,["onConfirm"])]),_:2},1024)):f("",!0)]),_:1},8,["data-source","loading","pagination"])])])}}},ye=W(fe,[["__scopeId","data-v-97fcb282"]]);export{ye as default};

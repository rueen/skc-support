import{_ as Q,l as z,m as J,r as S,a as R,n as K,y as W,b as x,c as a,d as i,w as t,e as _,p as I,j as u,f as X,o as c,h as s,t as o,g as h,s as f,v as T,F as O,q as Y,B as A}from"./index-xdmi2-2f.js";import{P as Z}from"./index-CEDEQFYi.js";const $={class:"task-audit-detail content-container"},ee={class:"detail-container"},te={class:"detail-section"},ae={class:"detail-section"},se={class:"detail-section"},oe={class:"detail-section"},le={class:"footer-btns"},ne={class:"left"},re={class:"right"},de={__name:"detail",setup(ie){const k=z();J(()=>k.loaded?k.getEnumOptions("TaskType"):[]);const j=W(),N=X(),v=S(!1),w=S(!1),p=S(""),m=R({}),n=R({}),b=R({}),B=async()=>{try{const r=await A("taskSubmitted.batchResolve",{ids:[j.params.id]});r.code===0?(u.success("审核通过成功"),N.back()):u.error(r.message)}catch{u.error("审核通过失败")}},E=()=>{p.value="",v.value=!0},V=async()=>{if(!p.value){u.error("请输入拒绝原因");return}try{w.value=!0;const r=await A("taskSubmitted.batchReject",{ids:[j.params.id],reason:p.value});r.code===0?(u.success("审核拒绝成功"),v.value=!1,N.back()):u.error(r.message)}catch{u.error("审核拒绝失败")}finally{w.value=!1}},q=()=>{},D=()=>{},L=async r=>{try{const e=await I("task.detail",{params:{id:r}});e.code===0?Object.assign(n,e.data):u.error(e.message)}catch{u.error("获取任务详情失败")}},M=async r=>{try{const e=await I("member.detail",{params:{id:r}});e.code===0?Object.assign(b,e.data):u.error(e.message)}catch{u.error("获取会员详情失败")}},F=async r=>{try{const e=await I("taskSubmitted.detail",{params:{id:r}});e.code===0&&(Object.assign(m,e.data),e.data.relatedTaskId&&await L(e.data.relatedTaskId),e.data.relatedMemberId&&await M(e.data.relatedMemberId))}catch{u.error("获取详情失败")}};return K(()=>{F(j.params.id)}),(r,e)=>{const l=_("a-descriptions-item"),g=_("a-descriptions"),P=_("a-tag"),U=_("a-image"),y=_("a-button"),C=_("a-space"),G=_("a-textarea"),H=_("a-modal");return c(),x("div",$,[a(Z,{title:"任务审核详情",back:!0}),i("div",ee,[i("div",te,[e[2]||(e[2]=i("div",{class:"section-title"},"任务信息",-1)),a(g,{column:2},{default:t(()=>[a(l,{label:"任务名称"},{default:t(()=>[s(o(n.taskName),1)]),_:1}),a(l,{label:"平台渠道"},{default:t(()=>[s(o(n.channelName),1)]),_:1}),a(l,{label:"达人领域"},{default:t(()=>[s(o(n.category),1)]),_:1}),a(l,{label:"任务类型"},{default:t(()=>[s(o(h(k).getEnumText("TaskType",n.type)),1)]),_:1}),a(l,{label:"任务奖励"},{default:t(()=>[s(o(n.reward)+" 元",1)]),_:1}),a(l,{label:"品牌"},{default:t(()=>[s(o(n.brand),1)]),_:1}),a(l,{label:"指定群组"},{default:t(()=>{var d;return[s(o((d=n.groupNames)==null?void 0:d.join("、")),1)]}),_:1}),a(l,{label:"任务时间"},{default:t(()=>[s(o(n.startTime)+" 至 "+o(n.endTime),1)]),_:1}),a(l,{label:"任务名额"},{default:t(()=>[s(o(n.unlimitedQuota?"不限制":n.quota),1)]),_:1}),a(l,{label:"粉丝要求"},{default:t(()=>[s(o(n.fansRequired)+" 粉丝",1)]),_:1}),a(l,{label:"作品要求"},{default:t(()=>[s(o(n.contentRequirement),1)]),_:1}),a(l,{label:"任务信息"},{default:t(()=>[s(o(n.taskInfo),1)]),_:1})]),_:1})]),i("div",ae,[e[4]||(e[4]=i("div",{class:"section-title"},"会员信息",-1)),a(g,{column:2},{default:t(()=>[a(l,{label:"会员昵称"},{default:t(()=>[s(o(b.nickname),1)]),_:1}),a(l,{label:"账号"},{default:t(()=>[s(o(b.account),1)]),_:1}),a(l,{label:"所属群"},{default:t(()=>[s(o(b.groupName)+" ",1),b.isGroupOwner?(c(),f(P,{key:0,color:"blue"},{default:t(()=>e[3]||(e[3]=[s("群主")])),_:1})):T("",!0)]),_:1})]),_:1})]),i("div",se,[e[5]||(e[5]=i("div",{class:"section-title"},"提交信息",-1)),a(g,{column:2},{default:t(()=>[(c(!0),x(O,null,Y(n.customFields,d=>(c(),f(l,{key:d.title,label:d.title},{default:t(()=>[d.type==="image"?(c(),f(U,{key:0,src:d.value,width:120},null,8,["src"])):(c(),x(O,{key:1},[s(o(d.value),1)],64))]),_:2},1032,["label"]))),128))]),_:1})]),i("div",oe,[e[6]||(e[6]=i("div",{class:"section-title"},"审核信息",-1)),a(g,{column:2},{default:t(()=>[a(l,{label:"报名时间"},{default:t(()=>[s(o(m.applyTime),1)]),_:1}),a(l,{label:"提交时间"},{default:t(()=>[s(o(m.submitTime),1)]),_:1}),a(l,{label:"审核状态"},{default:t(()=>[s(o(h(k).getEnumText("TaskAuditStatus",m.taskAuditStatus)),1)]),_:1}),m.taskAuditStatus==="rejected"?(c(),f(l,{key:0,label:"拒绝原因"},{default:t(()=>[s(o(m.rejectReason),1)]),_:1})):T("",!0)]),_:1})]),i("div",le,[i("div",ne,[a(C,null,{default:t(()=>[m.taskAuditStatus==="pending"?(c(),f(y,{key:0,type:"primary",onClick:B},{default:t(()=>e[7]||(e[7]=[s(" 审核通过 ")])),_:1})):T("",!0),m.taskAuditStatus==="pending"?(c(),f(y,{key:1,danger:"",onClick:E},{default:t(()=>e[8]||(e[8]=[s(" 审核拒绝 ")])),_:1})):T("",!0)]),_:1})]),i("div",re,[a(C,null,{default:t(()=>[a(y,{onClick:q},{default:t(()=>e[9]||(e[9]=[s("上一个")])),_:1}),a(y,{onClick:D},{default:t(()=>e[10]||(e[10]=[s("下一个")])),_:1})]),_:1})])])]),a(H,{open:v.value,"onUpdate:open":e[1]||(e[1]=d=>v.value=d),title:"拒绝原因",onOk:V,confirmLoading:w.value},{default:t(()=>[a(G,{value:p.value,"onUpdate:value":e[0]||(e[0]=d=>p.value=d),placeholder:"请输入拒绝原因",rows:4},null,8,["value"])]),_:1},8,["open","confirmLoading"])])}}},me=Q(de,[["__scopeId","data-v-0f3bfda6"]]);export{me as default};

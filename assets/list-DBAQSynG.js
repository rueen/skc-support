import{_ as X,a as Y,b as Z,r as S,c as V,x as ee,j as te,k as ae,d as m,e as r,f as a,w as t,g as c,l as B,m as y,h as ne,o as n,F as k,n as I,p as b,i as d,t as o,s as p,q as oe,v as se}from"./index-DCFV-ioj.js";import{_ as le}from"./CopyContent-629H6s2Z.js";import{G as re}from"./GroupOwner-BuZ6Yszj.js";const ie={class:"member-list content-container"},ce={class:"table-container"},ue={class:"table-header"},me={class:"left"},de={class:"right"},pe={key:1,style:{display:"inline-block"}},_e={class:"link-text-container"},he={class:"label"},fe=["href"],ge={key:0},be=["onClick"],ke=["onClick"],ve={class:"danger"},ye={__name:"list",setup(we){const D=Y(),{t:_}=Z(),w=ne(),E=ee(),$=S(!1),h=V({memberNickname:"",groupId:E.query.groupId}),z=S([]),f=V({current:1,pageSize:10,total:0}),T=S([]),L=te(()=>[{title:_("member.list.memberNickname"),key:"nickname"},{title:_("member.list.memberAccount"),dataIndex:"account",key:"account"},{title:_("member.list.accounts"),key:"accountList"},{title:_("member.list.inviter"),key:"inviterNickname"},{title:_("member.list.group"),key:"groups"},{title:_("member.list.updateTime"),dataIndex:"updateTime",key:"updateTime",width:180},{title:_("member.list.action"),key:"action",fixed:"right",width:150}]),A=()=>{f.current=1,v()},F=()=>{Object.assign(h,{memberNickname:"",groupId:void 0}),A()},G=e=>{f.current=e.current,f.pageSize=e.pageSize,v()},P=()=>{w.push("/member/create")},R=e=>{w.push(`/member/edit/${e.id}`)},j=e=>{w.push(`/member/view/${e.id}`)},q=async e=>{const s=await se("member.delete",{},{urlParams:{id:e.id}});s.code===0?(y.success("删除成功"),v()):y.error(s.message)},v=async()=>{$.value=!0;try{const e=await B("member.list",{page:f.current,pageSize:f.pageSize,...h});e.code===0?(z.value=e.data.list,f.total=e.data.total):y.error(e.message)}finally{$.value=!1}},O=async(e="")=>{try{const s=await B("group.list",{page:1,pageSize:50,groupName:e});s.code===0&&(T.value=s.data.list||[])}catch{y.error("获取群组列表失败")}};return ae(()=>{v(),O()}),(e,s)=>{const M=c("a-input"),N=c("a-form-item"),x=c("a-select-option"),H=c("a-select"),C=c("a-button"),g=c("a-space"),J=c("a-form"),K=c("plus-outlined"),U=c("a-tag"),Q=c("a-popconfirm"),W=c("a-table");return n(),m("div",ie,[r("div",ce,[r("div",ue,[r("div",me,[a(J,{layout:"inline",model:h},{default:t(()=>[a(N,{label:e.$t("member.search.memberNickname")},{default:t(()=>[a(M,{value:h.memberNickname,"onUpdate:value":s[0]||(s[0]=l=>h.memberNickname=l),placeholder:e.$t("member.search.memberNicknamePlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),a(N,{label:e.$t("member.search.group")},{default:t(()=>[a(H,{value:h.groupId,"onUpdate:value":s[1]||(s[1]=l=>h.groupId=l),placeholder:e.$t("member.search.groupPlaceholder"),"allow-clear":"","show-search":"","filter-option":!1,onSearch:O,style:{width:"200px"}},{default:t(()=>[(n(!0),m(k,null,I(T.value,l=>(n(),b(x,{key:l.id,value:l.id},{default:t(()=>[d(o(l.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),a(N,null,{default:t(()=>[a(g,null,{default:t(()=>[a(C,{type:"primary",onClick:A},{default:t(()=>[d(o(e.$t("common.search")),1)]),_:1}),a(C,{onClick:F},{default:t(()=>[d(o(e.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),r("div",de,[a(g,null,{default:t(()=>[a(C,{type:"primary",onClick:P},{icon:t(()=>[a(K)]),default:t(()=>[d(" "+o(e.$t("member.list.add")),1)]),_:1})]),_:1})])]),a(W,{columns:L.value,"data-source":z.value,loading:$.value,pagination:f,onChange:G},{bodyCell:t(({column:l,record:u})=>[l.key==="nickname"?(n(),b(g,{key:0},{default:t(()=>[r("span",null,o(u.nickname),1),u.isNew?(n(),b(U,{key:0,color:"green"},{default:t(()=>s[2]||(s[2]=[d("new")])),_:1})):p("",!0)]),_:2},1024)):p("",!0),l.key==="accountList"?(n(),m("div",pe,[(n(!0),m(k,null,I(u.accountList,i=>(n(),m("div",null,[r("div",null,[a(g,null,{default:t(()=>[d(o(e.$t("member.list.account"))+"："+o(i.account)+" ",1),a(U,{color:"warning"},{default:t(()=>[d(o(oe(D).getEnumText("AccountAuditStatus",i.accountAuditStatus)),1)]),_:2},1024)]),_:2},1024)]),r("div",_e,[r("span",he,o(e.$t("member.list.homepage"))+"：",1),a(le,{content:i.homeUrl},{default:t(()=>[r("a",{href:i.homeUrl,target:"_blank",class:"link-text"},o(i.homeUrl),9,fe)]),_:2},1032,["content"])])]))),256))])):p("",!0),l.key==="inviterNickname"?(n(),m(k,{key:2},[d(o(u.inviterNickname||"--"),1)],64)):p("",!0),l.key==="groups"?(n(),m(k,{key:3},[(n(!0),m(k,null,I(u.groups,i=>(n(),b(g,null,{default:t(()=>[r("span",null,o(i.groupName),1),i.isOwner?(n(),b(re,{key:0})):p("",!0)]),_:2},1024))),256)),!u.groups||u.groups.length===0?(n(),m("span",ge,"--")):p("",!0)],64)):p("",!0),l.key==="action"?(n(),b(g,{key:4},{default:t(()=>[r("a",{onClick:i=>R(u)},o(e.$t("member.list.edit")),9,be),r("a",{onClick:i=>j(u)},o(e.$t("member.list.view")),9,ke),a(Q,{title:e.$t("member.list.deleteConfirm"),onConfirm:i=>q(u)},{default:t(()=>[r("a",ve,o(e.$t("member.list.delete")),1)]),_:2},1032,["title","onConfirm"])]),_:2},1024)):p("",!0)]),_:1},8,["columns","data-source","loading","pagination"])])])}}},Se=X(ye,[["__scopeId","data-v-eda72a25"]]);export{Se as default};

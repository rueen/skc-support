import{g as f,p as N}from"./request-DysJmEHt.js";import{_ as P,r as i,a as q,k as A,b as D,d as m,c as o,w as s,e as n,o as v,m as E,n as M,i as y}from"./index-Dv7OF5ky.js";const O={class:"article content-container"},T={class:"table-container"},z=["onClick"],$={class:"editor-wrapper"},j={__name:"index",setup(F){const c=i(!1),r=i(!1),d=i(!1),p=i(),a=q({id:null,title:"",content:""}),g={title:[{required:!0,message:"请输入文章标题"}],content:[{required:!0,message:"请输入文章内容"}]},k=[{title:"文章标题",dataIndex:"title",key:"title"},{title:"更新时间",dataIndex:"updateTime",key:"updateTime"},{title:"操作",key:"action",width:100}],u=i([]),b=e=>{a.id=e.id,a.title=e.title,a.content=e.content,r.value=!0},w=async()=>{p.value.validate().then(async()=>{d.value=!0;try{const e=await N("article.edit",{location:a.location,...a});e.code===0?(y.success("保存成功"),r.value=!1):y.error(e.message)}catch(e){console.error(e)}finally{d.value=!1}})},x=async()=>{c.value=!0;try{const e=await f("article.get",{params:{location:"userAgreement"}});e.code===0&&u.value.push(e.data||{})}finally{c.value=!1}},h=async()=>{c.value=!0;try{const e=await f("article.get",{params:{location:"privacyPolicy"}});e.code===0&&u.value.push(e.data||{})}finally{c.value=!1}};return A(()=>{x(),h()}),(e,l)=>{const C=n("a-space"),B=n("a-table"),R=n("a-input"),_=n("a-form-item"),U=n("a-textarea"),V=n("a-form"),I=n("a-modal");return v(),D("div",O,[m("div",T,[o(B,{columns:k,"data-source":u.value,loading:c.value,pagination:!1},{bodyCell:s(({column:t,record:L})=>[t.key==="action"?(v(),E(C,{key:0},{default:s(()=>[m("a",{onClick:G=>b(L)},"编辑",8,z)]),_:2},1024)):M("",!0)]),_:1},8,["data-source","loading"])]),o(I,{open:r.value,"onUpdate:open":l[2]||(l[2]=t=>r.value=t),title:"编辑文章",width:800,confirmLoading:d.value,onOk:w},{default:s(()=>[o(V,{ref_key:"formRef",ref:p,model:a,rules:g,"label-col":{span:4},"wrapper-col":{span:19}},{default:s(()=>[o(_,{label:"文章标题",name:"title"},{default:s(()=>[o(R,{value:a.title,"onUpdate:value":l[0]||(l[0]=t=>a.title=t),placeholder:"请输入文章标题"},null,8,["value"])]),_:1}),o(_,{label:"文章内容",name:"content"},{default:s(()=>[m("div",$,[o(U,{value:a.content,"onUpdate:value":l[1]||(l[1]=t=>a.content=t),placeholder:"请输入文章内容","auto-size":{minRows:10,maxRows:20}},null,8,["value"])])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","confirmLoading"])])}}},K=P(j,[["__scopeId","data-v-5392e4b5"]]);export{K as default};

import{_ as K,b as Q,a as X,j as g,r as O,c as D,k as Y,d as s,e as S,f as o,w as n,g as u,l as Z,m as ee,h as te,o as a,F as p,n as F,p as k,i as r,t as i,s as _,q as T,M as ae}from"./index-uPBkc_Vz.js";const le={class:"other-bill content-container"},ne={class:"table-container"},se={class:"table-header"},ie={class:"left"},oe={key:1},ue={key:1},ce={key:0},me={key:1},re={key:0},de={key:1},pe={__name:"bills",setup(_e){const{t:m}=Q(),d=X(),N=te(),M=g(()=>d.loaded?d.getEnumOptions("BillType"):[]),R=g(()=>d.loaded?d.getEnumOptions("SettlementStatus"):[]),h=O(!1),c=D({billNo:"",memberNickname:"",billType:void 0,settlementStatus:void 0}),V=e=>{ae.error({title:"结算失败原因",content:e.failureReason})},j=g(()=>[{title:m("financial.bills.billNo"),dataIndex:"billNo",key:"billNo"},{title:m("financial.bills.memberNickname"),key:"memberNickname"},{title:m("financial.bills.billType"),dataIndex:"billType",key:"billType"},{title:m("financial.bills.relatedTaskName"),key:"taskName"},{title:m("financial.bills.amount"),dataIndex:"amount",key:"amount",align:"right"},{title:m("financial.bills.remark"),key:"remark"},{title:m("financial.bills.createTime"),dataIndex:"createTime",key:"createTime"},{title:m("financial.bills.settlementStatus"),key:"settlementStatus"}]),w=O([]),b=D({current:1,pageSize:10,total:0}),C=()=>{b.current=1,v()},z=()=>{Object.assign(c,{billNo:"",memberNickname:"",billType:void 0,settlementStatus:void 0}),C()},P=e=>{Object.assign(b,e),v()},U=e=>{N.push(`/member/view/${e.memberId}`)},q=e=>{console.log(e),N.push(`/submitted-tasks/detail/${e.submittedId}?type=confirm`)},v=async()=>{h.value=!0;try{const e=await Z("finance.bills",{page:b.current,pageSize:b.pageSize,...c});e.code===0?(w.value=e.data.list,b.total=e.data.total):ee.error(e.message)}finally{h.value=!1}};return Y(()=>{v()}),(e,y)=>{const L=u("a-input"),f=u("a-form-item"),$=u("a-select-option"),x=u("a-select"),I=u("a-button"),W=u("a-space"),A=u("a-form"),E=u("a-typography-link"),G=u("a-typography-text"),H=u("info-circle-outlined"),J=u("a-table");return a(),s("div",le,[S("div",ne,[S("div",se,[S("div",ie,[o(A,{layout:"inline",model:c},{default:n(()=>[o(f,{label:e.$t("financial.bills.billNo")},{default:n(()=>[o(L,{value:c.billNo,"onUpdate:value":y[0]||(y[0]=t=>c.billNo=t),placeholder:e.$t("financial.bills.billNoPlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),o(f,{label:e.$t("financial.bills.billType")},{default:n(()=>[o(x,{value:c.billType,"onUpdate:value":y[1]||(y[1]=t=>c.billType=t),placeholder:e.$t("financial.bills.billTypePlaceholder"),style:{width:"120px"},"allow-clear":""},{default:n(()=>[(a(!0),s(p,null,F(M.value,t=>(a(),k($,{key:t.value,value:t.value},{default:n(()=>[r(i(t.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),o(f,{label:e.$t("financial.bills.settlementStatus")},{default:n(()=>[o(x,{value:c.settlementStatus,"onUpdate:value":y[2]||(y[2]=t=>c.settlementStatus=t),placeholder:e.$t("financial.bills.settlementStatusPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:n(()=>[(a(!0),s(p,null,F(R.value,t=>(a(),k($,{key:t.value,value:t.value},{default:n(()=>[r(i(t.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),o(f,null,{default:n(()=>[o(W,null,{default:n(()=>[o(I,{type:"primary",onClick:C},{default:n(()=>[r(i(e.$t("common.search")),1)]),_:1}),o(I,{onClick:z},{default:n(()=>[r(i(e.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),o(J,{columns:j.value,"data-source":w.value,loading:h.value,pagination:b,onChange:P},{bodyCell:n(({column:t,record:l})=>[t.key==="memberNickname"?(a(),k(E,{key:0,onClick:B=>U(l)},{default:n(()=>[r(i(l.memberNickname),1)]),_:2},1032,["onClick"])):_("",!0),t.key==="taskName"?(a(),s(p,{key:1},[l.taskName?(a(),k(E,{key:0,onClick:B=>q(l)},{default:n(()=>[r(i(l.taskName),1)]),_:2},1032,["onClick"])):(a(),s("span",oe,"--"))],64)):_("",!0),t.key==="billType"?(a(),s(p,{key:2},[r(i(T(d).getEnumText("BillType",l.billType)),1)],64)):_("",!0),t.key==="amount"?(a(),s(p,{key:3},[l.billType==="reward_deduction"?(a(),k(G,{key:0,type:"danger"},{default:n(()=>[r(" - "+i(l.amount),1)]),_:2},1024)):(a(),s("span",ue,i(l.amount),1))],64)):_("",!0),t.key==="remark"?(a(),s(p,{key:4},[l.remark?(a(),s("span",ce,i(l.remark)+"("+i(e.$t("financial.bills.operator"))+": "+i(l.waiterName)+")",1)):(a(),s("span",me,"--"))],64)):_("",!0),t.key==="settlementStatus"?(a(),s(p,{key:5},[l.billType==="withdrawal"?(a(),s("span",re,i(T(d).getEnumText("WithdrawalStatus",l.withdrawalStatus)),1)):(a(),s("span",de,i(T(d).getEnumText("SettlementStatus",l.settlementStatus)),1)),l.settlementStatus==="failed"||l.withdrawalStatus==="failed"?(a(),k(H,{key:2,class:"status-icon",onClick:B=>V(l)},null,8,["onClick"])):_("",!0)],64)):_("",!0)]),_:1},8,["columns","data-source","loading","pagination"])])])}}},ye=K(pe,[["__scopeId","data-v-ecfd2125"]]);export{ye as default};

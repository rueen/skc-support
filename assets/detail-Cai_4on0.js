import{c as E,r as h,d as S,z as U,e as j,p as N,f as V,h as t,g as y,w as o,i as l,q as z,A as c,v as i,j as A,o as F,k as w,t as Y,B as I,C as L}from"./index-BJg42wI2.js";import{P as O}from"./PageHeader-BrPkT9ND.js";const G={class:"content-container"},J={class:"form-container"},X={__name:"detail",setup(K){const{t:n}=E(),p=U(),f=A(),v=h(),g=S(()=>p.name==="MessagesEdit"),s=j({title:"",content:"",startTime:void 0,endTime:void 0}),k={title:[{required:!0,message:n("messages.detail.validation.titleRequired")}],content:[{required:!0,message:n("messages.detail.validation.contentRequired")}],startTime:[{required:!0,message:n("messages.detail.validation.startTimeRequired")}],endTime:[{required:!0,message:n("messages.detail.validation.endTimeRequired")}]},D=async a=>{try{u.value=!0;const e=await L("messages.add",a);e.code===0?(i.success(n("common.submitSuccess")),f.back()):i.error(e.message)}catch(e){console.log(e),i.error(n("common.submitFailed"))}finally{u.value=!1}},$=async a=>{try{u.value=!0;const e=await I("messages.edit",{...a},{urlParams:{id:p.params.id}});e.code===0?(i.success(n("common.submitSuccess")),f.back()):i.error(e.message)}catch(e){console.log(e),i.error(n("common.submitFailed"))}finally{u.value=!1}},u=h(!1),q=()=>{v.value.validate().then(async()=>{const a={...s,startTime:s.startTime?c(s.startTime).format("YYYY-MM-DD HH:mm:ss"):null,endTime:s.endTime?c(s.endTime).format("YYYY-MM-DD HH:mm:ss"):null};g.value?await $(a):await D(a)})},M=()=>{f.back()},H=async a=>{try{const e=await z("messages.detail",{},{urlParams:{id:a}});if(e.code===0){const d=e.data;Object.assign(s,d,{startTime:c(d.startTime),endTime:c(d.endTime)})}}catch(e){console.log(e),i.error(e)}};return N(()=>{g.value&&H(p.params.id)}),(a,e)=>{const d=l("a-input"),m=l("a-form-item"),R=l("a-textarea"),T=l("a-date-picker"),_=l("a-col"),C=l("a-row"),b=l("a-button"),P=l("a-space"),B=l("a-form");return F(),V("div",G,[t(O,{title:g.value?a.$t("messages.detail.editTitle"):a.$t("messages.detail.createTitle"),back:!0,class:"page-header"},null,8,["title"]),y("div",J,[t(B,{ref_key:"formRef",ref:v,model:s,rules:k,"label-col":{span:5},"wrapper-col":{span:18},layout:"horizontal"},{default:o(()=>[t(m,{label:a.$t("messages.detail.title"),name:"title"},{default:o(()=>[t(d,{value:s.title,"onUpdate:value":e[0]||(e[0]=r=>s.title=r),placeholder:a.$t("common.inputPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(m,{label:a.$t("messages.detail.content"),name:"content"},{default:o(()=>[t(R,{value:s.content,"onUpdate:value":e[1]||(e[1]=r=>s.content=r),rows:10,placeholder:a.$t("common.inputPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(m,{label:a.$t("messages.detail.time"),required:""},{default:o(()=>[t(C,{gutter:8},{default:o(()=>[t(_,{span:11},{default:o(()=>[t(m,{name:"startTime"},{default:o(()=>[t(T,{value:s.startTime,"onUpdate:value":e[2]||(e[2]=r=>s.startTime=r),"show-time":"",style:{width:"100%"},placeholder:a.$t("messages.detail.startTime"),format:"YYYY-MM-DD HH:mm:ss"},null,8,["value","placeholder"])]),_:1})]),_:1}),t(_,{span:2,style:{"text-align":"center","line-height":"32px"}},{default:o(()=>e[4]||(e[4]=[y("span",null,"è‡³",-1)])),_:1}),t(_,{span:11},{default:o(()=>[t(m,{name:"endTime"},{default:o(()=>[t(T,{value:s.endTime,"onUpdate:value":e[3]||(e[3]=r=>s.endTime=r),"show-time":"",style:{width:"100%"},placeholder:a.$t("messages.detail.endTime"),format:"YYYY-MM-DD HH:mm:ss"},null,8,["value","placeholder"])]),_:1})]),_:1})]),_:1})]),_:1},8,["label"]),t(m,{"wrapper-col":{span:16,offset:4}},{default:o(()=>[t(P,null,{default:o(()=>[t(b,{type:"primary",onClick:q},{default:o(()=>[w(Y(a.$t("common.submit")),1)]),_:1}),t(b,{onClick:M},{default:o(()=>[w(Y(a.$t("common.cancel")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])])}}};export{X as default};

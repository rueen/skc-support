import{_ as K,b as Q,a as X,j as g,r as D,c as F,k as Y,d as s,e as N,f as i,w as n,g as c,l as Z,m as ee,h as te,o as a,F as b,n as M,p as y,i as d,t as o,s as _,q as S,M as ae}from"./index-Dv9QhQos.js";const le={class:"other-bill content-container"},ne={class:"table-container"},se={class:"table-header"},ie={class:"left"},oe={key:1},ue={key:1},ce={key:0},me={key:1},re={key:0},de={key:1},pe={__name:"bills",setup(be){const{t:m}=Q(),p=X(),T=te(),P=g(()=>p.loaded?p.getEnumOptions("BillType"):[]),R=g(()=>p.loaded?p.getEnumOptions("SettlementStatus"):[]),h=D(!1),u=F({billNo:"",memberNickname:"",billType:void 0,settlementStatus:void 0,taskName:""}),U=e=>{ae.error({title:"结算失败原因",content:e.failureReason})},V=g(()=>[{title:m("financial.bills.billNo"),dataIndex:"billNo",key:"billNo"},{title:m("financial.bills.memberNickname"),key:"memberNickname"},{title:m("financial.bills.billType"),dataIndex:"billType",key:"billType"},{title:m("financial.bills.relatedTaskName"),key:"taskName"},{title:m("financial.bills.amount"),dataIndex:"amount",key:"amount",align:"right"},{title:m("financial.bills.remark"),key:"remark"},{title:m("financial.bills.createTime"),dataIndex:"createTime",key:"createTime"},{title:m("financial.bills.settlementStatus"),key:"settlementStatus"}]),w=D([]),k=F({current:1,pageSize:10,total:0}),$=()=>{k.current=1,v()},j=()=>{Object.assign(u,{billNo:"",memberNickname:"",billType:void 0,settlementStatus:void 0,taskName:""}),$()},z=e=>{Object.assign(k,e),v()},q=e=>{T.push(`/member/view/${e.memberId}`)},L=e=>{console.log(e),T.push(`/submitted-tasks/detail/${e.submittedId}?type=confirm`)},v=async()=>{h.value=!0;try{const e=await Z("finance.bills",{page:k.current,pageSize:k.pageSize,...u});e.code===0?(w.value=e.data.list,k.total=e.data.total):ee.error(e.message)}finally{h.value=!1}};return Y(()=>{v()}),(e,r)=>{const C=c("a-input"),f=c("a-form-item"),I=c("a-select-option"),x=c("a-select"),E=c("a-button"),W=c("a-space"),A=c("a-form"),B=c("a-typography-link"),G=c("a-typography-text"),H=c("info-circle-outlined"),J=c("a-table");return a(),s("div",le,[N("div",ne,[N("div",se,[N("div",ie,[i(A,{layout:"inline",model:u},{default:n(()=>[i(f,{label:e.$t("financial.bills.billNo")},{default:n(()=>[i(C,{value:u.billNo,"onUpdate:value":r[0]||(r[0]=t=>u.billNo=t),placeholder:e.$t("financial.bills.billNoPlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),i(f,{label:e.$t("financial.bills.billType")},{default:n(()=>[i(x,{value:u.billType,"onUpdate:value":r[1]||(r[1]=t=>u.billType=t),placeholder:e.$t("financial.bills.billTypePlaceholder"),style:{width:"120px"},"allow-clear":""},{default:n(()=>[(a(!0),s(b,null,M(P.value,t=>(a(),y(I,{key:t.value,value:t.value},{default:n(()=>[d(o(t.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),i(f,{label:e.$t("financial.bills.settlementStatus")},{default:n(()=>[i(x,{value:u.settlementStatus,"onUpdate:value":r[2]||(r[2]=t=>u.settlementStatus=t),placeholder:e.$t("financial.bills.settlementStatusPlaceholder"),style:{width:"120px"},"allow-clear":""},{default:n(()=>[(a(!0),s(b,null,M(R.value,t=>(a(),y(I,{key:t.value,value:t.value},{default:n(()=>[d(o(t.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","placeholder"])]),_:1},8,["label"]),i(f,{label:e.$t("financial.bills.taskName")},{default:n(()=>[i(C,{value:u.taskName,"onUpdate:value":r[3]||(r[3]=t=>u.taskName=t),placeholder:e.$t("financial.bills.taskNamePlaceholder"),"allow-clear":""},null,8,["value","placeholder"])]),_:1},8,["label"]),i(f,null,{default:n(()=>[i(W,null,{default:n(()=>[i(E,{type:"primary",onClick:$},{default:n(()=>[d(o(e.$t("common.search")),1)]),_:1}),i(E,{onClick:j},{default:n(()=>[d(o(e.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),i(J,{columns:V.value,"data-source":w.value,loading:h.value,pagination:k,onChange:z},{bodyCell:n(({column:t,record:l})=>[t.key==="memberNickname"?(a(),y(B,{key:0,onClick:O=>q(l)},{default:n(()=>[d(o(l.memberNickname),1)]),_:2},1032,["onClick"])):_("",!0),t.key==="taskName"?(a(),s(b,{key:1},[l.taskName?(a(),y(B,{key:0,onClick:O=>L(l)},{default:n(()=>[d(o(l.taskName),1)]),_:2},1032,["onClick"])):(a(),s("span",oe,"--"))],64)):_("",!0),t.key==="billType"?(a(),s(b,{key:2},[d(o(S(p).getEnumText("BillType",l.billType)),1)],64)):_("",!0),t.key==="amount"?(a(),s(b,{key:3},[l.billType==="reward_deduction"?(a(),y(G,{key:0,type:"danger"},{default:n(()=>[d(" - "+o(l.amount),1)]),_:2},1024)):(a(),s("span",ue,o(l.amount),1))],64)):_("",!0),t.key==="remark"?(a(),s(b,{key:4},[l.remark?(a(),s("span",ce,o(l.remark)+"("+o(e.$t("financial.bills.operator"))+": "+o(l.waiterName)+")",1)):(a(),s("span",me,"--"))],64)):_("",!0),t.key==="settlementStatus"?(a(),s(b,{key:5},[l.billType==="withdrawal"?(a(),s("span",re,o(S(p).getEnumText("WithdrawalStatus",l.withdrawalStatus)),1)):(a(),s("span",de,o(S(p).getEnumText("SettlementStatus",l.settlementStatus)),1)),l.settlementStatus==="failed"||l.withdrawalStatus==="failed"?(a(),y(H,{key:2,class:"status-icon",onClick:O=>U(l)},null,8,["onClick"])):_("",!0)],64)):_("",!0)]),_:1},8,["columns","data-source","loading","pagination"])])])}}},ke=K(pe,[["__scopeId","data-v-9b4ae393"]]);export{ke as default};

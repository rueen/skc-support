import{_ as W,r as v,a as k,l as X,x as Y,b as x,c as a,d as i,w as t,e as _,m as R,j as c,f as Z,o as u,h as s,t as o,p as f,q as T,F as C,n as $,A as h}from"./index-CrZnNwoR.js";import{P as ee}from"./index-B4u0WGUb.js";import{a as te,b as ae}from"./enum-Ciewj-1_.js";const se={class:"task-audit-detail content-container"},oe={class:"detail-container"},le={class:"detail-section"},ne={class:"detail-section"},re={class:"detail-section"},de={class:"detail-section"},ie={class:"footer-btns"},ce={class:"left"},ue={class:"right"},me={__name:"detail",setup(_e){const w=Y(),A=Z(),g=v(!1),S=v(!1),p=v(""),m=k({}),r=k({}),b=k({}),L=async()=>{try{const l=await h("taskSubmitted.batchResolve",{ids:[w.params.id]});l.code===0?(c.success("审核通过成功"),A.back()):c.error(l.message)}catch{c.error("审核通过失败")}},E=()=>{p.value="",g.value=!0},V=async()=>{if(!p.value){c.error("请输入拒绝原因");return}try{S.value=!0;const l=await h("taskSubmitted.batchReject",{ids:[w.params.id],reason:p.value});l.code===0?(c.success("审核拒绝成功"),g.value=!1,A.back()):c.error(l.message)}catch{c.error("审核拒绝失败")}finally{S.value=!1}},q=()=>{},B=()=>{},D=async l=>{try{const e=await R("task.detail",{params:{id:l}});e.code===0?Object.assign(r,e.data):c.error(e.message)}catch{c.error("获取任务详情失败")}},M=async l=>{try{const e=await R("member.detail",{params:{id:l}});e.code===0?Object.assign(b,e.data):c.error(e.message)}catch{c.error("获取会员详情失败")}},F=async l=>{try{const e=await R("taskSubmitted.detail",{params:{id:l}});e.code===0&&(Object.assign(m,e.data),e.data.relatedTaskId&&await D(e.data.relatedTaskId),e.data.relatedMemberId&&await M(e.data.relatedMemberId))}catch{c.error("获取详情失败")}},P=v([]),I=k({}),J=async()=>{const l=await te();P.value=Object.values(l),Object.values(l).map(e=>{I[e.value]=e.text})},U=v([]),N=k({}),G=async()=>{const l=await ae();U.value=Object.values(l),Object.values(l).map(e=>{N[e.value]=e.text})};return X(()=>{J(),G(),F(w.params.id)}),(l,e)=>{const n=_("a-descriptions-item"),y=_("a-descriptions"),H=_("a-tag"),Q=_("a-image"),j=_("a-button"),O=_("a-space"),z=_("a-textarea"),K=_("a-modal");return u(),x("div",se,[a(ee,{title:"任务审核详情",back:!0}),i("div",oe,[i("div",le,[e[2]||(e[2]=i("div",{class:"section-title"},"任务信息",-1)),a(y,{column:2},{default:t(()=>[a(n,{label:"任务名称"},{default:t(()=>[s(o(r.taskName),1)]),_:1}),a(n,{label:"平台渠道"},{default:t(()=>[s(o(r.channelName),1)]),_:1}),a(n,{label:"达人领域"},{default:t(()=>[s(o(r.category),1)]),_:1}),a(n,{label:"任务类型"},{default:t(()=>[s(o(I[r.type]),1)]),_:1}),a(n,{label:"任务奖励"},{default:t(()=>[s(o(r.reward)+" 元",1)]),_:1}),a(n,{label:"品牌"},{default:t(()=>[s(o(r.brand),1)]),_:1}),a(n,{label:"指定群组"},{default:t(()=>{var d;return[s(o((d=r.groupNames)==null?void 0:d.join("、")),1)]}),_:1}),a(n,{label:"任务时间"},{default:t(()=>[s(o(r.startTime)+" 至 "+o(r.endTime),1)]),_:1}),a(n,{label:"任务名额"},{default:t(()=>[s(o(r.unlimitedQuota?"不限制":r.quota),1)]),_:1}),a(n,{label:"粉丝要求"},{default:t(()=>[s(o(r.fansRequired)+" 粉丝",1)]),_:1}),a(n,{label:"作品要求"},{default:t(()=>[s(o(r.contentRequirement),1)]),_:1}),a(n,{label:"任务信息"},{default:t(()=>[s(o(r.taskInfo),1)]),_:1})]),_:1})]),i("div",ne,[e[4]||(e[4]=i("div",{class:"section-title"},"会员信息",-1)),a(y,{column:2},{default:t(()=>[a(n,{label:"会员昵称"},{default:t(()=>[s(o(b.nickname),1)]),_:1}),a(n,{label:"账号"},{default:t(()=>[s(o(b.account),1)]),_:1}),a(n,{label:"所属群"},{default:t(()=>[s(o(b.groupName)+" ",1),b.isGroupOwner?(u(),f(H,{key:0,color:"blue"},{default:t(()=>e[3]||(e[3]=[s("群主")])),_:1})):T("",!0)]),_:1})]),_:1})]),i("div",re,[e[5]||(e[5]=i("div",{class:"section-title"},"提交信息",-1)),a(y,{column:2},{default:t(()=>[(u(!0),x(C,null,$(r.customFields,d=>(u(),f(n,{key:d.title,label:d.title},{default:t(()=>[d.type==="image"?(u(),f(Q,{key:0,src:d.value,width:120},null,8,["src"])):(u(),x(C,{key:1},[s(o(d.value),1)],64))]),_:2},1032,["label"]))),128))]),_:1})]),i("div",de,[e[6]||(e[6]=i("div",{class:"section-title"},"审核信息",-1)),a(y,{column:2},{default:t(()=>[a(n,{label:"报名时间"},{default:t(()=>[s(o(m.applyTime),1)]),_:1}),a(n,{label:"提交时间"},{default:t(()=>[s(o(m.submitTime),1)]),_:1}),a(n,{label:"审核状态"},{default:t(()=>[s(o(N[m.taskAuditStatus]),1)]),_:1}),m.taskAuditStatus==="rejected"?(u(),f(n,{key:0,label:"拒绝原因"},{default:t(()=>[s(o(m.rejectReason),1)]),_:1})):T("",!0)]),_:1})]),i("div",ie,[i("div",ce,[a(O,null,{default:t(()=>[m.taskAuditStatus==="pending"?(u(),f(j,{key:0,type:"primary",onClick:L},{default:t(()=>e[7]||(e[7]=[s(" 审核通过 ")])),_:1})):T("",!0),m.taskAuditStatus==="pending"?(u(),f(j,{key:1,danger:"",onClick:E},{default:t(()=>e[8]||(e[8]=[s(" 审核拒绝 ")])),_:1})):T("",!0)]),_:1})]),i("div",ue,[a(O,null,{default:t(()=>[a(j,{onClick:q},{default:t(()=>e[9]||(e[9]=[s("上一个")])),_:1}),a(j,{onClick:B},{default:t(()=>e[10]||(e[10]=[s("下一个")])),_:1})]),_:1})])])]),a(K,{open:g.value,"onUpdate:open":e[1]||(e[1]=d=>g.value=d),title:"拒绝原因",onOk:V,confirmLoading:S.value},{default:t(()=>[a(z,{value:p.value,"onUpdate:value":e[0]||(e[0]=d=>p.value=d),placeholder:"请输入拒绝原因",rows:4},null,8,["value"])]),_:1},8,["open","confirmLoading"])])}}},ve=W(me,[["__scopeId","data-v-62ddc3c1"]]);export{ve as default};

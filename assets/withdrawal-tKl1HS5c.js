import{W as ne,l as se,m as oe}from"./enums-Vx4wKXVy.js";import{g as Y,p as N}from"./request-BJ0l3KV0.js";import{_ as le,i as re,r as m,a as B,j as ce,b as H,d as f,c as t,w as n,e as r,k as o,o as y,F as ie,l as ue,g as S,m as D,h as d,t as k,D as me,n as z}from"./index-CBTOl_WJ.js";const de={class:"withdrawal content-container"},pe={class:"table-container"},_e={class:"table-header"},fe={class:"left"},ve={class:"right"},ge=["onClick"],ye={__name:"withdrawal",setup(he){const{t:ke,locale:L}=re(),b=m(!1),w=m(null),i=m([]),v=m(!1),C=m(!1),p=m(""),l=B({memberNickname:"",status:void 0,timeRange:[]}),M=[{title:"会员名称",dataIndex:"memberNickname",key:"memberNickname"},{title:"提现账户",dataIndex:"memberAccount",key:"memberAccount"},{title:"账户类型",dataIndex:"memberAccountType",key:"memberAccountType"},{title:"申请提现金额",dataIndex:"amount",key:"amount",align:"right"},{title:"真实姓名",dataIndex:"realName",key:"realName"},{title:"申请时间",dataIndex:"applyTime",key:"applyTime"},{title:"提现状态",dataIndex:"status",key:"status"},{title:"操作",key:"action",width:150}],I=m([]),u=B({current:1,pageSize:10,total:0}),T=a=>{var e;return((e=oe[a])==null?void 0:e[L.value])||a},j=()=>{u.current=1,_()},O=()=>{Object.assign(l,{memberNickname:"",status:void 0,timeRange:[]}),j()},U=a=>{Object.assign(u,a),_()},V=a=>{i.value=a},W=async()=>{const a=await Y("settlement.withdrawalExport",{params:{page:u.current,pageSize:u.pageSize,...l}});a.success?o.success("导出成功"):o.error(a.message)},A=async a=>{try{const e=await N("settlement.batchResolve",{ids:[a.id]});e.success?(o.success("操作成功"),_()):o.error(e.message)}catch{o.error("操作失败")}},$=async()=>{if(!i.value.length){o.warning("请选择要操作的记录");return}try{const a=await N("settlement.batchResolve",{ids:i.value});a.success?(o.success("操作成功"),i.value=[],_()):o.error(a.message)}catch{o.error("操作失败")}},E=a=>{w.value=a,p.value="",v.value=!0},F=()=>{if(!i.value.length){o.warning("请选择要操作的记录");return}p.value="",v.value=!0},K=async()=>{if(!p.value){o.error("请输入打款失败原因");return}try{C.value=!0;const a={failReason:p.value,ids:w.value?[w.value.id]:i.value},e=await N("settlement.batchReject",a);e.success?(o.success("操作成功"),v.value=!1,i.value=[],_()):o.error(e.message)}catch{o.error("操作失败")}finally{C.value=!1}},_=async()=>{var a,e;b.value=!0;try{const R={page:u.current,pageSize:u.pageSize,memberNickname:l.memberNickname,status:l.status,startTime:(a=l.timeRange)==null?void 0:a[0],endTime:(e=l.timeRange)==null?void 0:e[1]},c=await Y("settlement.withdrawal",{params:R});c.success?(I.value=c.data.list||[],u.total=c.data.total||0):o.error(c.message)}finally{b.value=!1}};return ce(()=>{_()}),(a,e)=>{const R=r("a-input"),c=r("a-form-item"),q=r("a-select-option"),G=r("a-select"),J=r("a-range-picker"),g=r("a-button"),x=r("a-space"),P=r("a-form"),Q=r("a-tag"),X=r("a-popconfirm"),Z=r("a-table"),ee=r("a-textarea"),ae=r("a-modal");return y(),H("div",de,[f("div",pe,[f("div",_e,[f("div",fe,[t(P,{layout:"inline",model:l},{default:n(()=>[t(c,{label:"会员名称"},{default:n(()=>[t(R,{value:l.memberNickname,"onUpdate:value":e[0]||(e[0]=s=>l.memberNickname=s),placeholder:"请输入会员名称","allow-clear":""},null,8,["value"])]),_:1}),t(c,{label:"提现状态"},{default:n(()=>[t(G,{value:l.status,"onUpdate:value":e[1]||(e[1]=s=>l.status=s),placeholder:"请选择状态",style:{width:"120px"},"allow-clear":""},{default:n(()=>[(y(!0),H(ie,null,ue(Object.values(S(ne)),s=>(y(),D(q,{key:s,value:s},{default:n(()=>[d(k(T(s)),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),t(c,{label:"申请时间"},{default:n(()=>[t(J,{value:l.timeRange,"onUpdate:value":e[2]||(e[2]=s=>l.timeRange=s),"show-time":{format:"HH:mm"},format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["value"])]),_:1}),t(c,null,{default:n(()=>[t(x,null,{default:n(()=>[t(g,{type:"primary",onClick:j},{default:n(()=>[d(k(a.$t("common.search")),1)]),_:1}),t(g,{onClick:O},{default:n(()=>[d(k(a.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),f("div",ve,[t(x,null,{default:n(()=>[t(g,{type:"primary",onClick:W},{icon:n(()=>[t(S(me))]),default:n(()=>[e[5]||(e[5]=d(" 导出 "))]),_:1}),t(g,{type:"primary",onClick:$},{default:n(()=>e[6]||(e[6]=[d("批量已打款")])),_:1}),t(g,{danger:"",onClick:F},{default:n(()=>e[7]||(e[7]=[d("批量打款失败")])),_:1})]),_:1})])]),t(Z,{columns:M,"data-source":I.value,loading:b.value,pagination:u,"row-selection":{selectedRowKeys:i.value,onChange:V},onChange:U},{bodyCell:n(({column:s,record:h})=>[s.key==="status"?(y(),D(Q,{key:0,color:S(se)[h.status]},{default:n(()=>[d(k(T(h.status)),1)]),_:2},1032,["color"])):z("",!0),s.key==="action"?(y(),D(x,{key:1},{default:n(()=>[t(X,{title:"确定要标记为已打款吗？",onConfirm:te=>A(h)},{default:n(()=>e[8]||(e[8]=[f("a",null,"已打款",-1)])),_:2},1032,["onConfirm"]),f("a",{class:"danger",onClick:te=>E(h)},"打款失败",8,ge)]),_:2},1024)):z("",!0)]),_:1},8,["data-source","loading","pagination","row-selection"])]),t(ae,{open:v.value,"onUpdate:open":e[4]||(e[4]=s=>v.value=s),title:"打款失败原因",onOk:K,confirmLoading:C.value},{default:n(()=>[t(ee,{value:p.value,"onUpdate:value":e[3]||(e[3]=s=>p.value=s),placeholder:"请输入打款失败原因",rows:4},null,8,["value"])]),_:1},8,["open","confirmLoading"])])}}},Re=le(ye,[["__scopeId","data-v-3de189bc"]]);export{Re as default};

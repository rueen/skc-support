import{_ as de,j as ce,r as p,b as h,k as me,B as _e,l as pe,x as fe,d as f,c as e,e as o,w as t,f as d,F as M,p as q,m as v,o as m,h as I,U as ve,t as u,i,s as k,q as R,A as G,n as y}from"./index-DVh1u51G.js";import{P as be}from"./PageHeader-C0xe1VFA.js";import{_ as N}from"./CopyContent-CMFET0cI.js";const ge={class:"member-view content-container"},we={class:"detail-container"},ke={class:"section"},ye={key:0},xe={key:0},Ce={class:"section"},he={class:"account-list"},Se={class:"link-text-container",style:{"max-width":"300px"}},Ie=["href"],Re={class:"section",style:{"padding-bottom":"24px"}},Te={class:"section",style:{"padding-bottom":"24px"}},Ae={class:"section"},Ue={__name:"view",setup(Pe){const T=ce(),H=fe(),c=p(""),s=h({}),B=p([]),W=me(()=>`${_e.h5Url}?inviteCode=${s.inviteCode}`),A=h({}),U=h({}),P=h({}),E=p(),b=p(!1),x=p("grant"),_=h({amount:"",remark:""}),C=p(!1),J=p({amount:[{required:!0,message:"请输入奖励金额"}],remark:[{required:!0,message:"请输入备注"}]}),K=async()=>{const a=await v("member.detail",{},{urlParams:{id:c.value}});a.code===0&&Object.assign(s,a.data||{})},F=async()=>{const a=await v("member.balance",{},{urlParams:{memberId:c.value}});a.code===0&&(s.balance=a.data.balance)},Q=async()=>{const a=await v("member.withdrawalsAccount",{},{urlParams:{memberId:c.value}});a.code===0&&(s.withdrawalsAccount=a.data[0]||{})},X=async()=>{const a=await v("account.list",{memberId:c.value});a.code===0&&(B.value=a.data.list||[])},Y=async()=>{const a=await v("member.taskStats",{},{urlParams:{memberId:c.value}});a.code===0&&Object.assign(A,a.data||{})},Z=async()=>{const a=await v("member.inviteStats",{},{urlParams:{memberId:c.value}});a.code===0&&Object.assign(U,a.data||{})},ee=async()=>{const a=await v("member.groupsStats",{},{urlParams:{memberId:c.value}});a.code===0&&Object.assign(P,a.data||{})},te=()=>{b.value=!0,x.value="grant"},ae=()=>{b.value=!0,x.value="deduct"},le=async()=>{C.value=!0;try{const a=await G("member.grantReward",{memberId:c.value,amount:_.amount,remark:_.remark});a.code===0?(y.success("奖励发放成功"),b.value=!1,F()):y.error(a.message)}catch{y.error("奖励发放失败")}finally{C.value=!1}},ne=async()=>{C.value=!0;try{const a=await G("member.deductReward",{memberId:c.value,amount:_.amount,remark:_.remark},{urlParams:{memberId:c.value}});a.code===0?(y.success("奖励扣除成功"),b.value=!1,F()):y.error(a.message)}catch{y.error("奖励扣除失败")}finally{C.value=!1}},se=async()=>{switch(await E.value.validate(),x.value){case"grant":le();break;case"deduct":ne();break}};return pe(()=>{c.value=H.params.id,K(),F(),X(),Y(),Z(),ee(),Q()}),(a,n)=>{const L=d("a-avatar"),S=d("a-space"),r=d("a-descriptions-item"),j=d("a-tag"),V=d("a-button"),$=d("a-descriptions"),g=d("a-statistic"),w=d("a-col"),O=d("a-row"),oe=d("a-input"),z=d("a-form-item"),re=d("a-textarea"),ue=d("a-form"),ie=d("a-modal");return m(),f("div",ge,[e(be,{title:"会员详情",back:!0}),o("div",we,[o("div",ke,[n[8]||(n[8]=o("div",{class:"section-title"},"会员信息",-1)),e($,{column:2},{default:t(()=>[e(r,{label:"会员昵称"},{default:t(()=>[e(S,null,{default:t(()=>[e(L,{src:s.avatar,size:"small"},{icon:t(()=>[e(I(ve))]),_:1},8,["src"]),o("span",null,u(s.nickname),1)]),_:1})]),_:1}),e(r,{label:"会员账号"},{default:t(()=>[i(u(s.account),1)]),_:1}),e(r,{label:"性别"},{default:t(()=>[i(u(I(T).getEnumText("GenderType",s.gender)),1)]),_:1}),e(r,{label:"职业"},{default:t(()=>[i(u(I(T).getEnumText("OccupationType",s.occupation))+" ",1),s.occupation===null?(m(),f("span",ye," - ")):k("",!0)]),_:1}),e(r,{label:"电子邮箱"},{default:t(()=>[i(u(s.email||"-"),1)]),_:1}),e(r,{label:"手机号码"},{default:t(()=>[i(u(s.phone||"-"),1)]),_:1}),e(r,{label:"Telegram"},{default:t(()=>[i(u(s.telegram||"-"),1)]),_:1}),e(r,{label:"所属群组"},{default:t(()=>[(m(!0),f(M,null,q(s.groups,l=>(m(),f("div",{key:l.id},[i(u(l.groupName)+" ",1),l.isOwner?(m(),R(j,{key:0,color:"blue",style:{"margin-left":"8px"}},{default:t(()=>n[5]||(n[5]=[i("群主")])),_:1})):k("",!0)]))),128)),!s.groups||!s.groups.length?(m(),f("span",xe,"未加入群组")):k("",!0)]),_:1}),e(r,{label:"邀请人"},{default:t(()=>[i(u(s.inviterNickname||"-"),1)]),_:1}),e(r,{label:"邀请链接"},{default:t(()=>[e(N,{content:W.value},null,8,["content"])]),_:1}),e(r,{label:"提现账号"},{default:t(()=>[e(S,null,{default:t(()=>{var l,D;return[o("span",null,u(((l=s==null?void 0:s.withdrawalsAccount)==null?void 0:l.paymentChannelName)||"-"),1),o("span",null,u(((D=s==null?void 0:s.withdrawalsAccount)==null?void 0:D.account)||"-"),1)]}),_:1})]),_:1}),e(r,{label:"账户余额"},{default:t(()=>[e(S,null,{default:t(()=>[o("span",null,u(s.balance),1),e(V,{type:"link",size:"small",onClick:n[0]||(n[0]=l=>te())},{default:t(()=>n[6]||(n[6]=[i(" 奖励发放 ")])),_:1}),e(V,{type:"link",size:"small",onClick:n[1]||(n[1]=l=>ae())},{default:t(()=>n[7]||(n[7]=[i(" 奖励扣除 ")])),_:1})]),_:1})]),_:1})]),_:1})]),o("div",Ce,[n[9]||(n[9]=o("div",{class:"section-title"},"账号信息",-1)),o("div",he,[(m(!0),f(M,null,q(B.value,l=>(m(),f("div",{key:l.channelId},[e($,{column:1},{default:t(()=>[e(r,{label:"账号"},{default:t(()=>[e(S,null,{default:t(()=>[e(L,{src:l.channelIcon,size:"small"},null,8,["src"]),o("span",null,u(l.account),1),e(j,{color:"warning"},{default:t(()=>[i(u(I(T).getEnumText("AccountAuditStatus",l.accountAuditStatus)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),e(r,{label:"主页"},{default:t(()=>[e(N,{content:l.homeUrl},{default:t(()=>[o("div",Se,[o("a",{href:l.homeUrl,target:"_blank",class:"link-text"},u(l.homeUrl),9,Ie)])]),_:2},1032,["content"])]),_:2},1024),e(r,{label:"uid"},{default:t(()=>[e(N,{content:l.uid},null,8,["content"])]),_:2},1024),l.channelCustomFields.includes("fansCount")?(m(),R(r,{key:0,label:"粉丝数"},{default:t(()=>[i(u(l.fansCount),1)]),_:2},1024)):k("",!0),l.channelCustomFields.includes("friendsCount")?(m(),R(r,{key:1,label:"好友数"},{default:t(()=>[i(u(l.friendsCount),1)]),_:2},1024)):k("",!0),l.channelCustomFields.includes("postsCount")?(m(),R(r,{key:2,label:"发帖数"},{default:t(()=>[i(u(l.postsCount),1)]),_:2},1024)):k("",!0)]),_:2},1024)]))),128))])]),o("div",Re,[n[10]||(n[10]=o("div",{class:"section-title"},"任务信息",-1)),e(O,{gutter:16},{default:t(()=>[e(w,{span:6},{default:t(()=>[e(g,{title:"完成任务次数",value:A.completedTaskCount},null,8,["value"])]),_:1}),e(w,{span:6},{default:t(()=>[e(g,{title:"任务奖励",value:A.totalTaskReward,precision:2,prefix:"¥"},null,8,["value"])]),_:1})]),_:1})]),o("div",Te,[n[11]||(n[11]=o("div",{class:"section-title"},"邀请信息",-1)),e(O,null,{default:t(()=>[e(w,{span:6},{default:t(()=>[e(g,{title:"累计邀请",value:U.inviteCount},null,8,["value"])]),_:1}),e(w,{span:6},{default:t(()=>[e(g,{title:"邀请奖励",value:U.totalReward,prefix:"¥"},null,8,["value"])]),_:1})]),_:1})]),o("div",Ae,[n[12]||(n[12]=o("div",{class:"section-title"},"群组信息",-1)),e(O,null,{default:t(()=>[e(w,{span:6},{default:t(()=>[e(g,{title:"管理群数量",value:P.groupCount},null,8,["value"])]),_:1}),e(w,{span:6},{default:t(()=>[e(g,{title:"群收益",value:P.totalEarnings,prefix:"¥"},null,8,["value"])]),_:1})]),_:1})])]),e(ie,{open:b.value,"onUpdate:open":n[4]||(n[4]=l=>b.value=l),title:x.value==="grant"?"奖励发放":"奖励扣除",onOk:se,confirmLoading:C.value},{default:t(()=>[e(ue,{ref_key:"rewardFormRef",ref:E,model:_,rules:J.value,"label-col":{span:6},"wrapper-col":{span:16}},{default:t(()=>[e(z,{label:x.value==="grant"?"奖励金额":"扣除金额",name:"amount"},{default:t(()=>[e(oe,{value:_.amount,"onUpdate:value":n[2]||(n[2]=l=>_.amount=l)},null,8,["value"])]),_:1},8,["label"]),e(z,{label:"备注",name:"remark"},{default:t(()=>[e(re,{value:_.remark,"onUpdate:value":n[3]||(n[3]=l=>_.remark=l),rows:4},null,8,["value"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["open","title","confirmLoading"])])}}},Be=de(Ue,[["__scopeId","data-v-d0ae2070"]]);export{Be as default};

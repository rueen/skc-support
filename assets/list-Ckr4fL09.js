import{_ as W,i as X,r as N,b as V,x as Y,k as Z,c,d as l,e as n,w as t,f as r,l as A,m as y,g as ee,o,F as g,n as x,p as S,h as d,t as p,q as f,s as te,v as ae}from"./index-ByCb6rGy.js";import{_ as ne}from"./CopyContent-Caft-xTU.js";const oe={class:"member-list content-container"},se={class:"table-container"},le={class:"table-header"},ie={class:"left"},re={class:"right"},ce={key:0,style:{display:"inline-block"}},ue={class:"link-text-container"},de=["href"],pe={key:0},me=["onClick"],_e=["onClick"],fe={__name:"list",setup(ge){const B=X(),h=ee(),D=Y(),b=N(!1),m=V({memberNickname:"",groupId:D.query.groupId}),I=N([]),_=V({current:1,pageSize:10,total:0}),$=N([]),E=[{title:"会员昵称",dataIndex:"nickname",key:"nickname"},{title:"账号",dataIndex:"account",key:"account"},{title:"渠道账号信息",key:"accountList"},{title:"邀请人",key:"inviterNickname"},{title:"所属群组",key:"groups"},{title:"更新时间",dataIndex:"updateTime",key:"updateTime",width:180},{title:"操作",key:"action",fixed:"right",width:150}],z=()=>{_.current=1,k()},L=()=>{Object.assign(m,{memberNickname:"",groupId:void 0}),z()},O=a=>{_.current=a.current,_.pageSize=a.pageSize,k()},F=()=>{h.push("/member/create")},R=a=>{h.push(`/member/edit/${a.id}`)},q=a=>{h.push(`/member/view/${a.id}`)},j=async a=>{const e=await ae("member.delete",{},{urlParams:{id:a.id}});e.code===0?(y.success("删除成功"),k()):y.error(e.message)},k=async()=>{b.value=!0;try{const a=await A("member.list",{page:_.current,pageSize:_.pageSize,...m});a.code===0?(I.value=a.data.list,_.total=a.data.total):y.error(a.message)}finally{b.value=!1}},T=async(a="")=>{try{const e=await A("group.list",{page:1,pageSize:50,groupName:a});e.code===0&&($.value=e.data.list||[])}catch{y.error("获取群组列表失败")}};return Z(()=>{k(),T()}),(a,e)=>{const G=r("a-input"),w=r("a-form-item"),M=r("a-select-option"),P=r("a-select"),C=r("a-button"),v=r("a-space"),H=r("a-form"),J=r("plus-outlined"),U=r("a-tag"),K=r("a-popconfirm"),Q=r("a-table");return o(),c("div",oe,[l("div",se,[l("div",le,[l("div",ie,[n(H,{layout:"inline",model:m},{default:t(()=>[n(w,{label:"会员昵称"},{default:t(()=>[n(G,{value:m.memberNickname,"onUpdate:value":e[0]||(e[0]=s=>m.memberNickname=s),placeholder:"请输入会员昵称","allow-clear":""},null,8,["value"])]),_:1}),n(w,{label:"所属群组"},{default:t(()=>[n(P,{value:m.groupId,"onUpdate:value":e[1]||(e[1]=s=>m.groupId=s),placeholder:"请选择群组","allow-clear":"","show-search":"","filter-option":!1,onSearch:T,style:{width:"200px"}},{default:t(()=>[(o(!0),c(g,null,x($.value,s=>(o(),S(M,{key:s.id,value:s.id},{default:t(()=>[d(p(s.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),n(w,null,{default:t(()=>[n(v,null,{default:t(()=>[n(C,{type:"primary",onClick:z},{default:t(()=>[d(p(a.$t("common.search")),1)]),_:1}),n(C,{onClick:L},{default:t(()=>[d(p(a.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),l("div",re,[n(v,null,{default:t(()=>[n(C,{type:"primary",onClick:F},{icon:t(()=>[n(J)]),default:t(()=>[e[2]||(e[2]=d(" 新增会员 "))]),_:1})]),_:1})])]),n(Q,{columns:E,"data-source":I.value,loading:b.value,pagination:_,onChange:O},{bodyCell:t(({column:s,record:u})=>[s.key==="accountList"?(o(),c("div",ce,[(o(!0),c(g,null,x(u.accountList,i=>(o(),c("div",null,[l("div",null,[n(v,null,{default:t(()=>[d(" 账号："+p(i.account)+" ",1),n(U,{color:"warning"},{default:t(()=>[d(p(te(B).getEnumText("AccountAuditStatus",i.accountAuditStatus)),1)]),_:2},1024)]),_:2},1024)]),l("div",ue,[e[3]||(e[3]=l("span",{class:"label"},"主页：",-1)),n(ne,{content:i.homeUrl},{default:t(()=>[l("a",{href:i.homeUrl,target:"_blank",class:"link-text"},p(i.homeUrl),9,de)]),_:2},1032,["content"])])]))),256))])):f("",!0),s.key==="inviterNickname"?(o(),c(g,{key:1},[d(p(u.inviterNickname||"--"),1)],64)):f("",!0),s.key==="groups"?(o(),c(g,{key:2},[(o(!0),c(g,null,x(u.groups,i=>(o(),c("div",null,[l("span",null,p(i.groupName),1),i.isOwner?(o(),S(U,{key:0,color:"blue",style:{"margin-left":"10px"}},{default:t(()=>e[4]||(e[4]=[d("群主")])),_:1})):f("",!0)]))),256)),!u.groups||u.groups.length===0?(o(),c("span",pe,"--")):f("",!0)],64)):f("",!0),s.key==="action"?(o(),S(v,{key:3},{default:t(()=>[l("a",{onClick:i=>R(u)},"编辑",8,me),l("a",{onClick:i=>q(u)},"查看",8,_e),n(K,{title:"确定要删除吗？",onConfirm:i=>j(u)},{default:t(()=>e[5]||(e[5]=[l("a",{class:"danger"},"删除",-1)])),_:2},1032,["onConfirm"])]),_:2},1024)):f("",!0)]),_:1},8,["data-source","loading","pagination"])])])}}},ye=W(fe,[["__scopeId","data-v-ea7722e2"]]);export{ye as default};

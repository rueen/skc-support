import{g as v,p as I}from"./request-DOBaHtSR.js";import{_ as L,r as c,a as N,j as U,b as q,d as m,c as n,w as s,e as l,o as y,m as E,n as M,k as g}from"./index-CEaSLPqZ.js";const O={class:"article content-container"},P={class:"table-container"},j=["onClick"],z={class:"editor-wrapper"},$={__name:"index",setup(F){const d=c(!1),i=c(!1),u=c(!1),p=c(),t=N({id:null,title:"",content:""}),k={title:[{required:!0,message:"请输入文章标题"}],content:[{required:!0,message:"请输入文章内容"}]},b=[{title:"文章标题",dataIndex:"title",key:"title"},{title:"更新时间",dataIndex:"updatedAt",key:"updatedAt"},{title:"操作",key:"action",width:100}],_=c([]),w=e=>{t.id=e.id,t.title=e.title,t.content=e.content,i.value=!0},x=async()=>{p.value.validate().then(async()=>{u.value=!0;try{const e=await I("article.edit",{location:t.location,...t});e.success?(g.success("保存成功"),i.value=!1):g.error(e.message)}catch(e){console.error(e)}finally{u.value=!1}})},h=async()=>{d.value=!0;try{let e=[];const a=await v("article.get",{params:{location:"userAgreement"}});a.success&&e.push(a.data||{});const r=await v("article.get",{params:{location:"privacyPolicy"}});r.success&&e.push(r.data||{}),_.value=e}finally{d.value=!1}};return U(()=>{h()}),(e,a)=>{const r=l("a-space"),C=l("a-table"),R=l("a-input"),f=l("a-form-item"),A=l("a-textarea"),B=l("a-form"),V=l("a-modal");return y(),q("div",O,[m("div",P,[n(C,{columns:b,"data-source":_.value,loading:d.value,pagination:!1},{bodyCell:s(({column:o,record:D})=>[o.key==="action"?(y(),E(r,{key:0},{default:s(()=>[m("a",{onClick:G=>w(D)},"编辑",8,j)]),_:2},1024)):M("",!0)]),_:1},8,["data-source","loading"])]),n(V,{open:i.value,"onUpdate:open":a[2]||(a[2]=o=>i.value=o),title:"编辑文章",width:800,confirmLoading:u.value,onOk:x},{default:s(()=>[n(B,{ref_key:"formRef",ref:p,model:t,rules:k,"label-col":{span:4},"wrapper-col":{span:19}},{default:s(()=>[n(f,{label:"文章标题",name:"title"},{default:s(()=>[n(R,{value:t.title,"onUpdate:value":a[0]||(a[0]=o=>t.title=o),placeholder:"请输入文章标题"},null,8,["value"])]),_:1}),n(f,{label:"文章内容",name:"content"},{default:s(()=>[m("div",z,[n(A,{value:t.content,"onUpdate:value":a[1]||(a[1]=o=>t.content=o),placeholder:"请输入文章内容","auto-size":{minRows:10,maxRows:20}},null,8,["value"])])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","confirmLoading"])])}}},K=L($,[["__scopeId","data-v-9b4f64ac"]]);export{K as default};

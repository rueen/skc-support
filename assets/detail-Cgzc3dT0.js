import{r as c,b as V,c as A,k as I,d as j,f as l,e as z,w as o,g as r,x as E,l as O,m as b,h as S,o as f,p as C,s as _,i as y,t as g,z as T}from"./index-By25O0OS.js";import{P as G}from"./PageHeader-CaiTP2yj.js";import{d as H}from"./routeParamsEncryption-BKFTaOaF.js";const L={class:"content-container"},M={class:"form-container"},X={__name:"detail",setup(J){const i=E(),$=S(),U=c(),{t:h}=V(),d=c({}),m=c([]),B=c(null),P=()=>{const e=i.query.filters;e&&(B.value=H(e))},t=A({homeUrl:"",uid:"",account:"",fansCount:"",friendsCount:"",postsCount:""}),q={memberAccount:[{required:!0,message:h("member.detail.memberAccountPlaceholder")}]},w=async()=>{const e=await O("account.detail",{},{urlParams:{id:i.params.id}});e.code===0?(Object.assign(t,e.data),d.value=e.data,m.value=e.data.channelCustomFields):b.error(e.message)},p=c(!1),D=()=>{U.value.validate().then(async()=>{try{const e={};Object.keys(t).forEach(a=>{t[a]!=null&&(["account","homeUrl","uid"].includes(a)?e[a]=t[a].trim():e[a]=t[a])}),p.value=!0,await T("account.edit",e,{urlParams:{id:d.value.id}}),b.success("success"),v()}catch(e){console.log(e),b.error("submit failed")}finally{p.value=!1}})},v=()=>{const e={};i.query.filters&&(e.filters=i.query.filters),$.push({path:"/account",query:e})};return I(async()=>{P(),w()}),(e,a)=>{const F=r("a-avatar"),s=r("a-form-item"),u=r("a-input"),k=r("a-button"),N=r("a-space"),R=r("a-form");return f(),j("div",L,[l(G,{title:e.$t("account.detail.editTitle"),back:!0,useDefaultBack:!1,onBack:v},null,8,["title"]),z("div",M,[l(R,{ref_key:"formRef",ref:U,model:t,rules:q,"label-col":{span:6},"wrapper-col":{span:16}},{default:o(()=>[l(s,{label:e.$t("account.detail.platform"),name:"platform"},{default:o(()=>[l(F,{src:d.value.channelIcon,size:"small"},null,8,["src"]),y(" "+g(d.value.channelName),1)]),_:1},8,["label"]),l(s,{label:e.$t("account.detail.account"),name:"account"},{default:o(()=>[l(u,{value:t.account,"onUpdate:value":a[0]||(a[0]=n=>t.account=n)},null,8,["value"])]),_:1},8,["label"]),l(s,{label:e.$t("account.detail.homepage"),name:"homeUrl"},{default:o(()=>[l(u,{value:t.homeUrl,"onUpdate:value":a[1]||(a[1]=n=>t.homeUrl=n)},null,8,["value"])]),_:1},8,["label"]),l(s,{label:"UID",name:"uid"},{default:o(()=>[l(u,{value:t.uid,"onUpdate:value":a[2]||(a[2]=n=>t.uid=n)},null,8,["value"])]),_:1}),m.value.includes("fansCount")?(f(),C(s,{key:0,label:e.$t("account.detail.fansCount"),name:"fansCount"},{default:o(()=>[l(u,{value:t.fansCount,"onUpdate:value":a[3]||(a[3]=n=>t.fansCount=n)},null,8,["value"])]),_:1},8,["label"])):_("",!0),m.value.includes("friendsCount")?(f(),C(s,{key:1,label:e.$t("account.detail.friendsCount"),name:"friendsCount"},{default:o(()=>[l(u,{value:t.friendsCount,"onUpdate:value":a[4]||(a[4]=n=>t.friendsCount=n)},null,8,["value"])]),_:1},8,["label"])):_("",!0),m.value.includes("postsCount")?(f(),C(s,{key:2,label:e.$t("account.detail.postsCount"),name:"postsCount"},{default:o(()=>[l(u,{value:t.postsCount,"onUpdate:value":a[5]||(a[5]=n=>t.postsCount=n)},null,8,["value"])]),_:1},8,["label"])):_("",!0),l(s,{"wrapper-col":{offset:4}},{default:o(()=>[l(N,null,{default:o(()=>[l(k,{type:"primary",loading:p.value,onClick:D},{default:o(()=>[y(g(e.$t("common.submit")),1)]),_:1},8,["loading"]),l(k,{onClick:a[6]||(a[6]=n=>v())},{default:o(()=>[y(g(e.$t("common.cancel")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])])}}};export{X as default};

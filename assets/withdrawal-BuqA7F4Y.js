import{_ as te,l as ne,m as le,r as p,a as T,n as oe,b as R,d as _,c as t,w as n,e as s,p as Y,j as i,o as g,F as B,q as se,s as I,h as d,t as h,g as E,D as re,v as H,B as O}from"./index-yhsRL5aq.js";const ie={class:"withdrawal content-container"},ce={class:"table-container"},ue={class:"table-header"},de={class:"left"},me={class:"right"},pe=["onClick"],_e={__name:"withdrawal",setup(ve){const y=ne(),z=le(()=>y.loaded?y.getEnumOptions("WithdrawalStatus"):[]),k=p(!1),r=p([]),v=p(!1),x=p(!1),m=p(""),o=T({memberNickname:"",withdrawalStatus:"pending",timeRange:[]}),M=[{title:"会员昵称",dataIndex:"member_nickname",key:"member_nickname"},{title:"提现账户",dataIndex:"memberAccount",key:"memberAccount"},{title:"账户类型",dataIndex:"memberAccountType",key:"memberAccountType"},{title:"申请提现金额",dataIndex:"amount",key:"amount",align:"right"},{title:"姓名",dataIndex:"name",key:"name"},{title:"申请时间",dataIndex:"applyTime",key:"applyTime"},{title:"提现状态",key:"withdrawal_status"},{title:"操作",key:"action",width:150}],N=p([]),u=T({current:1,pageSize:10,total:0}),j=()=>{u.current=1,f()},U=()=>{Object.assign(o,{memberNickname:"",withdrawalStatus:void 0,timeRange:[]}),j()},V=e=>{Object.assign(u,e),f()},A=e=>{r.value=e},L=async()=>{const e=await Y("finance.withdrawalExport",{params:{page:u.current,pageSize:u.pageSize,...o}});e.code===0?i.success("导出成功"):i.error(e.message)},$=async e=>{r.value=[e.id],D()},D=async()=>{if(!r.value.length){i.warning("请选择要操作的记录");return}const e=await O("withdrawals.batchResolve",{ids:r.value});e.code===0?(i.success("操作成功"),r.value=[],f()):i.error(e.message)},F=e=>{r.value=[e.id],m.value="",v.value=!0},K=()=>{if(!r.value.length){i.warning("请选择要操作的记录");return}m.value="",v.value=!0},W=async()=>{if(!m.value){i.error("请输入打款失败原因");return}x.value=!0;const e=await O("withdrawals.batchReject",{rejectReason:m.value,ids:r.value});e.code===0?(i.success("操作成功"),v.value=!1,r.value=[],f()):i.error(e.message)},f=async()=>{var e,a;k.value=!0;try{const b={page:u.current,pageSize:u.pageSize,memberNickname:o.memberNickname,withdrawalStatus:o.withdrawalStatus,startTime:(e=o.timeRange)==null?void 0:e[0],endTime:(a=o.timeRange)==null?void 0:a[1]},c=await Y("withdrawals.list",{...b});c.code===0?(N.value=c.data.list||[],u.total=c.data.total||0):i.error(c.message)}finally{k.value=!1}};return oe(()=>{f()}),(e,a)=>{const b=s("a-input"),c=s("a-form-item"),q=s("a-select-option"),G=s("a-select"),J=s("a-range-picker"),w=s("a-button"),S=s("a-space"),P=s("a-form"),Q=s("a-popconfirm"),X=s("a-table"),Z=s("a-textarea"),ee=s("a-modal");return g(),R("div",ie,[_("div",ce,[_("div",ue,[_("div",de,[t(P,{layout:"inline",model:o},{default:n(()=>[t(c,{label:"会员昵称"},{default:n(()=>[t(b,{value:o.memberNickname,"onUpdate:value":a[0]||(a[0]=l=>o.memberNickname=l),placeholder:"请输入会员昵称","allow-clear":""},null,8,["value"])]),_:1}),t(c,{label:"提现状态"},{default:n(()=>[t(G,{value:o.withdrawalStatus,"onUpdate:value":a[1]||(a[1]=l=>o.withdrawalStatus=l),placeholder:"请选择状态",style:{width:"120px"},"allow-clear":""},{default:n(()=>[(g(!0),R(B,null,se(z.value,l=>(g(),I(q,{key:l.value,value:l.value},{default:n(()=>[d(h(l.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),t(c,{label:"申请时间"},{default:n(()=>[t(J,{value:o.timeRange,"onUpdate:value":a[2]||(a[2]=l=>o.timeRange=l),"show-time":{format:"HH:mm"},format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["value"])]),_:1}),t(c,null,{default:n(()=>[t(S,null,{default:n(()=>[t(w,{type:"primary",onClick:j},{default:n(()=>[d(h(e.$t("common.search")),1)]),_:1}),t(w,{onClick:U},{default:n(()=>[d(h(e.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_("div",me,[t(S,null,{default:n(()=>[t(w,{type:"primary",onClick:L},{icon:n(()=>[t(E(re))]),default:n(()=>[a[5]||(a[5]=d(" 导出 "))]),_:1}),t(w,{type:"primary",onClick:D},{default:n(()=>a[6]||(a[6]=[d("批量已打款")])),_:1}),t(w,{danger:"",onClick:K},{default:n(()=>a[7]||(a[7]=[d("批量打款失败")])),_:1})]),_:1})])]),t(X,{columns:M,"data-source":N.value,loading:k.value,pagination:u,rowKey:"id","row-selection":{selectedRowKeys:r.value,onChange:A},onChange:V},{bodyCell:n(({column:l,record:C})=>[l.key==="withdrawal_status"?(g(),R(B,{key:0},[d(h(E(y).getEnumText("WithdrawalStatus",C.withdrawal_status)),1)],64)):H("",!0),l.key==="action"?(g(),I(S,{key:1},{default:n(()=>[t(Q,{title:"确定要标记为已打款吗？",onConfirm:ae=>$(C)},{default:n(()=>a[8]||(a[8]=[_("a",null,"已打款",-1)])),_:2},1032,["onConfirm"]),_("a",{class:"danger",onClick:ae=>F(C)},"打款失败",8,pe)]),_:2},1024)):H("",!0)]),_:1},8,["data-source","loading","pagination","row-selection"])]),t(ee,{open:v.value,"onUpdate:open":a[4]||(a[4]=l=>v.value=l),title:"打款失败原因",onOk:W,confirmLoading:x.value},{default:n(()=>[t(Z,{value:m.value,"onUpdate:value":a[3]||(a[3]=l=>m.value=l),placeholder:"请输入打款失败原因",rows:4},null,8,["value"])]),_:1},8,["open","confirmLoading"])])}}},we=te(_e,[["__scopeId","data-v-d309ffda"]]);export{we as default};

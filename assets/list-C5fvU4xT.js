import{_ as me,i as fe,j as ve,r as v,b as K,k as _e,c as d,d as i,e as o,w as n,f as r,l as j,m as _,g as ye,o as s,F as g,n as x,p as y,h as p,t as c,s as m,q as ge,A as q,M as he}from"./index-Bx9mD4zV.js";import{_ as P}from"./CopyContent-PVsq7kY9.js";const ke={class:"account content-container"},be={class:"table-container"},we={class:"table-header"},Se={class:"left"},Ce={class:"right"},Ae={style:{"text-align":"left","margin-bottom":"16px"}},Ie={key:1,class:"account-info"},Re={class:"link-text-container"},je=["href"],xe={class:"stats"},Ne={key:0,class:"stat-item"},Oe={key:1,class:"stat-item"},Ue={key:2,class:"stat-item"},ze={key:2},Be={class:"group-name"},Fe={__name:"list",setup($e){const H=ye(),N=fe(),J=ve(()=>N.loaded?N.getEnumOptions("AccountAuditStatus"):[]),O=v(!1),f=v([]),w=v(!1),U=v(!1),h=v(""),u=K({keyword:"",channelId:void 0,accountAuditStatus:"pending",groupId:void 0,memberId:void 0}),F=v([]),$=v([]),V=v([]),z=[{title:"账号名称",key:"account"},{title:"账号详情",key:"accountInfo"},{title:"会员信息",key:"member"},{title:"审核状态",dataIndex:"accountAuditStatus",key:"accountAuditStatus"},{title:"审核员",key:"waiterName"}],Q=[...z,{title:"操作",key:"action"}],W=[...z,{title:"拒绝原因",key:"rejectReason"}],X={selectedRowKeys:f,onChange:t=>{f.value=t},getCheckboxProps:t=>({disabled:t.accountAuditStatus!=="pending"})},E=v([]),k=K({current:1,pageSize:10,total:0}),L=()=>{k.current=1,S()},Y=()=>{u.keyword="",u.channelId=void 0,u.accountAuditStatus=void 0,u.groupId=void 0,u.memberId=void 0,L()},Z=()=>{H.push("/account/old")},ee=t=>{Object.assign(k,{current:t.current,pageSize:t.pageSize}),S()},te=async t=>{f.value=[t.id],M()},M=async()=>{if(!f.value.length){_.warning("请选择要通过的账号");return}const t=await q("account.batchResolve",{ids:f.value});if(t.code===0){const a=t.data.failed.map(B=>B.reason).join(",");a?he.error({title:"操作失败，失败原因",content:a}):(_.success("操作成功"),f.value=[],S())}else _.error(t.message)},ae=async()=>{if(!f.value.length){_.warning("请选择要拒绝的账号");return}h.value="",w.value=!0},ne=t=>{f.value=[t.id],h.value="",w.value=!0},oe=async()=>{if(!h.value){_.error("请输入拒绝原因");return}U.value=!0;try{const t=await q("account.batchReject",{ids:f.value,rejectReason:h.value});t.code===0?(_.success("操作成功"),f.value=[],w.value=!1,S()):_.error(t.message)}catch(t){console.log(t)}finally{U.value=!1}},S=async()=>{O.value=!0;try{const t=await j("account.list",{page:k.current,pageSize:k.pageSize,...u});t.code===0?(E.value=t.data.list,k.total=t.data.total):_.error(t.message)}finally{O.value=!1}},le=async()=>{const t=await j("channel.list");t.code===0&&(F.value=t.data.list)},D=async(t="")=>{try{const a=await j("group.list",{page:1,pageSize:50,groupName:t});a.code===0&&($.value=a.data.list||[])}catch{_.error("获取群组列表失败")}},T=async(t="")=>{const a=await j("member.list",{page:1,pageSize:50,memberNickname:t});a.code===0&&(V.value=a.data.list||[])};return _e(()=>{S(),D(),le(),T()}),(t,a)=>{const B=r("a-input"),b=r("a-form-item"),A=r("a-select-option"),I=r("a-select"),C=r("a-button"),R=r("a-space"),se=r("a-form"),ue=r("a-avatar"),ie=r("a-tag"),G=r("a-popconfirm"),ce=r("a-table"),de=r("a-textarea"),re=r("a-modal");return s(),d("div",ke,[i("div",be,[i("div",we,[i("div",Se,[o(se,{layout:"inline",model:u},{default:n(()=>[o(b,{label:"账号"},{default:n(()=>[o(B,{value:u.keyword,"onUpdate:value":a[0]||(a[0]=e=>u.keyword=e),placeholder:"请输入账号名称 / uid","allow-clear":""},null,8,["value"])]),_:1}),o(b,{label:"平台渠道"},{default:n(()=>[o(I,{value:u.channelId,"onUpdate:value":a[1]||(a[1]=e=>u.channelId=e),placeholder:"请选择平台渠道",style:{width:"120px"},"allow-clear":""},{default:n(()=>[(s(!0),d(g,null,x(F.value,e=>(s(),y(A,{key:e.id,value:e.id},{default:n(()=>[p(c(e.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(b,{label:"审核状态"},{default:n(()=>[o(I,{value:u.accountAuditStatus,"onUpdate:value":a[2]||(a[2]=e=>u.accountAuditStatus=e),placeholder:"请选择审核状态",style:{width:"120px"},"allow-clear":""},{default:n(()=>[(s(!0),d(g,null,x(J.value,e=>(s(),y(A,{key:e.value,value:e.value},{default:n(()=>[p(c(e.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(b,{label:"所属群组"},{default:n(()=>[o(I,{value:u.groupId,"onUpdate:value":a[3]||(a[3]=e=>u.groupId=e),placeholder:"请选择群组",style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:D},{default:n(()=>[(s(!0),d(g,null,x($.value,e=>(s(),y(A,{key:e.id,value:e.id},{default:n(()=>[p(c(e.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(b,{label:"会员"},{default:n(()=>[o(I,{value:u.memberId,"onUpdate:value":a[4]||(a[4]=e=>u.memberId=e),placeholder:"请选择会员",style:{width:"120px"},"allow-clear":"","show-search":"","filter-option":!1,onSearch:T},{default:n(()=>[(s(!0),d(g,null,x(V.value,e=>(s(),y(A,{key:e.id,value:e.id},{default:n(()=>[p(c(e.nickname),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),o(b,null,{default:n(()=>[o(R,null,{default:n(()=>[o(C,{type:"primary",onClick:L},{default:n(()=>[p(c(t.$t("common.search")),1)]),_:1}),o(C,{onClick:Y},{default:n(()=>[p(c(t.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),i("div",Ce,[o(R,null,{default:n(()=>[o(C,{type:"primary",onClick:M},{default:n(()=>[p(c(t.$t("common.batchResolve")),1)]),_:1}),o(C,{danger:"",onClick:ae},{default:n(()=>[p(c(t.$t("common.batchReject")),1)]),_:1})]),_:1})])]),i("div",Ae,[o(C,{onClick:Z},{default:n(()=>a[7]||(a[7]=[p("FB老账号管理")])),_:1})]),o(ce,{columns:u.accountAuditStatus==="rejected"?W:u.accountAuditStatus==="pending"?Q:z,"data-source":E.value,loading:O.value,pagination:k,"row-selection":X,rowKey:"id",onChange:ee},{bodyCell:n(({column:e,record:l})=>[e.key==="account"?(s(),y(R,{key:0},{default:n(()=>[o(ue,{src:l.channelIcon,size:"small"},null,8,["src"]),i("span",null,c(l.account),1)]),_:2},1024)):m("",!0),e.key==="accountInfo"?(s(),d("div",Ie,[i("div",null,[i("div",Re,[a[8]||(a[8]=i("span",{class:"label"},"主页：",-1)),o(P,{content:l.homeUrl},{default:n(()=>[i("a",{href:l.homeUrl,target:"_blank",class:"link-text"},c(l.homeUrl),9,je)]),_:2},1032,["content"])])]),i("div",null,[a[9]||(a[9]=i("span",{class:"label"},"uid：",-1)),o(P,{content:l.uid},null,8,["content"])]),i("div",xe,[l.channelCustomFields.includes("fansCount")?(s(),d("div",Ne,"粉丝数："+c(l.fansCount),1)):m("",!0),l.channelCustomFields.includes("friendsCount")?(s(),d("div",Oe,"好友数："+c(l.friendsCount),1)):m("",!0),l.channelCustomFields.includes("postsCount")?(s(),d("div",Ue,"发帖数："+c(l.postsCount),1)):m("",!0)])])):m("",!0),e.key==="member"?(s(),d("div",ze,[i("div",null,c(l.memberNickname),1),i("div",Be,[i("span",null,c(l.groupName),1),l.isGroupOwner?(s(),y(ie,{key:0,color:"blue",style:{"margin-left":"10px"}},{default:n(()=>a[10]||(a[10]=[p("群主")])),_:1})):m("",!0)])])):m("",!0),e.key==="accountAuditStatus"?(s(),d(g,{key:3},[p(c(ge(N).getEnumText("AccountAuditStatus",l.accountAuditStatus)),1)],64)):m("",!0),e.key==="waiterName"?(s(),d(g,{key:4},[p(c(l.waiterName||"--"),1)],64)):m("",!0),e.key==="action"?(s(),y(R,{key:5},{default:n(()=>[l.accountAuditStatus==="pending"?(s(),y(G,{key:0,title:"确定要通过该账号吗？",onConfirm:pe=>te(l)},{default:n(()=>a[11]||(a[11]=[i("a",null,"通过",-1)])),_:2},1032,["onConfirm"])):m("",!0),l.accountAuditStatus==="pending"?(s(),y(G,{key:1,title:"确定要拒绝该账号吗？",onConfirm:pe=>ne(l)},{default:n(()=>a[12]||(a[12]=[i("a",{class:"danger"},"拒绝",-1)])),_:2},1032,["onConfirm"])):m("",!0)]),_:2},1024)):m("",!0),e.key==="rejectReason"?(s(),d(g,{key:6},[p(c(l.rejectReason),1)],64)):m("",!0)]),_:1},8,["columns","data-source","loading","pagination"])]),o(re,{open:w.value,"onUpdate:open":a[6]||(a[6]=e=>w.value=e),title:"拒绝原因",onOk:oe,confirmLoading:U.value},{default:n(()=>[o(de,{value:h.value,"onUpdate:value":a[5]||(a[5]=e=>h.value=e),placeholder:"请输入拒绝原因",rows:4},null,8,["value"])]),_:1},8,["open","confirmLoading"])])}}},Le=me(Fe,[["__scopeId","data-v-c72f37f4"]]);export{Le as default};

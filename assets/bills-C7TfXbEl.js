import{_ as J,j as K,k as $,r as B,b as I,l as P,d as n,e as v,c as i,w as s,f as u,m as Q,n as X,g as Y,o as t,F as r,p as O,q as b,i as k,t as o,s as d,h as g,M as Z}from"./index-DVh1u51G.js";const ee={class:"other-bill content-container"},te={class:"table-container"},ae={class:"table-header"},ne={class:"left"},le=["onClick"],se=["onClick"],oe={key:1},ie={key:1},ue={key:0},me={key:1},ce={key:0},re={key:1},de={__name:"bills",setup(_e){const c=K(),S=Y(),D=$(()=>c.loaded?c.getEnumOptions("BillType"):[]),F=$(()=>c.loaded?c.getEnumOptions("SettlementStatus"):[]),f=B(!1),m=I({memberNickname:"",billType:void 0,settlementStatus:void 0}),M=l=>{Z.error({title:"结算失败原因",content:l.failureReason})},R=[{title:"会员昵称",key:"memberNickname"},{title:"账单类型",dataIndex:"billType",key:"billType"},{title:"关联任务",key:"taskName"},{title:"金额",dataIndex:"amount",key:"amount",align:"right"},{title:"备注",key:"remark"},{title:"创建时间",dataIndex:"createTime",key:"createTime"},{title:"状态",key:"settlementStatus"}],T=B([]),_=I({current:1,pageSize:10,total:0}),w=()=>{_.current=1,h()},V=()=>{Object.assign(m,{memberNickname:"",billType:void 0,settlementStatus:void 0}),w()},j=l=>{Object.assign(_,l),h()},z=l=>{S.push(`/member/view/${l.memberId}`)},U=l=>{S.push(`/submitted-tasks/detail/${l.submittedId}`)},h=async()=>{f.value=!0;try{const l=await Q("finance.bills",{page:_.current,pageSize:_.pageSize,...m});l.code===0?(T.value=l.data.list,_.total=l.data.total):X.error(l.message)}finally{f.value=!1}};return P(()=>{h()}),(l,p)=>{const q=u("a-input"),y=u("a-form-item"),N=u("a-select-option"),x=u("a-select"),C=u("a-button"),L=u("a-space"),W=u("a-form"),A=u("a-typography-text"),G=u("info-circle-outlined"),H=u("a-table");return t(),n("div",ee,[v("div",te,[v("div",ae,[v("div",ne,[i(W,{layout:"inline",model:m},{default:s(()=>[i(y,{label:"会员昵称"},{default:s(()=>[i(q,{value:m.memberNickname,"onUpdate:value":p[0]||(p[0]=e=>m.memberNickname=e),placeholder:"请输入会员昵称","allow-clear":""},null,8,["value"])]),_:1}),i(y,{label:"账单类型"},{default:s(()=>[i(x,{value:m.billType,"onUpdate:value":p[1]||(p[1]=e=>m.billType=e),placeholder:"请选择账单类型",style:{width:"120px"},"allow-clear":""},{default:s(()=>[(t(!0),n(r,null,O(D.value,e=>(t(),b(N,{key:e.value,value:e.value},{default:s(()=>[k(o(e.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),i(y,{label:"结算状态"},{default:s(()=>[i(x,{value:m.settlementStatus,"onUpdate:value":p[2]||(p[2]=e=>m.settlementStatus=e),placeholder:"请选择结算状态",style:{width:"120px"},"allow-clear":""},{default:s(()=>[(t(!0),n(r,null,O(F.value,e=>(t(),b(N,{key:e.value,value:e.value},{default:s(()=>[k(o(e.text),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),i(y,null,{default:s(()=>[i(L,null,{default:s(()=>[i(C,{type:"primary",onClick:w},{default:s(()=>[k(o(l.$t("common.search")),1)]),_:1}),i(C,{onClick:V},{default:s(()=>[k(o(l.$t("common.reset")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),i(H,{columns:R,"data-source":T.value,loading:f.value,pagination:_,onChange:j},{bodyCell:s(({column:e,record:a})=>[e.key==="memberNickname"?(t(),n("a",{key:0,onClick:E=>z(a)},o(a.memberNickname),9,le)):d("",!0),e.key==="taskName"?(t(),n(r,{key:1},[a.taskName?(t(),n("a",{key:0,onClick:E=>U(a)},o(a.taskName),9,se)):(t(),n("span",oe,"--"))],64)):d("",!0),e.key==="billType"?(t(),n(r,{key:2},[k(o(g(c).getEnumText("BillType",a.billType)),1)],64)):d("",!0),e.key==="amount"?(t(),n(r,{key:3},[a.billType==="reward_deduction"?(t(),b(A,{key:0,type:"danger"},{default:s(()=>[k(" - "+o(a.amount),1)]),_:2},1024)):(t(),n("span",ie,o(a.amount),1))],64)):d("",!0),e.key==="remark"?(t(),n(r,{key:4},[a.remark?(t(),n("span",ue,o(a.remark)+"(操作人: "+o(a.waiterName)+")",1)):(t(),n("span",me,"--"))],64)):d("",!0),e.key==="settlementStatus"?(t(),n(r,{key:5},[a.billType==="withdrawal"?(t(),n("span",ce,o(g(c).getEnumText("WithdrawalStatus",a.withdrawalStatus)),1)):(t(),n("span",re,o(g(c).getEnumText("SettlementStatus",a.settlementStatus)),1)),a.settlementStatus==="failed"||a.withdrawalStatus==="failed"?(t(),b(G,{key:2,class:"status-icon",onClick:E=>M(a)},null,8,["onClick"])):d("",!0)],64)):d("",!0)]),_:1},8,["data-source","loading","pagination"])])])}}},ke=J(de,[["__scopeId","data-v-1fe531bb"]]);export{ke as default};

import{c as a,I as se,_ as ie,l as ce,r as y,a as T,n as ue,b as h,d as s,w as t,e as i,p as B,j as c,f as de,o as m,F as I,q as D,s as V,h as f,t as w,g as A,P as pe,v as N,x as me}from"./index-BTqSzVVb.js";var fe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 310H732.4c13.6-21.4 21.6-46.8 21.6-74 0-76.1-61.9-138-138-138-41.4 0-78.7 18.4-104 47.4-25.3-29-62.6-47.4-104-47.4-76.1 0-138 61.9-138 138 0 27.2 7.9 52.6 21.6 74H144c-17.7 0-32 14.3-32 32v200c0 4.4 3.6 8 8 8h40v344c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V550h40c4.4 0 8-3.6 8-8V342c0-17.7-14.3-32-32-32zm-334-74c0-38.6 31.4-70 70-70s70 31.4 70 70-31.4 70-70 70h-70v-70zm-138-70c38.6 0 70 31.4 70 70v70h-70c-38.6 0-70-31.4-70-70s31.4-70 70-70zM180 482V378h298v104H180zm48 68h250v308H228V550zm568 308H546V550h250v308zm48-376H546V378h298v104z"}}]},name:"gift",theme:"outlined"};function E(u){for(var r=1;r<arguments.length;r++){var l=arguments[r]!=null?Object(arguments[r]):{},d=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(d=d.concat(Object.getOwnPropertySymbols(l).filter(function(p){return Object.getOwnPropertyDescriptor(l,p).enumerable}))),d.forEach(function(p){_e(u,p,l[p])})}return u}function _e(u,r,l){return r in u?Object.defineProperty(u,r,{value:l,enumerable:!0,configurable:!0,writable:!0}):u[r]=l,u}var P=function(r,l){var d=E({},r,l.attrs);return a(se,E({},d,{icon:fe}),null)};P.displayName="GiftOutlined";P.inheritAttrs=!1;const ve={class:"member-list content-container"},ge={class:"table-container"},be={class:"table-header"},ye={class:"left"},he={class:"right"},ke={key:0,style:{display:"inline-block"}},we={class:"link-text-container"},Ce=["href"],xe=["onClick"],Oe=["onClick"],Ne={__name:"list",setup(u){const r=ce(),l=de(),d=y(!1),p=y(!1),S=y(!1),z=y(10),v=T({memberNickname:"",groupId:void 0}),$=y([]),g=T({current:1,pageSize:10,total:0}),L=y([]),R=[{title:"会员昵称",dataIndex:"memberNickname",key:"memberNickname"},{title:"账号",dataIndex:"memberAccount",key:"memberAccount"},{title:"渠道账号信息",key:"accountList"},{title:"所属群组",dataIndex:"groupName",key:"groupName"},{title:"更新时间",dataIndex:"updateTime",key:"updateTime",width:180},{title:"操作",key:"action",fixed:"right",width:200}],U=()=>{g.current=1,C()},F=()=>{Object.assign(v,{memberNickname:"",groupId:void 0}),U()},M=n=>{g.current=n.current,g.pageSize=n.pageSize,C()},q=()=>{l.push("/member/create")},J=n=>{l.push(`/member/edit/${n.id}`)},Q=n=>{l.push(`/member/view/${n.id}`)},W=async n=>{try{const e=await me("member.delete",{},{urlParams:{id:n.id}});e.code===0?(c.success("删除成功"),C()):c.error(e.message)}catch{c.error("删除失败")}},X=async()=>{p.value=!0,await Z()},Y=async()=>{try{S.value=!0,c.success("保存成功"),p.value=!1}catch{c.error("保存失败")}finally{S.value=!1}},Z=async()=>{try{z.value=10}catch{c.error("获取配置失败")}},C=async()=>{d.value=!0;try{const n=await B("member.list",{page:g.current,pageSize:g.pageSize,...v});n.code===0?($.value=n.data.list,g.total=n.data.total):c.error(n.message)}finally{d.value=!1}},j=async(n="")=>{try{const e=await B("group.list",{page:1,pageSize:50,groupName:n});e.code===0&&(L.value=e.data.list||[])}catch{c.error("获取群组列表失败")}},K=n=>{navigator.clipboard.writeText(n).then(()=>{c.success("链接已复制到剪贴板")}).catch(()=>{c.error("复制失败，请手动复制")})};return ue(()=>{C(),j()}),(n,e)=>{const ee=i("a-input"),x=i("a-form-item"),te=i("a-select-option"),ae=i("a-select"),k=i("a-button"),O=i("a-space"),G=i("a-form"),H=i("a-tag"),ne=i("a-popconfirm"),oe=i("a-table"),le=i("a-input-number"),re=i("a-modal");return m(),h("div",ve,[s("div",ge,[s("div",be,[s("div",ye,[a(G,{layout:"inline",model:v},{default:t(()=>[a(x,{label:"会员昵称"},{default:t(()=>[a(ee,{value:v.memberNickname,"onUpdate:value":e[0]||(e[0]=o=>v.memberNickname=o),placeholder:"请输入会员昵称","allow-clear":""},null,8,["value"])]),_:1}),a(x,{label:"所属群组"},{default:t(()=>[a(ae,{value:v.groupId,"onUpdate:value":e[1]||(e[1]=o=>v.groupId=o),placeholder:"请选择群组","allow-clear":"","show-search":"","filter-option":!1,onSearch:j,style:{width:"200px"}},{default:t(()=>[(m(!0),h(I,null,D(L.value,o=>(m(),V(te,{key:o.id,value:o.id},{default:t(()=>[f(w(o.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),a(x,null,{default:t(()=>[a(O,null,{default:t(()=>[a(k,{type:"primary",onClick:U},{default:t(()=>e[4]||(e[4]=[f("查询")])),_:1}),a(k,{onClick:F},{default:t(()=>e[5]||(e[5]=[f("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),s("div",he,[a(O,null,{default:t(()=>[a(k,{onClick:X},{icon:t(()=>[a(A(P))]),default:t(()=>[e[6]||(e[6]=f(" 邀请有礼 "))]),_:1}),a(k,{type:"primary",onClick:q},{icon:t(()=>[a(A(pe))]),default:t(()=>[e[7]||(e[7]=f(" 新增会员 "))]),_:1})]),_:1})])]),a(oe,{columns:R,"data-source":$.value,loading:d.value,pagination:g,onChange:M},{bodyCell:t(({column:o,record:b})=>[o.key==="accountList"?(m(),h("div",ke,[(m(!0),h(I,null,D(b.accountList,_=>(m(),h("div",null,[s("div",null,[a(O,null,{default:t(()=>[f(" 账号："+w(_.account)+" ",1),a(H,{color:"warning"},{default:t(()=>[f(w(A(r).getEnumText("AccountAuditStatus",_.accountAuditStatus)),1)]),_:2},1024)]),_:2},1024)]),s("div",we,[e[9]||(e[9]=s("span",{class:"label"},"主页：",-1)),s("a",{href:_.homeUrl,target:"_blank",class:"link-text"},w(_.homeUrl),9,Ce),a(k,{type:"link",size:"small",onClick:Se=>K(_.homeUrl)},{default:t(()=>e[8]||(e[8]=[f(" 复制 ")])),_:2},1032,["onClick"])])]))),256))])):N("",!0),o.key==="groupName"?(m(),h(I,{key:1},[s("span",null,w(b.groupName),1),b.isGroupOwner?(m(),V(H,{key:0,color:"blue",style:{"margin-left":"10px"}},{default:t(()=>e[10]||(e[10]=[f("群主")])),_:1})):N("",!0)],64)):N("",!0),o.key==="action"?(m(),V(O,{key:2},{default:t(()=>[s("a",{onClick:_=>J(b)},"编辑",8,xe),s("a",{onClick:_=>Q(b)},"查看",8,Oe),a(ne,{title:"确定要删除吗？",onConfirm:_=>W(b)},{default:t(()=>e[11]||(e[11]=[s("a",{class:"danger"},"删除",-1)])),_:2},1032,["onConfirm"])]),_:2},1024)):N("",!0)]),_:1},8,["data-source","loading","pagination"])]),a(re,{open:p.value,"onUpdate:open":e[3]||(e[3]=o=>p.value=o),title:"邀请有礼配置",onOk:Y,confirmLoading:S.value},{default:t(()=>[a(G,{"label-col":{span:6},"wrapper-col":{span:16}},{default:t(()=>[a(x,{label:"奖励金额",extra:"设置每成功邀请一位新会员的奖励金额"},{default:t(()=>[a(le,{value:z.value,"onUpdate:value":e[2]||(e[2]=o=>z.value=o),min:0,precision:2,step:1,formatter:o=>`¥ ${o}`,parser:o=>o.replace("¥ ",""),style:{width:"100%"}},null,8,["value","formatter","parser"])]),_:1})]),_:1})]),_:1},8,["open","confirmLoading"])])}}},Ie=ie(Ne,[["__scopeId","data-v-f9edcf5c"]]);export{Ie as default};

import{P as T}from"./PageHeader-CeOVBHql.js";import{_ as M,r as c,c as S,k as q,d as G,f as o,w as s,g as m,l as N,m as b,o as _,e as u,t as n,p as h,s as w,i as y,A as O}from"./index-CmHd8M9w.js";const U={class:"system-config-container"},V={class:"form-item-desc"},E={class:"form-item-desc"},j={class:"form-item-desc"},H={class:"form-item-desc"},I={__name:"index",setup(z){const C=c(null),g=c(!1),f=c(!1),r=c(!0),t=S({max_group_members:null,group_owner_commission_rate:null,invite_reward_amount:null}),$={max_group_members:[{required:!0,message:"请输入最大群成员数",trigger:"blur"},{type:"number",min:10,max:1e3,message:"群成员数必须在 10-1000 之间",trigger:"blur"}],group_owner_commission_rate:[{required:!0,message:"请输入群主收益率",trigger:"blur"},{type:"number",min:0,max:100,message:"收益率必须在 0-100 之间",trigger:"blur"}],invite_reward_amount:[{required:!0,message:"请输入邀请奖励金额",trigger:"blur"},{type:"number",min:0,max:1e3,message:"奖励金额必须在 0-1000 之间",trigger:"blur"}],withdrawal_threshold:[{required:!0,message:"请输入提现门槛",trigger:"blur"},{type:"number",min:0,max:99999,message:"提现门槛必须在 0-99999 之间",trigger:"blur"}]},p=async()=>{g.value=!0;try{const e=await N("system.getAllConfig");if(e&&e.data){const a={};e.data.forEach(l=>{a[l.config_key]=l}),Object.assign(t,{max_group_members:a.max_group_members.config_value,group_owner_commission_rate:a.group_owner_commission_rate.config_value,invite_reward_amount:a.invite_reward_amount.config_value,withdrawal_threshold:a.withdrawal_threshold.config_value})}}catch(e){b.error("获取系统配置失败："+(e.message||"未知错误"))}finally{g.value=!1}},k=async()=>{f.value=!0;const e=await O("system.saveAllConfig",{configs:t});f.value=!1,e&&e.code===0?(b.success("保存系统配置成功"),p(),r.value=!0):b.error(e.message||"保存失败")},R=()=>{C.value.validate().then(()=>{k()}).catch(e=>{console.error("表单验证失败",e)})},x=()=>{r.value=!1},P=()=>{p()};return q(()=>{p()}),(e,a)=>{const l=m("a-input-number"),d=m("a-form-item"),v=m("a-button"),A=m("a-space"),D=m("a-form"),B=m("a-spin");return _(),G("div",U,[o(T,{title:e.$t("systemConfig.pageTitle"),back:!0},null,8,["title"]),o(B,{spinning:g.value},{default:s(()=>[o(D,{model:t,rules:$,ref_key:"formRef",ref:C,"label-col":{span:6},"wrapper-col":{span:12}},{default:s(()=>[o(d,{label:e.$t("systemConfig.maxGroupMembers"),name:"maxGroupMembers"},{default:s(()=>[o(l,{value:t.max_group_members,"onUpdate:value":a[0]||(a[0]=i=>t.max_group_members=i),min:1,max:1e3,placeholder:"请输入最大群成员数",disabled:r.value},null,8,["value","disabled"]),u("div",V,[u("div",null,n(e.$t("systemConfig.maxGroupMembersDesc1")),1),u("div",null,n(e.$t("systemConfig.maxGroupMembersDesc2")),1)])]),_:1},8,["label"]),o(d,{label:e.$t("systemConfig.groupOwnerProfitRate"),name:"ownerProfitRate"},{default:s(()=>[o(l,{value:t.group_owner_commission_rate,"onUpdate:value":a[1]||(a[1]=i=>t.group_owner_commission_rate=i),min:0,max:100,step:.1,precision:1,addonAfter:"%",placeholder:e.$t("systemConfig.groupOwnerProfitRatePlaceholder"),disabled:r.value},null,8,["value","placeholder","disabled"]),u("div",E,n(e.$t("systemConfig.groupOwnerProfitRateDesc")),1)]),_:1},8,["label"]),o(d,{label:e.$t("systemConfig.inviteRewardAmount"),name:"inviteRewardAmount"},{default:s(()=>[o(l,{value:t.invite_reward_amount,"onUpdate:value":a[2]||(a[2]=i=>t.invite_reward_amount=i),min:0,max:1e3,step:.1,precision:1,addonBefore:"¥",placeholder:e.$t("systemConfig.inviteRewardAmountPlaceholder"),disabled:r.value},null,8,["value","placeholder","disabled"]),u("div",j,n(e.$t("systemConfig.inviteRewardAmountDesc")),1)]),_:1},8,["label"]),o(d,{label:e.$t("systemConfig.withdrawalThreshold"),name:"withdrawalThreshold"},{default:s(()=>[o(l,{value:t.withdrawal_threshold,"onUpdate:value":a[3]||(a[3]=i=>t.withdrawal_threshold=i),min:0,max:99999,step:1,addonBefore:"¥",placeholder:e.$t("systemConfig.withdrawalThresholdPlaceholder"),disabled:r.value},null,8,["value","placeholder","disabled"]),u("div",H,n(e.$t("systemConfig.withdrawalThresholdDesc")),1)]),_:1},8,["label"]),o(d,{"wrapper-col":{span:12,offset:6}},{default:s(()=>[o(A,null,{default:s(()=>[r.value?w("",!0):(_(),h(v,{key:0,type:"primary",onClick:R,loading:f.value},{default:s(()=>[y(n(e.$t("common.save")),1)]),_:1},8,["loading"])),r.value?(_(),h(v,{key:1,onClick:x},{default:s(()=>[y(n(e.$t("common.edit")),1)]),_:1})):w("",!0),r.value?w("",!0):(_(),h(v,{key:2,onClick:P},{default:s(()=>[y(n(e.$t("common.reset")),1)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["spinning"])])}}},K=M(I,[["__scopeId","data-v-b3b364bc"]]);export{K as default};

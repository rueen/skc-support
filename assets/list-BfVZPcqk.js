import{_ as X,l as Y,r as x,a as O,y as Z,n as ee,b as p,d as o,c as n,w as t,e as r,p as U,j as m,f as te,o as i,F as w,q as N,s as S,h as u,t as f,g as V,P as ae,v as y,x as ne}from"./index-scHfdszV.js";const oe={class:"member-list content-container"},se={class:"table-container"},le={class:"table-header"},re={class:"left"},ie={class:"right"},ue={key:0,style:{display:"inline-block"}},ce={class:"link-text-container"},de=["href"],pe=["onClick"],me=["onClick"],_e={__name:"list",setup(fe){const B=Y(),b=te(),D=Z(),h=x(!1),c=O({memberNickname:"",groupId:D.query.groupId}),I=x([]),d=O({current:1,pageSize:10,total:0}),z=x([]),E=[{title:"会员昵称",dataIndex:"memberNickname",key:"memberNickname"},{title:"账号",dataIndex:"memberAccount",key:"memberAccount"},{title:"渠道账号信息",key:"accountList"},{title:"所属群组",dataIndex:"groups",key:"groups"},{title:"更新时间",dataIndex:"updateTime",key:"updateTime",width:180},{title:"操作",key:"action",fixed:"right",width:200}],A=()=>{d.current=1,g()},L=()=>{Object.assign(c,{memberNickname:"",groupId:void 0}),A()},F=a=>{d.current=a.current,d.pageSize=a.pageSize,g()},P=()=>{b.push("/member/create")},R=a=>{b.push(`/member/edit/${a.id}`)},j=a=>{b.push(`/member/view/${a.id}`)},q=async a=>{const e=await ne("member.delete",{},{urlParams:{id:a.id}});e.code===0?(m.success("删除成功"),g()):m.error(e.message)},g=async()=>{h.value=!0;try{const a=await U("member.list",{page:d.current,pageSize:d.pageSize,...c});a.code===0?(I.value=a.data.list,d.total=a.data.total):m.error(a.message)}finally{h.value=!1}},T=async(a="")=>{try{const e=await U("group.list",{page:1,pageSize:50,groupName:a});e.code===0&&(z.value=e.data.list||[])}catch{m.error("获取群组列表失败")}},G=a=>{navigator.clipboard.writeText(a).then(()=>{m.success("链接已复制到剪贴板")}).catch(()=>{m.error("复制失败，请手动复制")})};return ee(()=>{g(),T()}),(a,e)=>{const M=r("a-input"),C=r("a-form-item"),H=r("a-select-option"),J=r("a-select"),k=r("a-button"),v=r("a-space"),K=r("a-form"),$=r("a-tag"),Q=r("a-popconfirm"),W=r("a-table");return i(),p("div",oe,[o("div",se,[o("div",le,[o("div",re,[n(K,{layout:"inline",model:c},{default:t(()=>[n(C,{label:"会员昵称"},{default:t(()=>[n(M,{value:c.memberNickname,"onUpdate:value":e[0]||(e[0]=s=>c.memberNickname=s),placeholder:"请输入会员昵称","allow-clear":""},null,8,["value"])]),_:1}),n(C,{label:"所属群组"},{default:t(()=>[n(J,{value:c.groupId,"onUpdate:value":e[1]||(e[1]=s=>c.groupId=s),placeholder:"请选择群组","allow-clear":"","show-search":"","filter-option":!1,onSearch:T,style:{width:"200px"}},{default:t(()=>[(i(!0),p(w,null,N(z.value,s=>(i(),S(H,{key:s.id,value:s.id},{default:t(()=>[u(f(s.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),n(C,null,{default:t(()=>[n(v,null,{default:t(()=>[n(k,{type:"primary",onClick:A},{default:t(()=>e[2]||(e[2]=[u("查询")])),_:1}),n(k,{onClick:L},{default:t(()=>e[3]||(e[3]=[u("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),o("div",ie,[n(v,null,{default:t(()=>[n(k,{type:"primary",onClick:P},{icon:t(()=>[n(V(ae))]),default:t(()=>[e[4]||(e[4]=u(" 新增会员 "))]),_:1})]),_:1})])]),n(W,{columns:E,"data-source":I.value,loading:h.value,pagination:d,onChange:F},{bodyCell:t(({column:s,record:_})=>[s.key==="accountList"?(i(),p("div",ue,[(i(!0),p(w,null,N(_.accountList,l=>(i(),p("div",null,[o("div",null,[n(v,null,{default:t(()=>[u(" 账号："+f(l.account)+" ",1),n($,{color:"warning"},{default:t(()=>[u(f(V(B).getEnumText("AccountAuditStatus",l.accountAuditStatus)),1)]),_:2},1024)]),_:2},1024)]),o("div",ce,[e[6]||(e[6]=o("span",{class:"label"},"主页：",-1)),o("a",{href:l.homeUrl,target:"_blank",class:"link-text"},f(l.homeUrl),9,de),n(k,{type:"link",size:"small",onClick:ge=>G(l.homeUrl)},{default:t(()=>e[5]||(e[5]=[u(" 复制 ")])),_:2},1032,["onClick"])])]))),256))])):y("",!0),s.key==="groups"?(i(!0),p(w,{key:1},N(_.groups,l=>(i(),p("div",null,[o("span",null,f(l.groupName),1),l.isGroupOwner?(i(),S($,{key:0,color:"blue",style:{"margin-left":"10px"}},{default:t(()=>e[7]||(e[7]=[u("群主")])),_:1})):y("",!0)]))),256)):y("",!0),s.key==="action"?(i(),S(v,{key:2},{default:t(()=>[o("a",{onClick:l=>R(_)},"编辑",8,pe),o("a",{onClick:l=>j(_)},"查看",8,me),n(Q,{title:"确定要删除吗？",onConfirm:l=>q(_)},{default:t(()=>e[8]||(e[8]=[o("a",{class:"danger"},"删除",-1)])),_:2},1032,["onConfirm"])]),_:2},1024)):y("",!0)]),_:1},8,["data-source","loading","pagination"])])])}}},ve=X(_e,[["__scopeId","data-v-4b9eab66"]]);export{ve as default};

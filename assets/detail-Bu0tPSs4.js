import{r as c,c as j,e as A,p as I,f as z,h as l,g as E,w as o,i as u,z as O,q as S,v as b,j as T,o as f,n as C,x as _,k as w,t as g,B as G}from"./index-BJO30-mH.js";import{P as H}from"./PageHeader-JPRiqkuK.js";import{d as L}from"./routeParamsEncryption-BKFTaOaF.js";const M={class:"content-container"},J={class:"form-container"},Y={__name:"detail",setup(K){const i=O(),y=T(),U=c(),{t:N}=j(),d=c({}),m=c([]),$=c(null),k=()=>{const e=i.query.filters;e&&($.value=L(e))},t=A({homeUrl:"",uid:"",account:"",fansCount:"",friendsCount:"",postsCount:"",isNew:!1}),B={memberAccount:[{required:!0,message:N("member.detail.memberAccountPlaceholder")}]},q=async()=>{const e=await S("account.detail",{},{urlParams:{id:i.params.id}});e.code===0?(Object.assign(t,{...e.data,isNew:!!e.data.isNew}),d.value=e.data,m.value=e.data.channelCustomFields):b.error(e.message)},p=c(!1),P=()=>{U.value.validate().then(async()=>{try{const e={};Object.keys(t).forEach(a=>{t[a]!=null&&(["account","homeUrl","uid"].includes(a)?e[a]=t[a].trim():e[a]=t[a],a==="isNew"&&(e[a]=t[a]?1:0))}),p.value=!0,await G("account.edit",e,{urlParams:{id:d.value.id}}),b.success("success"),v()}catch(e){console.log(e),b.error("submit failed")}finally{p.value=!1}})},v=()=>{const e={};i.query.filters&&(e.filters=i.query.filters),y.push({path:"/account",query:e})};return I(async()=>{k(),q()}),(e,a)=>{const D=u("a-avatar"),s=u("a-form-item"),r=u("a-input"),F=u("a-switch"),h=u("a-button"),R=u("a-space"),V=u("a-form");return f(),z("div",M,[l(H,{title:e.$t("account.detail.editTitle"),back:!0,useDefaultBack:!1,onBack:v},null,8,["title"]),E("div",J,[l(V,{ref_key:"formRef",ref:U,model:t,rules:B,"label-col":{span:6},"wrapper-col":{span:16}},{default:o(()=>[l(s,{label:e.$t("account.detail.platform"),name:"platform"},{default:o(()=>[l(D,{src:d.value.channelIcon,size:"small"},null,8,["src"]),w(" "+g(d.value.channelName),1)]),_:1},8,["label"]),l(s,{label:e.$t("account.detail.account"),name:"account"},{default:o(()=>[l(r,{value:t.account,"onUpdate:value":a[0]||(a[0]=n=>t.account=n)},null,8,["value"])]),_:1},8,["label"]),l(s,{label:e.$t("account.detail.homepage"),name:"homeUrl"},{default:o(()=>[l(r,{value:t.homeUrl,"onUpdate:value":a[1]||(a[1]=n=>t.homeUrl=n)},null,8,["value"])]),_:1},8,["label"]),l(s,{label:"UID",name:"uid"},{default:o(()=>[l(r,{value:t.uid,"onUpdate:value":a[2]||(a[2]=n=>t.uid=n)},null,8,["value"])]),_:1}),m.value.includes("fansCount")?(f(),C(s,{key:0,label:e.$t("account.detail.fansCount"),name:"fansCount"},{default:o(()=>[l(r,{value:t.fansCount,"onUpdate:value":a[3]||(a[3]=n=>t.fansCount=n)},null,8,["value"])]),_:1},8,["label"])):_("",!0),m.value.includes("friendsCount")?(f(),C(s,{key:1,label:e.$t("account.detail.friendsCount"),name:"friendsCount"},{default:o(()=>[l(r,{value:t.friendsCount,"onUpdate:value":a[4]||(a[4]=n=>t.friendsCount=n)},null,8,["value"])]),_:1},8,["label"])):_("",!0),m.value.includes("postsCount")?(f(),C(s,{key:2,label:e.$t("account.detail.postsCount"),name:"postsCount"},{default:o(()=>[l(r,{value:t.postsCount,"onUpdate:value":a[5]||(a[5]=n=>t.postsCount=n)},null,8,["value"])]),_:1},8,["label"])):_("",!0),l(s,{label:e.$t("account.detail.isNew")},{default:o(()=>[l(F,{checked:t.isNew,"onUpdate:checked":a[6]||(a[6]=n=>t.isNew=n)},null,8,["checked"])]),_:1},8,["label"]),l(s,{"wrapper-col":{offset:4}},{default:o(()=>[l(R,null,{default:o(()=>[l(h,{type:"primary",loading:p.value,onClick:P},{default:o(()=>[w(g(e.$t("common.submit")),1)]),_:1},8,["loading"]),l(h,{onClick:a[7]||(a[7]=n=>v())},{default:o(()=>[w(g(e.$t("common.cancel")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])])}}};export{Y as default};

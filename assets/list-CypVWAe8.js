import{_ as X,l as Y,r as x,a as O,y as Z,n as ee,b as r,d as l,c as n,w as t,e as u,p as U,j as _,f as te,o,F as k,q as N,s as S,h as c,t as g,g as V,P as ae,v as f,x as ne}from"./index-DMD8F-5D.js";const oe={class:"member-list content-container"},se={class:"table-container"},le={class:"table-header"},ie={class:"left"},re={class:"right"},ue={key:0,style:{display:"inline-block"}},ce={class:"link-text-container"},de=["href"],pe={key:0},me=["onClick"],_e=["onClick"],ge={__name:"list",setup(fe){const B=Y(),h=te(),D=Z(),C=x(!1),p=O({memberNickname:"",groupId:D.query.groupId}),I=x([]),m=O({current:1,pageSize:10,total:0}),z=x([]),E=[{title:"会员昵称",dataIndex:"memberNickname",key:"memberNickname"},{title:"账号",dataIndex:"memberAccount",key:"memberAccount"},{title:"渠道账号信息",key:"accountList"},{title:"邀请人",key:"inviterNickname"},{title:"所属群组",key:"groups"},{title:"更新时间",dataIndex:"updateTime",key:"updateTime",width:180},{title:"操作",key:"action",fixed:"right",width:150}],A=()=>{m.current=1,y()},L=()=>{Object.assign(p,{memberNickname:"",groupId:void 0}),A()},F=a=>{m.current=a.current,m.pageSize=a.pageSize,y()},P=()=>{h.push("/member/create")},R=a=>{h.push(`/member/edit/${a.id}`)},j=a=>{h.push(`/member/view/${a.id}`)},q=async a=>{const e=await ne("member.delete",{},{urlParams:{id:a.id}});e.code===0?(_.success("删除成功"),y()):_.error(e.message)},y=async()=>{C.value=!0;try{const a=await U("member.list",{page:m.current,pageSize:m.pageSize,...p});a.code===0?(I.value=a.data.list,m.total=a.data.total):_.error(a.message)}finally{C.value=!1}},T=async(a="")=>{try{const e=await U("group.list",{page:1,pageSize:50,groupName:a});e.code===0&&(z.value=e.data.list||[])}catch{_.error("获取群组列表失败")}},G=a=>{navigator.clipboard.writeText(a).then(()=>{_.success("链接已复制到剪贴板")}).catch(()=>{_.error("复制失败，请手动复制")})};return ee(()=>{y(),T()}),(a,e)=>{const M=u("a-input"),w=u("a-form-item"),H=u("a-select-option"),J=u("a-select"),v=u("a-button"),b=u("a-space"),K=u("a-form"),$=u("a-tag"),Q=u("a-popconfirm"),W=u("a-table");return o(),r("div",oe,[l("div",se,[l("div",le,[l("div",ie,[n(K,{layout:"inline",model:p},{default:t(()=>[n(w,{label:"会员昵称"},{default:t(()=>[n(M,{value:p.memberNickname,"onUpdate:value":e[0]||(e[0]=s=>p.memberNickname=s),placeholder:"请输入会员昵称","allow-clear":""},null,8,["value"])]),_:1}),n(w,{label:"所属群组"},{default:t(()=>[n(J,{value:p.groupId,"onUpdate:value":e[1]||(e[1]=s=>p.groupId=s),placeholder:"请选择群组","allow-clear":"","show-search":"","filter-option":!1,onSearch:T,style:{width:"200px"}},{default:t(()=>[(o(!0),r(k,null,N(z.value,s=>(o(),S(H,{key:s.id,value:s.id},{default:t(()=>[c(g(s.groupName),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),n(w,null,{default:t(()=>[n(b,null,{default:t(()=>[n(v,{type:"primary",onClick:A},{default:t(()=>e[2]||(e[2]=[c("查询")])),_:1}),n(v,{onClick:L},{default:t(()=>e[3]||(e[3]=[c("重置")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),l("div",re,[n(b,null,{default:t(()=>[n(v,{type:"primary",onClick:P},{icon:t(()=>[n(V(ae))]),default:t(()=>[e[4]||(e[4]=c(" 新增会员 "))]),_:1})]),_:1})])]),n(W,{columns:E,"data-source":I.value,loading:C.value,pagination:m,onChange:F},{bodyCell:t(({column:s,record:d})=>[s.key==="accountList"?(o(),r("div",ue,[(o(!0),r(k,null,N(d.accountList,i=>(o(),r("div",null,[l("div",null,[n(b,null,{default:t(()=>[c(" 账号："+g(i.account)+" ",1),n($,{color:"warning"},{default:t(()=>[c(g(V(B).getEnumText("AccountAuditStatus",i.accountAuditStatus)),1)]),_:2},1024)]),_:2},1024)]),l("div",ce,[e[6]||(e[6]=l("span",{class:"label"},"主页：",-1)),l("a",{href:i.homeUrl,target:"_blank",class:"link-text"},g(i.homeUrl),9,de),n(v,{type:"link",size:"small",onClick:ke=>G(i.homeUrl)},{default:t(()=>e[5]||(e[5]=[c(" 复制 ")])),_:2},1032,["onClick"])])]))),256))])):f("",!0),s.key==="inviterNickname"?(o(),r(k,{key:1},[c(g(d.inviterNickname||"--"),1)],64)):f("",!0),s.key==="groups"?(o(),r(k,{key:2},[(o(!0),r(k,null,N(d.groups,i=>(o(),r("div",null,[l("span",null,g(i.groupName),1),i.isGroupOwner?(o(),S($,{key:0,color:"blue",style:{"margin-left":"10px"}},{default:t(()=>e[7]||(e[7]=[c("群主")])),_:1})):f("",!0)]))),256)),!d.groups||d.groups.length===0?(o(),r("span",pe,"--")):f("",!0)],64)):f("",!0),s.key==="action"?(o(),S(b,{key:3},{default:t(()=>[l("a",{onClick:i=>R(d)},"编辑",8,me),l("a",{onClick:i=>j(d)},"查看",8,_e),n(Q,{title:"确定要删除吗？",onConfirm:i=>q(d)},{default:t(()=>e[8]||(e[8]=[l("a",{class:"danger"},"删除",-1)])),_:2},1032,["onConfirm"])]),_:2},1024)):f("",!0)]),_:1},8,["data-source","loading","pagination"])])])}}},ve=X(ge,[["__scopeId","data-v-465ee50e"]]);export{ve as default};
